<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>IO: RMS force balance, torsional oscillations, misc &mdash; Magic 5.1 documentation</title>
    
    <link rel="stylesheet" href="../_static/magic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="top" title="Magic 5.1 documentation" href="../contents.html" />
    <link rel="up" title="Description of the Fortran modules" href="../api.html" />
    <link rel="next" title="Reading and storing check points (restart files)" href="checkPoints.html" />
    <link rel="prev" title="IO: graphic files, movie files, coeff files and potential files" href="IOBinaryOutputs.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
  </style>
  <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head>
  <body role="document">
<div class="pageheader">
  <ul>
    <li><a href="../index.html">Home</a></li>
    <li><a href="../install.html">Get it/Run it</a></li>
    <li><a href="../contribute.html">Contribute!</a></li>
    <li><a href="../contents.html">Contents</a></li>
  </ul>
  <div>
    <a href="../index.html">
      <img src="../_static/logo.png" alt="magic" height="120px" width="192px"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="checkPoints.html" title="Reading and storing check points (restart files)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="IOBinaryOutputs.html" title="IO: graphic files, movie files, coeff files and potential files"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 5.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" accesskey="U">Description of the Fortran modules</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="io-rms-force-balance-torsional-oscillations-misc">
<span id="secfortranioadd"></span><h1>IO: RMS force balance, torsional oscillations, misc<a class="headerlink" href="#io-rms-force-balance-torsional-oscillations-misc" title="Permalink to this headline">¶</a></h1>
<div class="section" id="f/rms">
<span id="rms-f90"></span><h2><code class="docutils literal"><span class="pre">RMS.f90</span></code><a class="headerlink" href="#f/rms" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module contains the global array used when RMS force balance
is requested</p>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#f/rms/advpol2hint" title="f/rms/advpol2hint"><code class="xref f f-var docutils literal"><span class="pre">advpol2hint</span></code></a>, <a class="reference internal" href="#f/rms/advpolas2hint" title="f/rms/advpolas2hint"><code class="xref f f-var docutils literal"><span class="pre">advpolas2hint</span></code></a>, <a class="reference internal" href="#f/rms/advtor2hint" title="f/rms/advtor2hint"><code class="xref f f-var docutils literal"><span class="pre">advtor2hint</span></code></a>, <a class="reference internal" href="#f/rms/advtoras2hint" title="f/rms/advtoras2hint"><code class="xref f f-var docutils literal"><span class="pre">advtoras2hint</span></code></a>, <a class="reference internal" href="#f/rms/arc2hint" title="f/rms/arc2hint"><code class="xref f f-var docutils literal"><span class="pre">arc2hint</span></code></a>, <a class="reference internal" href="#f/rms/arcas2hint" title="f/rms/arcas2hint"><code class="xref f f-var docutils literal"><span class="pre">arcas2hint</span></code></a>, <a class="reference internal" href="#f/rms/buo2hint" title="f/rms/buo2hint"><code class="xref f f-var docutils literal"><span class="pre">buo2hint</span></code></a>, <a class="reference internal" href="#f/rms/buoas2hint" title="f/rms/buoas2hint"><code class="xref f f-var docutils literal"><span class="pre">buoas2hint</span></code></a>, <a class="reference internal" href="#f/rms/corpol2hint" title="f/rms/corpol2hint"><code class="xref f f-var docutils literal"><span class="pre">corpol2hint</span></code></a>, <a class="reference internal" href="#f/rms/corpolas2hint" title="f/rms/corpolas2hint"><code class="xref f f-var docutils literal"><span class="pre">corpolas2hint</span></code></a>, <a class="reference internal" href="#f/rms/cortor2hint" title="f/rms/cortor2hint"><code class="xref f f-var docutils literal"><span class="pre">cortor2hint</span></code></a>, <a class="reference internal" href="#f/rms/cortoras2hint" title="f/rms/cortoras2hint"><code class="xref f f-var docutils literal"><span class="pre">cortoras2hint</span></code></a>, <a class="reference internal" href="#f/rms/geo2hint" title="f/rms/geo2hint"><code class="xref f f-var docutils literal"><span class="pre">geo2hint</span></code></a>, <a class="reference internal" href="#f/rms/geoas2hint" title="f/rms/geoas2hint"><code class="xref f f-var docutils literal"><span class="pre">geoas2hint</span></code></a>, <a class="reference internal" href="#f/rms/lfpol2hint" title="f/rms/lfpol2hint"><code class="xref f f-var docutils literal"><span class="pre">lfpol2hint</span></code></a>, <a class="reference internal" href="#f/rms/lfpolas2hint" title="f/rms/lfpolas2hint"><code class="xref f f-var docutils literal"><span class="pre">lfpolas2hint</span></code></a>, <a class="reference internal" href="#f/rms/lftor2hint" title="f/rms/lftor2hint"><code class="xref f f-var docutils literal"><span class="pre">lftor2hint</span></code></a>, <a class="reference internal" href="#f/rms/lftoras2hint" title="f/rms/lftoras2hint"><code class="xref f f-var docutils literal"><span class="pre">lftoras2hint</span></code></a>, <a class="reference internal" href="#f/rms/mag2hint" title="f/rms/mag2hint"><code class="xref f f-var docutils literal"><span class="pre">mag2hint</span></code></a>, <a class="reference internal" href="#f/rms/magas2hint" title="f/rms/magas2hint"><code class="xref f f-var docutils literal"><span class="pre">magas2hint</span></code></a>, <a class="reference internal" href="#f/rms/pre2hint" title="f/rms/pre2hint"><code class="xref f f-var docutils literal"><span class="pre">pre2hint</span></code></a>, <a class="reference internal" href="#f/rms/preas2hint" title="f/rms/preas2hint"><code class="xref f f-var docutils literal"><span class="pre">preas2hint</span></code></a>, <a class="reference internal" href="#f/rms/advpollmr" title="f/rms/advpollmr"><code class="xref f f-var docutils literal"><span class="pre">advpollmr</span></code></a>, <a class="reference internal" href="#f/rms/arclmr" title="f/rms/arclmr"><code class="xref f f-var docutils literal"><span class="pre">arclmr</span></code></a>, <a class="reference internal" href="#f/rms/buolmr" title="f/rms/buolmr"><code class="xref f f-var docutils literal"><span class="pre">buolmr</span></code></a>, <a class="reference internal" href="#f/rms/corpollmr" title="f/rms/corpollmr"><code class="xref f f-var docutils literal"><span class="pre">corpollmr</span></code></a>, <a class="reference internal" href="#f/rms/difpol2hint" title="f/rms/difpol2hint"><code class="xref f f-var docutils literal"><span class="pre">difpol2hint</span></code></a>, <a class="reference internal" href="#f/rms/difpolas2hint" title="f/rms/difpolas2hint"><code class="xref f f-var docutils literal"><span class="pre">difpolas2hint</span></code></a>, <a class="reference internal" href="#f/rms/difpollmr" title="f/rms/difpollmr"><code class="xref f f-var docutils literal"><span class="pre">difpollmr</span></code></a>, <a class="reference internal" href="#f/rms/diftor2hint" title="f/rms/diftor2hint"><code class="xref f f-var docutils literal"><span class="pre">diftor2hint</span></code></a>, <a class="reference internal" href="#f/rms/diftoras2hint" title="f/rms/diftoras2hint"><code class="xref f f-var docutils literal"><span class="pre">diftoras2hint</span></code></a>, <a class="reference internal" href="#f/rms/dtbpol2hint" title="f/rms/dtbpol2hint"><code class="xref f f-var docutils literal"><span class="pre">dtbpol2hint</span></code></a>, <a class="reference internal" href="#f/rms/dtbpolas2hint" title="f/rms/dtbpolas2hint"><code class="xref f f-var docutils literal"><span class="pre">dtbpolas2hint</span></code></a>, <a class="reference internal" href="#f/rms/dtbpollmr" title="f/rms/dtbpollmr"><code class="xref f f-var docutils literal"><span class="pre">dtbpollmr</span></code></a>, <a class="reference internal" href="#f/rms/dtbtor2hint" title="f/rms/dtbtor2hint"><code class="xref f f-var docutils literal"><span class="pre">dtbtor2hint</span></code></a>, <a class="reference internal" href="#f/rms/dtbtoras2hint" title="f/rms/dtbtoras2hint"><code class="xref f f-var docutils literal"><span class="pre">dtbtoras2hint</span></code></a>, <a class="reference internal" href="#f/rms/dtvpol2hint" title="f/rms/dtvpol2hint"><code class="xref f f-var docutils literal"><span class="pre">dtvpol2hint</span></code></a>, <a class="reference internal" href="#f/rms/dtvpolas2hint" title="f/rms/dtvpolas2hint"><code class="xref f f-var docutils literal"><span class="pre">dtvpolas2hint</span></code></a>, <a class="reference internal" href="#f/rms/dtvpollmr" title="f/rms/dtvpollmr"><code class="xref f f-var docutils literal"><span class="pre">dtvpollmr</span></code></a>, <a class="reference internal" href="#f/rms/dtvtor2hint" title="f/rms/dtvtor2hint"><code class="xref f f-var docutils literal"><span class="pre">dtvtor2hint</span></code></a>, <a class="reference internal" href="#f/rms/dtvtoras2hint" title="f/rms/dtvtoras2hint"><code class="xref f f-var docutils literal"><span class="pre">dtvtoras2hint</span></code></a>, <a class="reference internal" href="#f/rms/geolmr" title="f/rms/geolmr"><code class="xref f f-var docutils literal"><span class="pre">geolmr</span></code></a>, <a class="reference internal" href="#f/rms/lfpollmr" title="f/rms/lfpollmr"><code class="xref f f-var docutils literal"><span class="pre">lfpollmr</span></code></a>, <a class="reference internal" href="#f/rms/maglmr" title="f/rms/maglmr"><code class="xref f f-var docutils literal"><span class="pre">maglmr</span></code></a>, <a class="reference internal" href="#f/rms/prelmr" title="f/rms/prelmr"><code class="xref f f-var docutils literal"><span class="pre">prelmr</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/rms/initialize_rms" title="f/rms/initialize_rms"><code class="xref f f-func docutils literal"><span class="pre">initialize_rms()</span></code></a>, <a class="reference internal" href="#f/rms/zerorms" title="f/rms/zerorms"><code class="xref f f-func docutils literal"><span class="pre">zerorms()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal"><span class="pre">zero()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal"><span class="pre">lm_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag"><code class="xref f f-func docutils literal"><span class="pre">n_r_maxmag()</span></code></a>): This module defines the grid points and the truncation</li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="variable">
<dt id="f/rms/geoas2hint">
<code class="descclassname">rms/</code><code class="descname">geoas2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/geoas2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/lfpollmr">
<code class="descclassname">rms/</code><code class="descname">lfpollmr</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/lfpollmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/advpol2hint">
<code class="descclassname">rms/</code><code class="descname">advpol2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/advpol2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/dtbpol2hint">
<code class="descclassname">rms/</code><code class="descname">dtbpol2hint</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/dtbpol2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/difpol2hint">
<code class="descclassname">rms/</code><code class="descname">difpol2hint</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/difpol2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/corpollmr">
<code class="descclassname">rms/</code><code class="descname">corpollmr</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/corpollmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/dtvtor2hint">
<code class="descclassname">rms/</code><code class="descname">dtvtor2hint</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/dtvtor2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/dtvpolas2hint">
<code class="descclassname">rms/</code><code class="descname">dtvpolas2hint</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/dtvpolas2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/lftoras2hint">
<code class="descclassname">rms/</code><code class="descname">lftoras2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/lftoras2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/dtvpol2hint">
<code class="descclassname">rms/</code><code class="descname">dtvpol2hint</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/dtvpol2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/corpol2hint">
<code class="descclassname">rms/</code><code class="descname">corpol2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/corpol2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/cortoras2hint">
<code class="descclassname">rms/</code><code class="descname">cortoras2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/cortoras2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/prelmr">
<code class="descclassname">rms/</code><code class="descname">prelmr</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/prelmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/advtor2hint">
<code class="descclassname">rms/</code><code class="descname">advtor2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/advtor2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/diftor2hint">
<code class="descclassname">rms/</code><code class="descname">diftor2hint</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/diftor2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/cortor2hint">
<code class="descclassname">rms/</code><code class="descname">cortor2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/cortor2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/buo2hint">
<code class="descclassname">rms/</code><code class="descname">buo2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/buo2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/difpollmr">
<code class="descclassname">rms/</code><code class="descname">difpollmr</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/difpollmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/dtbtoras2hint">
<code class="descclassname">rms/</code><code class="descname">dtbtoras2hint</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/dtbtoras2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/advpollmr">
<code class="descclassname">rms/</code><code class="descname">advpollmr</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/advpollmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/buolmr">
<code class="descclassname">rms/</code><code class="descname">buolmr</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/buolmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/magas2hint">
<code class="descclassname">rms/</code><code class="descname">magas2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/magas2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/advtoras2hint">
<code class="descclassname">rms/</code><code class="descname">advtoras2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/advtoras2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/geolmr">
<code class="descclassname">rms/</code><code class="descname">geolmr</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/geolmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/corpolas2hint">
<code class="descclassname">rms/</code><code class="descname">corpolas2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/corpolas2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/lfpolas2hint">
<code class="descclassname">rms/</code><code class="descname">lfpolas2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/lfpolas2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/mag2hint">
<code class="descclassname">rms/</code><code class="descname">mag2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/mag2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/dtvtoras2hint">
<code class="descclassname">rms/</code><code class="descname">dtvtoras2hint</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/dtvtoras2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/dtbpollmr">
<code class="descclassname">rms/</code><code class="descname">dtbpollmr</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/dtbpollmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/preas2hint">
<code class="descclassname">rms/</code><code class="descname">preas2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/preas2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/arclmr">
<code class="descclassname">rms/</code><code class="descname">arclmr</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/arclmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/diftoras2hint">
<code class="descclassname">rms/</code><code class="descname">diftoras2hint</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/diftoras2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/dtvpollmr">
<code class="descclassname">rms/</code><code class="descname">dtvpollmr</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/dtvpollmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/difpolas2hint">
<code class="descclassname">rms/</code><code class="descname">difpolas2hint</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/difpolas2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/arcas2hint">
<code class="descclassname">rms/</code><code class="descname">arcas2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/arcas2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/pre2hint">
<code class="descclassname">rms/</code><code class="descname">pre2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/pre2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/arc2hint">
<code class="descclassname">rms/</code><code class="descname">arc2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/arc2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/advpolas2hint">
<code class="descclassname">rms/</code><code class="descname">advpolas2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/advpolas2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/dtbtor2hint">
<code class="descclassname">rms/</code><code class="descname">dtbtor2hint</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/dtbtor2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/lftor2hint">
<code class="descclassname">rms/</code><code class="descname">lftor2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/lftor2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/buoas2hint">
<code class="descclassname">rms/</code><code class="descname">buoas2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/buoas2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/geo2hint">
<code class="descclassname">rms/</code><code class="descname">geo2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/geo2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/dtbpolas2hint">
<code class="descclassname">rms/</code><code class="descname">dtbpolas2hint</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/dtbpolas2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/maglmr">
<code class="descclassname">rms/</code><code class="descname">maglmr</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/maglmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/rms/lfpol2hint">
<code class="descclassname">rms/</code><code class="descname">lfpol2hint</code> (:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/rms/lfpol2hint" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/rms/initialize_rms">
<em class="property">subroutine  </em><code class="descclassname">rms/</code><code class="descname">initialize_rms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/rms/initialize_rms" title="Permalink to this definition">¶</a></dt>
<dd><p>Memory allocation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal"><span class="pre">magic</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/rms/zerorms">
<em class="property">subroutine  </em><code class="descclassname">rms/</code><code class="descname">zerorms</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/rms/zerorms" title="Permalink to this definition">¶</a></dt>
<dd><p>Zeros integrals that are set in get_td, update_z,
update_wp, update_b, dtVrms and dtBrms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal"><span class="pre">output()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/rms_helpers">
<span id="rms-helpers-f90"></span><h2><code class="docutils literal"><span class="pre">RMS_helpers.f90</span></code><a class="headerlink" href="#f/rms_helpers" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module contains several useful subroutines required to compute RMS
diagnostics</p>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/rms_helpers/get_ras" title="f/rms_helpers/get_ras"><code class="xref f f-func docutils literal"><span class="pre">get_ras()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/hint2dpol" title="f/rms_helpers/hint2dpol"><code class="xref f f-func docutils literal"><span class="pre">hint2dpol()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/get_poltorrms" title="f/rms_helpers/get_poltorrms"><code class="xref f f-func docutils literal"><span class="pre">get_poltorrms()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/hint2pol" title="f/rms_helpers/hint2pol"><code class="xref f f-func docutils literal"><span class="pre">hint2pol()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/init_rnb" title="f/rms_helpers/init_rnb"><code class="xref f f-func docutils literal"><span class="pre">init_rnb()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/get_paslm" title="f/rms_helpers/get_paslm"><code class="xref f f-func docutils literal"><span class="pre">get_paslm()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/hint2tor" title="f/rms_helpers/hint2tor"><code class="xref f f-func docutils literal"><span class="pre">hint2tor()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/osn1" title="f/horizontal_data/osn1"><code class="xref f f-func docutils literal"><span class="pre">osn1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/plm" title="f/horizontal_data/plm"><code class="xref f f-func docutils literal"><span class="pre">plm()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dlh" title="f/horizontal_data/dlh"><code class="xref f f-func docutils literal"><span class="pre">dlh()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dplm" title="f/horizontal_data/dplm"><code class="xref f f-func docutils literal"><span class="pre">dplm()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="misc.html#f/useful" title="f/useful: library with several useful subroutines"><code class="xref f f-mod docutils literal"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/cc2real" title="f/useful/cc2real"><code class="xref f f-func docutils literal"><span class="pre">cc2real()</span></code></a>): library with several useful subroutines</li>
<li><a class="reference internal" href="derInt.html#f/integration" title="f/integration: Radial integration functions"><code class="xref f f-mod docutils literal"><span class="pre">integration</span></code></a> (<a class="reference internal" href="derInt.html#f/integration/rint_r" title="f/integration/rint_r"><code class="xref f f-func docutils literal"><span class="pre">rint_r()</span></code></a>): Radial integration functions</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/init_costf" title="f/init_costf"><code class="xref f f-mod docutils literal"><span class="pre">init_costf</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/init_costf/init_costf1" title="f/init_costf/init_costf1"><code class="xref f f-func docutils literal"><span class="pre">init_costf1()</span></code></a>)</li>
<li><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_dr" title="f/radial_der/get_dr"><code class="xref f f-func docutils literal"><span class="pre">get_dr()</span></code></a>): Radial derivatives functions</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/chebyshev_polynoms_mod" title="f/chebyshev_polynoms_mod"><code class="xref f f-mod docutils literal"><span class="pre">chebyshev_polynoms_mod</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/chebyshev_polynoms_mod/cheb_grid" title="f/chebyshev_polynoms_mod/cheb_grid"><code class="xref f f-func docutils literal"><span class="pre">cheb_grid()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max_dtb" title="f/truncation/lm_max_dtb"><code class="xref f f-func docutils literal"><span class="pre">lm_max_dtb()</span></code></a>): This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="blocking.html#f/lmmapping" title="f/lmmapping"><code class="xref f f-mod docutils literal"><span class="pre">lmmapping</span></code></a> (<code class="xref f f-func docutils literal"><span class="pre">mappings()</span></code>)</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal"><span class="pre">lm2()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_map" title="f/blocking/st_map"><code class="xref f f-func docutils literal"><span class="pre">st_map()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/vol_oc" title="f/constants/vol_oc"><code class="xref f f-func docutils literal"><span class="pre">vol_oc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions"><code class="xref f f-mod docutils literal"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/i_costf_init" title="f/radial_functions/i_costf_init"><code class="xref f f-func docutils literal"><span class="pre">i_costf_init()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/drx" title="f/radial_functions/drx"><code class="xref f f-func docutils literal"><span class="pre">drx()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/d_costf_init" title="f/radial_functions/d_costf_init"><code class="xref f f-func docutils literal"><span class="pre">d_costf_init()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal"><span class="pre">or2()</span></code></a>)</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/rms_helpers/get_paslm">
<em class="property">subroutine  </em><code class="descclassname">rms_helpers/</code><code class="descname">get_paslm</code><span class="sig-paren">(</span><em>tlm</em>, <em>bp</em>, <em>rt</em>, <em>nthetastart</em>, <em>sizethetablock</em><span class="sig-paren">)</span><a class="headerlink" href="#f/rms_helpers/get_paslm" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Purpose of this subroutine is to calculated the axisymmetric
phi component Bp of an axisymmetric toroidal field Tlm
given in spherical harmonic space (l,m=0).</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max_dtb" title="f/truncation/lm_max_dtb">lm_max_dtb</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: field in (l,m)-space for rT</li>
<li><strong>bp</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>rt</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: radius</li>
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: first theta to be treated</li>
<li><strong>sizethetablock</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: size of theta block</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/out_rms/dtbrms" title="f/out_rms/dtbrms"><code class="xref f f-func docutils literal"><span class="pre">dtbrms()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/rms_helpers/get_poltorrms">
<em class="property">subroutine  </em><code class="descclassname">rms_helpers/</code><code class="descname">get_poltorrms</code><span class="sig-paren">(</span><em>pol</em>, <em>drpol</em>, <em>tor</em>, <em>polrms</em>, <em>torrms</em>, <em>polasrms</em>, <em>torasrms</em>, <em>map</em><span class="sig-paren">)</span><a class="headerlink" href="#f/rms_helpers/get_poltorrms" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>calculates integral PolRms=sqrt( Integral (pol^2 dV) )
calculates integral TorRms=sqrt( Integral (tor^2 dV) )
plus axisymmetric parts.
integration in theta,phi by summation of spherical harmonics
integration in r by using Chebycheff integrals
The mapping map gives the mapping lm to l,m for the input
arrays Pol,drPol and Tor
Output: PolRms,TorRms,PolAsRms,TorAsRms</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pol</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: Poloidal field Potential</li>
<li><strong>drpol</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: Radial derivative of Pol</li>
<li><strong>tor</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: Toroidal field Potential</li>
<li><strong>polrms</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>torrms</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>polasrms</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>torasrms</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>map</strong><em> [</em><em>mappings</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/out_rms/dtbrms" title="f/out_rms/dtbrms"><code class="xref f f-func docutils literal"><span class="pre">dtbrms()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="misc.html#f/useful/cc2real" title="f/useful/cc2real"><code class="xref f f-func docutils literal"><span class="pre">cc2real()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/rint_r" title="f/integration/rint_r"><code class="xref f f-func docutils literal"><span class="pre">rint_r()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/rms_helpers/hint2dpol">
<em class="property">subroutine  </em><code class="descclassname">rms_helpers/</code><code class="descname">hint2dpol</code><span class="sig-paren">(</span><em>dpol</em>, <em>lmstart</em>, <em>lmstop</em>, <em>pol2hint</em>, <em>polas2hint</em>, <em>map</em><span class="sig-paren">)</span><a class="headerlink" href="#f/rms_helpers/hint2dpol" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dpol</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: Toroidal field Potential</li>
<li><strong>lmstart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lmstop</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>pol2hint</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>polas2hint</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>map</strong><em> [</em><em>mappings</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/out_rms/dtvrms" title="f/out_rms/dtvrms"><code class="xref f f-func docutils literal"><span class="pre">dtvrms()</span></code></a>, <a class="reference internal" href="#f/out_rms/dtbrms" title="f/out_rms/dtbrms"><code class="xref f f-func docutils literal"><span class="pre">dtbrms()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="misc.html#f/useful/cc2real" title="f/useful/cc2real"><code class="xref f f-func docutils literal"><span class="pre">cc2real()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/rms_helpers/hint2pol">
<em class="property">subroutine  </em><code class="descclassname">rms_helpers/</code><code class="descname">hint2pol</code><span class="sig-paren">(</span><em>pol</em>, <em>lb</em>, <em>ub</em>, <em>nr</em>, <em>lmstart</em>, <em>lmstop</em>, <em>pollmr</em>, <em>pol2hint</em>, <em>polas2hint</em>, <em>map</em><span class="sig-paren">)</span><a class="headerlink" href="#f/rms_helpers/hint2pol" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pol</strong> (ub-lb+1)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lb</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ub</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Poloidal field Potential</li>
<li><strong>nr</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lmstart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lmstop</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>pollmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>pol2hint</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>polas2hint</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>map</strong><em> [</em><em>mappings</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="timeAdvNonLinear.html#f/nonlinear_lm_mod/get_td" title="f/nonlinear_lm_mod/get_td"><code class="xref f f-func docutils literal"><span class="pre">get_td()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updateb_mod/updateb" title="f/updateb_mod/updateb"><code class="xref f f-func docutils literal"><span class="pre">updateb()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatewp_mod/updatewp" title="f/updatewp_mod/updatewp"><code class="xref f f-func docutils literal"><span class="pre">updatewp()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="misc.html#f/useful/cc2real" title="f/useful/cc2real"><code class="xref f f-func docutils literal"><span class="pre">cc2real()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/rms_helpers/hint2tor">
<em class="property">subroutine  </em><code class="descclassname">rms_helpers/</code><code class="descname">hint2tor</code><span class="sig-paren">(</span><em>tor</em>, <em>lb</em>, <em>ub</em>, <em>nr</em>, <em>lmstart</em>, <em>lmstop</em>, <em>tor2hint</em>, <em>toras2hint</em>, <em>map</em><span class="sig-paren">)</span><a class="headerlink" href="#f/rms_helpers/hint2tor" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tor</strong> (ub-lb+1)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lb</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ub</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Toroidal field Potential</li>
<li><strong>nr</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lmstart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lmstop</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>tor2hint</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>toras2hint</strong><em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>map</strong><em> [</em><em>mappings</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="timeAdvNonLinear.html#f/nonlinear_lm_mod/get_td" title="f/nonlinear_lm_mod/get_td"><code class="xref f f-func docutils literal"><span class="pre">get_td()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updatez_mod/updatez" title="f/updatez_mod/updatez"><code class="xref f f-func docutils literal"><span class="pre">updatez()</span></code></a>, <a class="reference internal" href="timeAdvLinear.html#f/updateb_mod/updateb" title="f/updateb_mod/updateb"><code class="xref f f-func docutils literal"><span class="pre">updateb()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="misc.html#f/useful/cc2real" title="f/useful/cc2real"><code class="xref f f-func docutils literal"><span class="pre">cc2real()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/rms_helpers/get_ras">
<em class="property">subroutine  </em><code class="descclassname">rms_helpers/</code><code class="descname">get_ras</code><span class="sig-paren">(</span><em>blm</em>, <em>br</em>, <em>rt</em>, <em>nthetastart</em>, <em>sizethetablock</em><span class="sig-paren">)</span><a class="headerlink" href="#f/rms_helpers/get_ras" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Purpose of this subroutine is to calculate the axisymmetric
radial component Br of an axisymmetric ploidal field Blm
given in spherical harmonic space (l,m=0).</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>blm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max_dtb" title="f/truncation/lm_max_dtb">lm_max_dtb</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: field in (l,m)-space for rT</li>
<li><strong>br</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>rt</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: radius</li>
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: first theta to be treated</li>
<li><strong>sizethetablock</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: last theta</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/out_rms/dtbrms" title="f/out_rms/dtbrms"><code class="xref f f-func docutils literal"><span class="pre">dtbrms()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/rms_helpers/init_rnb">
<em class="property">subroutine  </em><code class="descclassname">rms_helpers/</code><code class="descname">init_rnb</code><span class="sig-paren">(</span><em>r</em>, <em>n_r_max</em>, <em>n_cheb_max</em>, <em>rcut</em>, <em>rdea</em>, <em>r2</em>, <em>n_r_max2</em>, <em>n_cheb_max2</em>, <em>ns</em>, <em>dr_fac2</em>, <em>i_costf_init2</em>, <em>ndi_costf1</em>, <em>d_costf_init2</em>, <em>ndd_costf1</em><span class="sig-paren">)</span><a class="headerlink" href="#f/rms_helpers/init_rnb" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Prepares the usage of a cut back radial grid where nS points
on both boundaries are discarded.
The aim actually is to discard boundary effects, but just
not considering the boundary grid points does not work when
you also want radial derivatives and integrals. For these
we use the Chebychev transform which needs are particular number
of grid points so that the fast cosine transform can be
applied. Therefor more than just 2 points have to be
thrown away, which may make sense anyway.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>r</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>n_r_max</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>n_cheb_max</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>rcut</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>rdea</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>r2</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>n_r_max2</strong><em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>n_cheb_max2</strong><em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>ns</strong><em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dr_fac2</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>i_costf_init2</strong> (<a class="reference internal" href="precalcModules.html#f/radial_functions/ndi_costf1" title="f/radial_functions/ndi_costf1">ndi_costf1</a>)<em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em> :: info for transform</li>
<li><strong>ndi_costf1</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>d_costf_init2</strong> (<a class="reference internal" href="precalcModules.html#f/radial_functions/ndd_costf1" title="f/radial_functions/ndd_costf1">ndd_costf1</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: info for tranfor</li>
<li><strong>ndd_costf1</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/out_rms/dtvrms" title="f/out_rms/dtvrms"><code class="xref f f-func docutils literal"><span class="pre">dtvrms()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/chebyshev_polynoms_mod/cheb_grid" title="f/chebyshev_polynoms_mod/cheb_grid"><code class="xref f f-func docutils literal"><span class="pre">cheb_grid()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/init_costf/init_costf1" title="f/init_costf/init_costf1"><code class="xref f f-func docutils literal"><span class="pre">init_costf1()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/out_rms">
<span id="out-rms-f90"></span><h2><code class="docutils literal"><span class="pre">out_RMS.f90</span></code><a class="headerlink" href="#f/out_rms" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/out_rms/dtbrms" title="f/out_rms/dtbrms"><code class="xref f f-func docutils literal"><span class="pre">dtbrms()</span></code></a>, <a class="reference internal" href="#f/out_rms/dtvrms" title="f/out_rms/dtvrms"><code class="xref f f-func docutils literal"><span class="pre">dtvrms()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/phi" title="f/horizontal_data/phi"><code class="xref f f-func docutils literal"><span class="pre">phi()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/theta_ord" title="f/horizontal_data/theta_ord"><code class="xref f f-func docutils literal"><span class="pre">theta_ord()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="#f/rms" title="f/rms: This module contains the global array used when RMS force balance is requested"><code class="xref f f-mod docutils literal"><span class="pre">rms</span></code></a> (<a class="reference internal" href="#f/rms/geoas2hint" title="f/rms/geoas2hint"><code class="xref f f-func docutils literal"><span class="pre">geoas2hint()</span></code></a>, <a class="reference internal" href="#f/rms/lfpollmr" title="f/rms/lfpollmr"><code class="xref f f-func docutils literal"><span class="pre">lfpollmr()</span></code></a>, <a class="reference internal" href="#f/rms/dtbpol2hint" title="f/rms/dtbpol2hint"><code class="xref f f-func docutils literal"><span class="pre">dtbpol2hint()</span></code></a>, <a class="reference internal" href="#f/rms/geo2hint" title="f/rms/geo2hint"><code class="xref f f-func docutils literal"><span class="pre">geo2hint()</span></code></a>, <a class="reference internal" href="#f/rms/corpollmr" title="f/rms/corpollmr"><code class="xref f f-func docutils literal"><span class="pre">corpollmr()</span></code></a>, <a class="reference internal" href="#f/rms/dtvtor2hint" title="f/rms/dtvtor2hint"><code class="xref f f-func docutils literal"><span class="pre">dtvtor2hint()</span></code></a>, <a class="reference internal" href="#f/rms/arclmr" title="f/rms/arclmr"><code class="xref f f-func docutils literal"><span class="pre">arclmr()</span></code></a>, <a class="reference internal" href="#f/rms/dtvpolas2hint" title="f/rms/dtvpolas2hint"><code class="xref f f-func docutils literal"><span class="pre">dtvpolas2hint()</span></code></a>, <a class="reference internal" href="#f/rms/lftoras2hint" title="f/rms/lftoras2hint"><code class="xref f f-func docutils literal"><span class="pre">lftoras2hint()</span></code></a>, <a class="reference internal" href="#f/rms/dtvpol2hint" title="f/rms/dtvpol2hint"><code class="xref f f-func docutils literal"><span class="pre">dtvpol2hint()</span></code></a>, <a class="reference internal" href="#f/rms/dtbpollmr" title="f/rms/dtbpollmr"><code class="xref f f-func docutils literal"><span class="pre">dtbpollmr()</span></code></a>, <a class="reference internal" href="#f/rms/cortoras2hint" title="f/rms/cortoras2hint"><code class="xref f f-func docutils literal"><span class="pre">cortoras2hint()</span></code></a>, <a class="reference internal" href="#f/rms/prelmr" title="f/rms/prelmr"><code class="xref f f-func docutils literal"><span class="pre">prelmr()</span></code></a>, <a class="reference internal" href="#f/rms/maglmr" title="f/rms/maglmr"><code class="xref f f-func docutils literal"><span class="pre">maglmr()</span></code></a>, <a class="reference internal" href="#f/rms/advtor2hint" title="f/rms/advtor2hint"><code class="xref f f-func docutils literal"><span class="pre">advtor2hint()</span></code></a>, <a class="reference internal" href="#f/rms/diftor2hint" title="f/rms/diftor2hint"><code class="xref f f-func docutils literal"><span class="pre">diftor2hint()</span></code></a>, <a class="reference internal" href="#f/rms/buo2hint" title="f/rms/buo2hint"><code class="xref f f-func docutils literal"><span class="pre">buo2hint()</span></code></a>, <a class="reference internal" href="#f/rms/difpollmr" title="f/rms/difpollmr"><code class="xref f f-func docutils literal"><span class="pre">difpollmr()</span></code></a>, <a class="reference internal" href="#f/rms/dtbtoras2hint" title="f/rms/dtbtoras2hint"><code class="xref f f-func docutils literal"><span class="pre">dtbtoras2hint()</span></code></a>, <a class="reference internal" href="#f/rms/advpollmr" title="f/rms/advpollmr"><code class="xref f f-func docutils literal"><span class="pre">advpollmr()</span></code></a>, <a class="reference internal" href="#f/rms/buolmr" title="f/rms/buolmr"><code class="xref f f-func docutils literal"><span class="pre">buolmr()</span></code></a>, <a class="reference internal" href="#f/rms/magas2hint" title="f/rms/magas2hint"><code class="xref f f-func docutils literal"><span class="pre">magas2hint()</span></code></a>, <a class="reference internal" href="#f/rms/geolmr" title="f/rms/geolmr"><code class="xref f f-func docutils literal"><span class="pre">geolmr()</span></code></a>, <a class="reference internal" href="#f/rms/corpolas2hint" title="f/rms/corpolas2hint"><code class="xref f f-func docutils literal"><span class="pre">corpolas2hint()</span></code></a>, <a class="reference internal" href="#f/rms/lfpolas2hint" title="f/rms/lfpolas2hint"><code class="xref f f-func docutils literal"><span class="pre">lfpolas2hint()</span></code></a>, <a class="reference internal" href="#f/rms/mag2hint" title="f/rms/mag2hint"><code class="xref f f-func docutils literal"><span class="pre">mag2hint()</span></code></a>, <a class="reference internal" href="#f/rms/dtvtoras2hint" title="f/rms/dtvtoras2hint"><code class="xref f f-func docutils literal"><span class="pre">dtvtoras2hint()</span></code></a>, <a class="reference internal" href="#f/rms/corpol2hint" title="f/rms/corpol2hint"><code class="xref f f-func docutils literal"><span class="pre">corpol2hint()</span></code></a>, <a class="reference internal" href="#f/rms/preas2hint" title="f/rms/preas2hint"><code class="xref f f-func docutils literal"><span class="pre">preas2hint()</span></code></a>, <a class="reference internal" href="#f/rms/cortor2hint" title="f/rms/cortor2hint"><code class="xref f f-func docutils literal"><span class="pre">cortor2hint()</span></code></a>, <a class="reference internal" href="#f/rms/diftoras2hint" title="f/rms/diftoras2hint"><code class="xref f f-func docutils literal"><span class="pre">diftoras2hint()</span></code></a>, <a class="reference internal" href="#f/rms/dtvpollmr" title="f/rms/dtvpollmr"><code class="xref f f-func docutils literal"><span class="pre">dtvpollmr()</span></code></a>, <a class="reference internal" href="#f/rms/difpolas2hint" title="f/rms/difpolas2hint"><code class="xref f f-func docutils literal"><span class="pre">difpolas2hint()</span></code></a>, <a class="reference internal" href="#f/rms/arcas2hint" title="f/rms/arcas2hint"><code class="xref f f-func docutils literal"><span class="pre">arcas2hint()</span></code></a>, <a class="reference internal" href="#f/rms/pre2hint" title="f/rms/pre2hint"><code class="xref f f-func docutils literal"><span class="pre">pre2hint()</span></code></a>, <a class="reference internal" href="#f/rms/arc2hint" title="f/rms/arc2hint"><code class="xref f f-func docutils literal"><span class="pre">arc2hint()</span></code></a>, <a class="reference internal" href="#f/rms/difpol2hint" title="f/rms/difpol2hint"><code class="xref f f-func docutils literal"><span class="pre">difpol2hint()</span></code></a>, <a class="reference internal" href="#f/rms/advpolas2hint" title="f/rms/advpolas2hint"><code class="xref f f-func docutils literal"><span class="pre">advpolas2hint()</span></code></a>, <a class="reference internal" href="#f/rms/dtbtor2hint" title="f/rms/dtbtor2hint"><code class="xref f f-func docutils literal"><span class="pre">dtbtor2hint()</span></code></a>, <a class="reference internal" href="#f/rms/lftor2hint" title="f/rms/lftor2hint"><code class="xref f f-func docutils literal"><span class="pre">lftor2hint()</span></code></a>, <a class="reference internal" href="#f/rms/buoas2hint" title="f/rms/buoas2hint"><code class="xref f f-func docutils literal"><span class="pre">buoas2hint()</span></code></a>, <a class="reference internal" href="#f/rms/advtoras2hint" title="f/rms/advtoras2hint"><code class="xref f f-func docutils literal"><span class="pre">advtoras2hint()</span></code></a>, <a class="reference internal" href="#f/rms/dtbpolas2hint" title="f/rms/dtbpolas2hint"><code class="xref f f-func docutils literal"><span class="pre">dtbpolas2hint()</span></code></a>, <a class="reference internal" href="#f/rms/advpol2hint" title="f/rms/advpol2hint"><code class="xref f f-func docutils literal"><span class="pre">advpol2hint()</span></code></a>, <a class="reference internal" href="#f/rms/lfpol2hint" title="f/rms/lfpol2hint"><code class="xref f f-func docutils literal"><span class="pre">lfpol2hint()</span></code></a>): This module contains the global array used when RMS force balance is requested</li>
<li><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/dtdrms_file" title="f/output_data/dtdrms_file"><code class="xref f f-func docutils literal"><span class="pre">dtdrms_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/dtvasrms_file" title="f/output_data/dtvasrms_file"><code class="xref f f-func docutils literal"><span class="pre">dtvasrms_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_dtvasrms_file" title="f/output_data/n_dtvasrms_file"><code class="xref f f-func docutils literal"><span class="pre">n_dtvasrms_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/rcut" title="f/output_data/rcut"><code class="xref f f-func docutils literal"><span class="pre">rcut()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_dtbrms_file" title="f/output_data/n_dtbrms_file"><code class="xref f f-func docutils literal"><span class="pre">n_dtbrms_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal"><span class="pre">tag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/runid" title="f/output_data/runid"><code class="xref f f-func docutils literal"><span class="pre">runid()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/dtvrms_file" title="f/output_data/dtvrms_file"><code class="xref f f-func docutils literal"><span class="pre">dtvrms_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/dtbrms_file" title="f/output_data/dtbrms_file"><code class="xref f f-func docutils literal"><span class="pre">dtbrms_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_dtvrms_file" title="f/output_data/n_dtvrms_file"><code class="xref f f-func docutils literal"><span class="pre">n_dtvrms_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/rdea" title="f/output_data/rdea"><code class="xref f f-func docutils literal"><span class="pre">rdea()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_dtdrms_file" title="f/output_data/n_dtdrms_file"><code class="xref f f-func docutils literal"><span class="pre">n_dtdrms_file()</span></code></a>): This module contains the parameters for output control</li>
<li><a class="reference internal" href="#f/rms_helpers" title="f/rms_helpers: This module contains several useful subroutines required to compute RMS diagnostics"><code class="xref f f-mod docutils literal"><span class="pre">rms_helpers</span></code></a> (<a class="reference internal" href="#f/rms_helpers/init_rnb" title="f/rms_helpers/init_rnb"><code class="xref f f-func docutils literal"><span class="pre">init_rnb()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/get_poltorrms" title="f/rms_helpers/get_poltorrms"><code class="xref f f-func docutils literal"><span class="pre">get_poltorrms()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/hint2dpol" title="f/rms_helpers/hint2dpol"><code class="xref f f-func docutils literal"><span class="pre">hint2dpol()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/get_ras" title="f/rms_helpers/get_ras"><code class="xref f f-func docutils literal"><span class="pre">get_ras()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/get_paslm" title="f/rms_helpers/get_paslm"><code class="xref f f-func docutils literal"><span class="pre">get_paslm()</span></code></a>): This module contains several useful subroutines required to compute RMS diagnostics</li>
<li><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/tscale" title="f/num_param/tscale"><code class="xref f f-func docutils literal"><span class="pre">tscale()</span></code></a>): Module containing numerical and control parameters</li>
<li><a class="reference internal" href="#f/dtb_mod" title="f/dtb_mod: This module contains magnetic field stretching and advection terms plus a separate omega-effect. It is used for movie output...."><code class="xref f f-mod docutils literal"><span class="pre">dtb_mod</span></code></a> (<a class="reference internal" href="#f/dtb_mod/tdifasrms" title="f/dtb_mod/tdifasrms"><code class="xref f f-func docutils literal"><span class="pre">tdifasrms()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pstrlm" title="f/dtb_mod/pstrlm"><code class="xref f f-func docutils literal"><span class="pre">pstrlm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvrms" title="f/dtb_mod/tadvrms"><code class="xref f f-func docutils literal"><span class="pre">tadvrms()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pdiflm" title="f/dtb_mod/pdiflm"><code class="xref f f-func docutils literal"><span class="pre">pdiflm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tstrrms" title="f/dtb_mod/tstrrms"><code class="xref f f-func docutils literal"><span class="pre">tstrrms()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvlm" title="f/dtb_mod/tadvlm"><code class="xref f f-func docutils literal"><span class="pre">tadvlm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pdifasrms" title="f/dtb_mod/pdifasrms"><code class="xref f f-func docutils literal"><span class="pre">pdifasrms()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tstrasrms" title="f/dtb_mod/tstrasrms"><code class="xref f f-func docutils literal"><span class="pre">tstrasrms()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tdiflm" title="f/dtb_mod/tdiflm"><code class="xref f f-func docutils literal"><span class="pre">tdiflm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tomeasrms" title="f/dtb_mod/tomeasrms"><code class="xref f f-func docutils literal"><span class="pre">tomeasrms()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvasrms" title="f/dtb_mod/tadvasrms"><code class="xref f f-func docutils literal"><span class="pre">tadvasrms()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/padvrms" title="f/dtb_mod/padvrms"><code class="xref f f-func docutils literal"><span class="pre">padvrms()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pstrasrms" title="f/dtb_mod/pstrasrms"><code class="xref f f-func docutils literal"><span class="pre">pstrasrms()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/padvlm" title="f/dtb_mod/padvlm"><code class="xref f f-func docutils literal"><span class="pre">padvlm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tstrlm" title="f/dtb_mod/tstrlm"><code class="xref f f-func docutils literal"><span class="pre">tstrlm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/padvasrms" title="f/dtb_mod/padvasrms"><code class="xref f f-func docutils literal"><span class="pre">padvasrms()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pdifrms" title="f/dtb_mod/pdifrms"><code class="xref f f-func docutils literal"><span class="pre">pdifrms()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pstrrms" title="f/dtb_mod/pstrrms"><code class="xref f f-func docutils literal"><span class="pre">pstrrms()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tomerms" title="f/dtb_mod/tomerms"><code class="xref f f-func docutils literal"><span class="pre">tomerms()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tdifrms" title="f/dtb_mod/tdifrms"><code class="xref f f-func docutils literal"><span class="pre">tdifrms()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tomelm" title="f/dtb_mod/tomelm"><code class="xref f f-func docutils literal"><span class="pre">tomelm()</span></code></a>): This module contains magnetic field stretching and advection terms plus a separate omega-effect. It is used for movie output....</li>
<li><a class="reference internal" href="derInt.html#f/integration" title="f/integration: Radial integration functions"><code class="xref f f-mod docutils literal"><span class="pre">integration</span></code></a> (<a class="reference internal" href="derInt.html#f/integration/rint_r" title="f/integration/rint_r"><code class="xref f f-func docutils literal"><span class="pre">rint_r()</span></code></a>): Radial integration functions</li>
<li><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data"><code class="xref f f-mod docutils literal"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal"><span class="pre">nrstop()</span></code></a>)</li>
<li><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</li>
<li><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications"><code class="xref f f-mod docutils literal"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/myallgather" title="f/communications/myallgather"><code class="xref f f-func docutils literal"><span class="pre">myallgather()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_rmstest" title="f/logic/l_rmstest"><code class="xref f f-func docutils literal"><span class="pre">l_rmstest()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_corr" title="f/logic/l_corr"><code class="xref f f-func docutils literal"><span class="pre">l_corr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_heat" title="f/logic/l_heat"><code class="xref f f-func docutils literal"><span class="pre">l_heat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_mag_lf" title="f/logic/l_mag_lf"><code class="xref f f-func docutils literal"><span class="pre">l_mag_lf()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_save_out" title="f/logic/l_save_out"><code class="xref f f-func docutils literal"><span class="pre">l_save_out()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_conv_nl" title="f/logic/l_conv_nl"><code class="xref f f-func docutils literal"><span class="pre">l_conv_nl()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_conv" title="f/logic/l_conv"><code class="xref f f-func docutils literal"><span class="pre">l_conv()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_drns" title="f/radial_der/get_drns"><code class="xref f f-func docutils literal"><span class="pre">get_drns()</span></code></a>): Radial derivatives functions</li>
<li><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/pr" title="f/physical_parameters/pr"><code class="xref f f-func docutils literal"><span class="pre">pr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/prmag" title="f/physical_parameters/prmag"><code class="xref f f-func docutils literal"><span class="pre">prmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/radratio" title="f/physical_parameters/radratio"><code class="xref f f-func docutils literal"><span class="pre">radratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ra" title="f/physical_parameters/ra"><code class="xref f f-func docutils literal"><span class="pre">ra()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ek" title="f/physical_parameters/ek"><code class="xref f f-func docutils literal"><span class="pre">ek()</span></code></a>): Module containing the physical parameters</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag"><code class="xref f f-func docutils literal"><span class="pre">lm_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/minc" title="f/truncation/minc"><code class="xref f f-func docutils literal"><span class="pre">minc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max_dtb" title="f/truncation/n_r_max_dtb"><code class="xref f f-func docutils literal"><span class="pre">n_r_max_dtb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max_dtb" title="f/truncation/lm_max_dtb"><code class="xref f f-func docutils literal"><span class="pre">lm_max_dtb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_cheb_max" title="f/truncation/n_cheb_max"><code class="xref f f-func docutils literal"><span class="pre">n_cheb_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag"><code class="xref f f-func docutils literal"><span class="pre">n_r_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max"><code class="xref f f-func docutils literal"><span class="pre">n_theta_max()</span></code></a>): This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal"><span class="pre">lm2()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/nthetabs" title="f/blocking/nthetabs"><code class="xref f f-func docutils literal"><span class="pre">nthetabs()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/sizethetab" title="f/blocking/sizethetab"><code class="xref f f-func docutils literal"><span class="pre">sizethetab()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs"><code class="xref f f-func docutils literal"><span class="pre">nfs()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_map" title="f/blocking/st_map"><code class="xref f f-func docutils literal"><span class="pre">st_map()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/third" title="f/constants/third"><code class="xref f f-func docutils literal"><span class="pre">third()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/four" title="f/constants/four"><code class="xref f f-func docutils literal"><span class="pre">four()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal"><span class="pre">half()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/vol_oc" title="f/constants/vol_oc"><code class="xref f f-func docutils literal"><span class="pre">vol_oc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal"><span class="pre">pi()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions"><code class="xref f f-mod docutils literal"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/i_costf_init" title="f/radial_functions/i_costf_init"><code class="xref f f-func docutils literal"><span class="pre">i_costf_init()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/drx" title="f/radial_functions/drx"><code class="xref f f-func docutils literal"><span class="pre">drx()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dr_facc" title="f/radial_functions/dr_facc"><code class="xref f f-func docutils literal"><span class="pre">dr_facc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/ndi_costf1" title="f/radial_functions/ndi_costf1"><code class="xref f f-func docutils literal"><span class="pre">ndi_costf1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/d_costf_init" title="f/radial_functions/d_costf_init"><code class="xref f f-func docutils literal"><span class="pre">d_costf_init()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/i_costf_initc" title="f/radial_functions/i_costf_initc"><code class="xref f f-func docutils literal"><span class="pre">i_costf_initc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/ndd_costf1" title="f/radial_functions/ndd_costf1"><code class="xref f f-func docutils literal"><span class="pre">ndd_costf1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/n_cheb_maxc" title="f/radial_functions/n_cheb_maxc"><code class="xref f f-func docutils literal"><span class="pre">n_cheb_maxc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rgrav" title="f/radial_functions/rgrav"><code class="xref f f-func docutils literal"><span class="pre">rgrav()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/rc" title="f/radial_functions/rc"><code class="xref f f-func docutils literal"><span class="pre">rc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/ncut" title="f/radial_functions/ncut"><code class="xref f f-func docutils literal"><span class="pre">ncut()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/d_costf_initc" title="f/radial_functions/d_costf_initc"><code class="xref f f-func docutils literal"><span class="pre">d_costf_initc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/n_r_maxc" title="f/radial_functions/n_r_maxc"><code class="xref f f-func docutils literal"><span class="pre">n_r_maxc()</span></code></a>)</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/out_rms/dtvrms">
<em class="property">subroutine  </em><code class="descclassname">out_rms/</code><code class="descname">dtvrms</code><span class="sig-paren">(</span><em>time</em>, <em>nrms_sets</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_rms/dtvrms" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>For testing RMS balance and determining the necessary values of
rDea and rCut one can use the l_RMStest=true options.
In this case the poloidal and toroidal RMS dtV which also
include the diffusion effects should be identical (as close as
desired) to the RMS sum of forces stored in the Geo value and
the Mag value, respectively.
An additional tests is the Arc value which should be identical
to the poloidal kinetic energy.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The second test with the Arc value cannot work so easily in
the anelastic version as the density enters now in the
force balance. The first test should work, though.</p>
</div>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nrms_sets</strong><em> [</em><em>integer</em><em>,</em><em>inout</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal"><span class="pre">output()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="parallelModules.html#f/communications/myallgather" title="f/communications/myallgather"><code class="xref f f-func docutils literal"><span class="pre">myallgather()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/init_rnb" title="f/rms_helpers/init_rnb"><code class="xref f f-func docutils literal"><span class="pre">init_rnb()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_drns" title="f/radial_der/get_drns"><code class="xref f f-func docutils literal"><span class="pre">get_drns()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/hint2dpol" title="f/rms_helpers/hint2dpol"><code class="xref f f-func docutils literal"><span class="pre">hint2dpol()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/rint_r" title="f/integration/rint_r"><code class="xref f f-func docutils literal"><span class="pre">rint_r()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_rms/dtbrms">
<em class="property">subroutine  </em><code class="descclassname">out_rms/</code><code class="descname">dtbrms</code><span class="sig-paren">(</span><em>time</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_rms/dtbrms" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal"><span class="pre">output()</span></code></a></td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><a class="reference internal" href="parallelModules.html#f/communications/myallgather" title="f/communications/myallgather"><code class="xref f f-func docutils literal"><span class="pre">myallgather()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_drns" title="f/radial_der/get_drns"><code class="xref f f-func docutils literal"><span class="pre">get_drns()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/get_poltorrms" title="f/rms_helpers/get_poltorrms"><code class="xref f f-func docutils literal"><span class="pre">get_poltorrms()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/hint2dpol" title="f/rms_helpers/hint2dpol"><code class="xref f f-func docutils literal"><span class="pre">hint2dpol()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/rint_r" title="f/integration/rint_r"><code class="xref f f-func docutils literal"><span class="pre">rint_r()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/get_ras" title="f/rms_helpers/get_ras"><code class="xref f f-func docutils literal"><span class="pre">get_ras()</span></code></a>, <a class="reference internal" href="#f/rms_helpers/get_paslm" title="f/rms_helpers/get_paslm"><code class="xref f f-func docutils literal"><span class="pre">get_paslm()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/dtb_mod">
<span id="dtb-f90"></span><h2><code class="docutils literal"><span class="pre">dtB.f90</span></code><a class="headerlink" href="#f/dtb_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module contains magnetic field stretching and advection terms
plus a separate omega-effect.
It is used for movie output.</p>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#f/dtb_mod/padvasrms" title="f/dtb_mod/padvasrms"><code class="xref f f-var docutils literal"><span class="pre">padvasrms</span></code></a>, <a class="reference internal" href="#f/dtb_mod/padvrms" title="f/dtb_mod/padvrms"><code class="xref f f-var docutils literal"><span class="pre">padvrms</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pdifasrms" title="f/dtb_mod/pdifasrms"><code class="xref f f-var docutils literal"><span class="pre">pdifasrms</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pdifrms" title="f/dtb_mod/pdifrms"><code class="xref f f-var docutils literal"><span class="pre">pdifrms</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pstrasrms" title="f/dtb_mod/pstrasrms"><code class="xref f f-var docutils literal"><span class="pre">pstrasrms</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pstrrms" title="f/dtb_mod/pstrrms"><code class="xref f f-var docutils literal"><span class="pre">pstrrms</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvasrms" title="f/dtb_mod/tadvasrms"><code class="xref f f-var docutils literal"><span class="pre">tadvasrms</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvrms" title="f/dtb_mod/tadvrms"><code class="xref f f-var docutils literal"><span class="pre">tadvrms</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tdifasrms" title="f/dtb_mod/tdifasrms"><code class="xref f f-var docutils literal"><span class="pre">tdifasrms</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tdifrms" title="f/dtb_mod/tdifrms"><code class="xref f f-var docutils literal"><span class="pre">tdifrms</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tomeasrms" title="f/dtb_mod/tomeasrms"><code class="xref f f-var docutils literal"><span class="pre">tomeasrms</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tomerms" title="f/dtb_mod/tomerms"><code class="xref f f-var docutils literal"><span class="pre">tomerms</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tstrasrms" title="f/dtb_mod/tstrasrms"><code class="xref f f-var docutils literal"><span class="pre">tstrasrms</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tstrrms" title="f/dtb_mod/tstrrms"><code class="xref f f-var docutils literal"><span class="pre">tstrrms</span></code></a>, <a class="reference internal" href="#f/dtb_mod/padvlm" title="f/dtb_mod/padvlm"><code class="xref f f-var docutils literal"><span class="pre">padvlm</span></code></a>, <a class="reference internal" href="#f/dtb_mod/padvlm_rloc" title="f/dtb_mod/padvlm_rloc"><code class="xref f f-var docutils literal"><span class="pre">padvlm_rloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/padvlmic" title="f/dtb_mod/padvlmic"><code class="xref f f-var docutils literal"><span class="pre">padvlmic</span></code></a>, <a class="reference internal" href="#f/dtb_mod/padvlmic_lmloc" title="f/dtb_mod/padvlmic_lmloc"><code class="xref f f-var docutils literal"><span class="pre">padvlmic_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pdiflm" title="f/dtb_mod/pdiflm"><code class="xref f f-var docutils literal"><span class="pre">pdiflm</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pdiflm_lmloc" title="f/dtb_mod/pdiflm_lmloc"><code class="xref f f-var docutils literal"><span class="pre">pdiflm_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pdiflmic" title="f/dtb_mod/pdiflmic"><code class="xref f f-var docutils literal"><span class="pre">pdiflmic</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pdiflmic_lmloc" title="f/dtb_mod/pdiflmic_lmloc"><code class="xref f f-var docutils literal"><span class="pre">pdiflmic_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pstrlm" title="f/dtb_mod/pstrlm"><code class="xref f f-var docutils literal"><span class="pre">pstrlm</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pstrlm_rloc" title="f/dtb_mod/pstrlm_rloc"><code class="xref f f-var docutils literal"><span class="pre">pstrlm_rloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvlm" title="f/dtb_mod/tadvlm"><code class="xref f f-var docutils literal"><span class="pre">tadvlm</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvlm_rloc" title="f/dtb_mod/tadvlm_rloc"><code class="xref f f-var docutils literal"><span class="pre">tadvlm_rloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvlmic" title="f/dtb_mod/tadvlmic"><code class="xref f f-var docutils literal"><span class="pre">tadvlmic</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvlmic_lmloc" title="f/dtb_mod/tadvlmic_lmloc"><code class="xref f f-var docutils literal"><span class="pre">tadvlmic_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvrlm" title="f/dtb_mod/tadvrlm"><code class="xref f f-var docutils literal"><span class="pre">tadvrlm</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvrlm_rloc" title="f/dtb_mod/tadvrlm_rloc"><code class="xref f f-var docutils literal"><span class="pre">tadvrlm_rloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tdiflm" title="f/dtb_mod/tdiflm"><code class="xref f f-var docutils literal"><span class="pre">tdiflm</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tdiflm_lmloc" title="f/dtb_mod/tdiflm_lmloc"><code class="xref f f-var docutils literal"><span class="pre">tdiflm_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tdiflmic" title="f/dtb_mod/tdiflmic"><code class="xref f f-var docutils literal"><span class="pre">tdiflmic</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tdiflmic_lmloc" title="f/dtb_mod/tdiflmic_lmloc"><code class="xref f f-var docutils literal"><span class="pre">tdiflmic_lmloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tomelm" title="f/dtb_mod/tomelm"><code class="xref f f-var docutils literal"><span class="pre">tomelm</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tomelm_rloc" title="f/dtb_mod/tomelm_rloc"><code class="xref f f-var docutils literal"><span class="pre">tomelm_rloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tomerlm" title="f/dtb_mod/tomerlm"><code class="xref f f-var docutils literal"><span class="pre">tomerlm</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tomerlm_rloc" title="f/dtb_mod/tomerlm_rloc"><code class="xref f f-var docutils literal"><span class="pre">tomerlm_rloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tstrlm" title="f/dtb_mod/tstrlm"><code class="xref f f-var docutils literal"><span class="pre">tstrlm</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tstrlm_rloc" title="f/dtb_mod/tstrlm_rloc"><code class="xref f f-var docutils literal"><span class="pre">tstrlm_rloc</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tstrrlm" title="f/dtb_mod/tstrrlm"><code class="xref f f-var docutils literal"><span class="pre">tstrrlm</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tstrrlm_rloc" title="f/dtb_mod/tstrrlm_rloc"><code class="xref f f-var docutils literal"><span class="pre">tstrrlm_rloc</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/dtb_mod/dtb_gather_rloc_on_rank0" title="f/dtb_mod/dtb_gather_rloc_on_rank0"><code class="xref f f-func docutils literal"><span class="pre">dtb_gather_rloc_on_rank0()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/initialize_dtb_mod" title="f/dtb_mod/initialize_dtb_mod"><code class="xref f f-func docutils literal"><span class="pre">initialize_dtb_mod()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/get_dh_dtblm" title="f/dtb_mod/get_dh_dtblm"><code class="xref f f-func docutils literal"><span class="pre">get_dh_dtblm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/get_dtblm" title="f/dtb_mod/get_dtblm"><code class="xref f f-func docutils literal"><span class="pre">get_dtblm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/get_dtblmfinish" title="f/dtb_mod/get_dtblmfinish"><code class="xref f f-func docutils literal"><span class="pre">get_dtblmfinish()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_b" title="f/horizontal_data/hdif_b"><code class="xref f f-func docutils literal"><span class="pre">hdif_b()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/osn1" title="f/horizontal_data/osn1"><code class="xref f f-func docutils literal"><span class="pre">osn1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/osn2" title="f/horizontal_data/osn2"><code class="xref f f-func docutils literal"><span class="pre">osn2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dlh" title="f/horizontal_data/dlh"><code class="xref f f-func docutils literal"><span class="pre">dlh()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/cosn2" title="f/horizontal_data/cosn2"><code class="xref f f-func docutils literal"><span class="pre">cosn2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/d_lp1" title="f/horizontal_data/d_lp1"><code class="xref f f-func docutils literal"><span class="pre">d_lp1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta1s" title="f/horizontal_data/dtheta1s"><code class="xref f f-func docutils literal"><span class="pre">dtheta1s()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dphi" title="f/horizontal_data/dphi"><code class="xref f f-func docutils literal"><span class="pre">dphi()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta1a" title="f/horizontal_data/dtheta1a"><code class="xref f f-func docutils literal"><span class="pre">dtheta1a()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</li>
<li><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_drns" title="f/radial_der/get_drns"><code class="xref f f-func docutils literal"><span class="pre">get_drns()</span></code></a>): Radial derivatives functions</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/fft_jw" title="f/fft_jw: This file contains the subroutines called by fftJW: fft99a, fft99b, wpass2, wpass3, wpass4 and wpass5"><code class="xref f f-mod docutils literal"><span class="pre">fft_jw</span></code></a>: This file contains the subroutines called by fftJW: fft99a, fft99b, wpass2, wpass3, wpass4 and wpass5</li>
<li><a class="reference internal" href="parallelModules.html#f/lmloop_data" title="f/lmloop_data"><code class="xref f f-mod docutils literal"><span class="pre">lmloop_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulm" title="f/lmloop_data/ulm"><code class="xref f f-func docutils literal"><span class="pre">ulm()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/lmloop_data/llmmag" title="f/lmloop_data/llmmag"><code class="xref f f-func docutils literal"><span class="pre">llmmag()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/lmloop_data/llm" title="f/lmloop_data/llm"><code class="xref f f-func docutils literal"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/lmloop_data/ulmmag" title="f/lmloop_data/ulmmag"><code class="xref f f-func docutils literal"><span class="pre">ulmmag()</span></code></a>)</li>
<li><a class="reference internal" href="#f/radial_spectra" title="f/radial_spectra"><code class="xref f f-mod docutils literal"><span class="pre">radial_spectra</span></code></a></li>
<li><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data"><code class="xref f f-mod docutils literal"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal"><span class="pre">nrstop()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications"><code class="xref f f-mod docutils literal"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gt_ic" title="f/communications/gt_ic"><code class="xref f f-func docutils literal"><span class="pre">gt_ic()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gt_oc" title="f/communications/gt_oc"><code class="xref f f-func docutils literal"><span class="pre">gt_oc()</span></code></a>)</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec" title="f/legendre_grid_to_spec"><code class="xref f f-mod docutils literal"><span class="pre">legendre_grid_to_spec</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtf2" title="f/legendre_grid_to_spec/legtf2"><code class="xref f f-func docutils literal"><span class="pre">legtf2()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtf3" title="f/legendre_grid_to_spec/legtf3"><code class="xref f f-func docutils literal"><span class="pre">legtf3()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal"><span class="pre">l_cond_ic()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_dtrmagspec" title="f/logic/l_dtrmagspec"><code class="xref f f-func docutils literal"><span class="pre">l_dtrmagspec()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/opm" title="f/physical_parameters/opm"><code class="xref f f-func docutils literal"><span class="pre">opm()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/o_sr" title="f/physical_parameters/o_sr"><code class="xref f f-func docutils literal"><span class="pre">o_sr()</span></code></a>): Module containing the physical parameters</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal"><span class="pre">n_r_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag"><code class="xref f f-func docutils literal"><span class="pre">n_r_ic_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max_dtb" title="f/truncation/n_r_ic_max_dtb"><code class="xref f f-func docutils literal"><span class="pre">n_r_ic_max_dtb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/ldtbmem" title="f/truncation/ldtbmem"><code class="xref f f-func docutils literal"><span class="pre">ldtbmem()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max_dtb" title="f/truncation/n_r_max_dtb"><code class="xref f f-func docutils literal"><span class="pre">n_r_max_dtb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max_dtb" title="f/truncation/lm_max_dtb"><code class="xref f f-func docutils literal"><span class="pre">lm_max_dtb()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp"><code class="xref f f-func docutils literal"><span class="pre">nrp()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_cheb_max" title="f/truncation/n_cheb_max"><code class="xref f f-func docutils literal"><span class="pre">n_cheb_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag"><code class="xref f f-func docutils literal"><span class="pre">n_r_maxmag()</span></code></a>): This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/l2lmas" title="f/blocking/l2lmas"><code class="xref f f-func docutils literal"><span class="pre">l2lmas()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2lmp" title="f/blocking/lm2lmp"><code class="xref f f-func docutils literal"><span class="pre">lm2lmp()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2m" title="f/blocking/lm2m"><code class="xref f f-func docutils literal"><span class="pre">lm2m()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2l" title="f/blocking/lm2l"><code class="xref f f-func docutils literal"><span class="pre">lm2l()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs"><code class="xref f f-func docutils literal"><span class="pre">nfs()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lmp2lmps" title="f/blocking/lmp2lmps"><code class="xref f f-func docutils literal"><span class="pre">lmp2lmps()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lo_map" title="f/blocking/lo_map"><code class="xref f f-func docutils literal"><span class="pre">lo_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lmp2lmpa" title="f/blocking/lmp2lmpa"><code class="xref f f-func docutils literal"><span class="pre">lmp2lmpa()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/st_map" title="f/blocking/st_map"><code class="xref f f-func docutils literal"><span class="pre">st_map()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal"><span class="pre">two()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions"><code class="xref f f-mod docutils literal"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/i_costf_init" title="f/radial_functions/i_costf_init"><code class="xref f f-func docutils literal"><span class="pre">i_costf_init()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/drx" title="f/radial_functions/drx"><code class="xref f f-func docutils literal"><span class="pre">drx()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dllambda" title="f/radial_functions/dllambda"><code class="xref f f-func docutils literal"><span class="pre">dllambda()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/d_costf_init" title="f/radial_functions/d_costf_init"><code class="xref f f-func docutils literal"><span class="pre">d_costf_init()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/o_r_ic" title="f/radial_functions/o_r_ic"><code class="xref f f-func docutils literal"><span class="pre">o_r_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/lambda" title="f/radial_functions/lambda"><code class="xref f f-func docutils literal"><span class="pre">lambda()</span></code></a>)</li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="variable">
<dt id="f/dtb_mod/tadvlmic">
<code class="descclassname">dtb_mod/</code><code class="descname">tadvlmic</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tadvlmic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/pdifrms">
<code class="descclassname">dtb_mod/</code><code class="descname">pdifrms</code><em> [</em><em>real</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/pdifrms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/pdifasrms">
<code class="descclassname">dtb_mod/</code><code class="descname">pdifasrms</code><em> [</em><em>real</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/pdifasrms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tadvlmic_lmloc">
<code class="descclassname">dtb_mod/</code><code class="descname">tadvlmic_lmloc</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tadvlmic_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tadvlm_rloc">
<code class="descclassname">dtb_mod/</code><code class="descname">tadvlm_rloc</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tadvlm_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/padvlm">
<code class="descclassname">dtb_mod/</code><code class="descname">padvlm</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/padvlm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/padvasrms">
<code class="descclassname">dtb_mod/</code><code class="descname">padvasrms</code><em> [</em><em>real</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/padvasrms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tdifrms">
<code class="descclassname">dtb_mod/</code><code class="descname">tdifrms</code><em> [</em><em>real</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tdifrms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tstrlm">
<code class="descclassname">dtb_mod/</code><code class="descname">tstrlm</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tstrlm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/pdiflm_lmloc">
<code class="descclassname">dtb_mod/</code><code class="descname">pdiflm_lmloc</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/pdiflm_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tdiflm">
<code class="descclassname">dtb_mod/</code><code class="descname">tdiflm</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tdiflm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tdiflmic">
<code class="descclassname">dtb_mod/</code><code class="descname">tdiflmic</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tdiflmic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tomerms">
<code class="descclassname">dtb_mod/</code><code class="descname">tomerms</code><em> [</em><em>real</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tomerms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tstrrms">
<code class="descclassname">dtb_mod/</code><code class="descname">tstrrms</code><em> [</em><em>real</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tstrrms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tadvlm">
<code class="descclassname">dtb_mod/</code><code class="descname">tadvlm</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tadvlm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/pstrasrms">
<code class="descclassname">dtb_mod/</code><code class="descname">pstrasrms</code><em> [</em><em>real</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/pstrasrms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tdiflm_lmloc">
<code class="descclassname">dtb_mod/</code><code class="descname">tdiflm_lmloc</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tdiflm_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tstrlm_rloc">
<code class="descclassname">dtb_mod/</code><code class="descname">tstrlm_rloc</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tstrlm_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tadvrlm_rloc">
<code class="descclassname">dtb_mod/</code><code class="descname">tadvrlm_rloc</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tadvrlm_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/padvlmic">
<code class="descclassname">dtb_mod/</code><code class="descname">padvlmic</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/padvlmic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/pdiflm">
<code class="descclassname">dtb_mod/</code><code class="descname">pdiflm</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/pdiflm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tdiflmic_lmloc">
<code class="descclassname">dtb_mod/</code><code class="descname">tdiflmic_lmloc</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tdiflmic_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/pdiflmic">
<code class="descclassname">dtb_mod/</code><code class="descname">pdiflmic</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/pdiflmic" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tstrasrms">
<code class="descclassname">dtb_mod/</code><code class="descname">tstrasrms</code><em> [</em><em>real</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tstrasrms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/pdiflmic_lmloc">
<code class="descclassname">dtb_mod/</code><code class="descname">pdiflmic_lmloc</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/pdiflmic_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tadvasrms">
<code class="descclassname">dtb_mod/</code><code class="descname">tadvasrms</code><em> [</em><em>real</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tadvasrms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/pstrlm_rloc">
<code class="descclassname">dtb_mod/</code><code class="descname">pstrlm_rloc</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/pstrlm_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tstrrlm_rloc">
<code class="descclassname">dtb_mod/</code><code class="descname">tstrrlm_rloc</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tstrrlm_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tomelm_rloc">
<code class="descclassname">dtb_mod/</code><code class="descname">tomelm_rloc</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tomelm_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tadvrms">
<code class="descclassname">dtb_mod/</code><code class="descname">tadvrms</code><em> [</em><em>real</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tadvrms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/pstrrms">
<code class="descclassname">dtb_mod/</code><code class="descname">pstrrms</code><em> [</em><em>real</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/pstrrms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tomerlm">
<code class="descclassname">dtb_mod/</code><code class="descname">tomerlm</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tomerlm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/padvlmic_lmloc">
<code class="descclassname">dtb_mod/</code><code class="descname">padvlmic_lmloc</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/padvlmic_lmloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/padvrms">
<code class="descclassname">dtb_mod/</code><code class="descname">padvrms</code><em> [</em><em>real</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/padvrms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tdifasrms">
<code class="descclassname">dtb_mod/</code><code class="descname">tdifasrms</code><em> [</em><em>real</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tdifasrms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tomeasrms">
<code class="descclassname">dtb_mod/</code><code class="descname">tomeasrms</code><em> [</em><em>real</em><em>,</em><em>public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tomeasrms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tomerlm_rloc">
<code class="descclassname">dtb_mod/</code><code class="descname">tomerlm_rloc</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tomerlm_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/pstrlm">
<code class="descclassname">dtb_mod/</code><code class="descname">pstrlm</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/pstrlm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/padvlm_rloc">
<code class="descclassname">dtb_mod/</code><code class="descname">padvlm_rloc</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/padvlm_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tadvrlm">
<code class="descclassname">dtb_mod/</code><code class="descname">tadvrlm</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tadvrlm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tomelm">
<code class="descclassname">dtb_mod/</code><code class="descname">tomelm</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tomelm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/dtb_mod/tstrrlm">
<code class="descclassname">dtb_mod/</code><code class="descname">tstrrlm</code> (:,:)<em> [</em><em>complex</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/dtb_mod/tstrrlm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/dtb_mod/initialize_dtb_mod">
<em class="property">subroutine  </em><code class="descclassname">dtb_mod/</code><code class="descname">initialize_dtb_mod</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/dtb_mod/initialize_dtb_mod" title="Permalink to this definition">¶</a></dt>
<dd><p>Memory allocation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal"><span class="pre">magic</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/dtb_mod/dtb_gather_rloc_on_rank0">
<em class="property">subroutine  </em><code class="descclassname">dtb_mod/</code><code class="descname">dtb_gather_rloc_on_rank0</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/dtb_mod/dtb_gather_rloc_on_rank0" title="Permalink to this definition">¶</a></dt>
<dd><p>MPI communicators for dtB outputs</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/dtb_mod/get_dtblmfinish" title="f/dtb_mod/get_dtblmfinish"><code class="xref f f-func docutils literal"><span class="pre">get_dtblmfinish()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/dtb_mod/get_dtblm">
<em class="property">subroutine  </em><code class="descclassname">dtb_mod/</code><code class="descname">get_dtblm</code><span class="sig-paren">(</span><em>nr</em>, <em>vr</em>, <em>vt</em>, <em>vp</em>, <em>br</em>, <em>bt</em>, <em>bp</em>, <em>n_theta_start</em>, <em>n_theta_block</em>, <em>btvrlm</em>, <em>bpvrlm</em>, <em>brvtlm</em>, <em>brvplm</em>, <em>btvplm</em>, <em>bpvtlm</em>, <em>brvzlm</em>, <em>btvzlm</em>, <em>btvpcotlm</em>, <em>bpvtcotlm</em>, <em>btvzcotlm</em>, <em>btvpsn2lm</em>, <em>bpvtsn2lm</em>, <em>btvzsn2lm</em><span class="sig-paren">)</span><a class="headerlink" href="#f/dtb_mod/get_dtblm" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nr</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>br</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>n_theta_start</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>n_theta_block</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>btvrlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>bpvrlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>brvtlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>brvplm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>btvplm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>bpvtlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>brvzlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>btvzlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>btvpcotlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>bpvtcotlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>btvzcotlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>btvpsn2lm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>bpvtsn2lm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>btvzsn2lm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp" title="f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp"><code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_openmp()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_seq()</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/fft_jw/fft_thetab" title="f/fft_jw/fft_thetab"><code class="xref f f-func docutils literal"><span class="pre">fft_thetab()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtf3" title="f/legendre_grid_to_spec/legtf3"><code class="xref f f-func docutils literal"><span class="pre">legtf3()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtf2" title="f/legendre_grid_to_spec/legtf2"><code class="xref f f-func docutils literal"><span class="pre">legtf2()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/dtb_mod/get_dtblmfinish">
<em class="property">subroutine  </em><code class="descclassname">dtb_mod/</code><code class="descname">get_dtblmfinish</code><span class="sig-paren">(</span><em>time</em>, <em>n_time_step</em>, <em>omega_ic</em>, <em>b</em>, <em>ddb</em>, <em>aj</em>, <em>dj</em>, <em>ddj</em>, <em>b_ic</em>, <em>db_ic</em>, <em>ddb_ic</em>, <em>aj_ic</em>, <em>dj_ic</em>, <em>ddj_ic</em><span class="sig-paren">)</span><a class="headerlink" href="#f/dtb_mod/get_dtblmfinish" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>n_time_step</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulmmag" title="f/lmloop_data/ulmmag">ulmmag</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llmmag" title="f/lmloop_data/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ddb</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulmmag" title="f/lmloop_data/ulmmag">ulmmag</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llmmag" title="f/lmloop_data/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>aj</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulmmag" title="f/lmloop_data/ulmmag">ulmmag</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llmmag" title="f/lmloop_data/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dj</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulmmag" title="f/lmloop_data/ulmmag">ulmmag</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llmmag" title="f/lmloop_data/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ddj</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulmmag" title="f/lmloop_data/ulmmag">ulmmag</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llmmag" title="f/lmloop_data/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b_ic</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulmmag" title="f/lmloop_data/ulmmag">ulmmag</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llmmag" title="f/lmloop_data/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>db_ic</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulmmag" title="f/lmloop_data/ulmmag">ulmmag</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llmmag" title="f/lmloop_data/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ddb_ic</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulmmag" title="f/lmloop_data/ulmmag">ulmmag</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llmmag" title="f/lmloop_data/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>aj_ic</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulmmag" title="f/lmloop_data/ulmmag">ulmmag</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llmmag" title="f/lmloop_data/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dj_ic</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulmmag" title="f/lmloop_data/ulmmag">ulmmag</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llmmag" title="f/lmloop_data/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ddj_ic</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulmmag" title="f/lmloop_data/ulmmag">ulmmag</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llmmag" title="f/lmloop_data/llmmag">llmmag</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal"><span class="pre">output()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/dtb_mod/dtb_gather_rloc_on_rank0" title="f/dtb_mod/dtb_gather_rloc_on_rank0"><code class="xref f f-func docutils literal"><span class="pre">dtb_gather_rloc_on_rank0()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_drns" title="f/radial_der/get_drns"><code class="xref f f-func docutils literal"><span class="pre">get_drns()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="#f/radial_spectra/rbrspec" title="f/radial_spectra/rbrspec"><code class="xref f f-func docutils literal"><span class="pre">rbrspec()</span></code></a>, <a class="reference internal" href="#f/radial_spectra/rbpspec" title="f/radial_spectra/rbpspec"><code class="xref f f-func docutils literal"><span class="pre">rbpspec()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/dtb_mod/get_dh_dtblm">
<em class="property">subroutine  </em><code class="descclassname">dtb_mod/</code><code class="descname">get_dh_dtblm</code><span class="sig-paren">(</span><em>nr</em>, <em>btvrlm</em>, <em>bpvrlm</em>, <em>brvtlm</em>, <em>brvplm</em>, <em>btvplm</em>, <em>bpvtlm</em>, <em>brvzlm</em>, <em>btvzlm</em>, <em>btvpcotlm</em>, <em>bpvtcotlm</em>, <em>btvzcotlm</em>, <em>btvpsn2lm</em>, <em>bpvtsn2lm</em>, <em>btvzsn2lm</em><span class="sig-paren">)</span><a class="headerlink" href="#f/dtb_mod/get_dh_dtblm" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Purpose of this routine is to calculate theta and phi
derivative related terms of the magnetic production and
advection terms and store them.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nr</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>btvrlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bpvrlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>brvtlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>brvplm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>btvplm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bpvtlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>brvzlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>btvzlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>btvpcotlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bpvtcotlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>btvzcotlm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>btvpsn2lm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bpvtsn2lm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>btvzsn2lm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp" title="f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp"><code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_openmp()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_seq()</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/out_dtb_frame">
<span id="out-dtb-frame-f90"></span><h2><code class="docutils literal"><span class="pre">out_dtB_frame.f90</span></code><a class="headerlink" href="#f/out_dtb_frame" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/out_dtb_frame/lm2pt" title="f/out_dtb_frame/lm2pt"><code class="xref f f-func docutils literal"><span class="pre">lm2pt()</span></code></a>, <a class="reference internal" href="#f/out_dtb_frame/get_dtb" title="f/out_dtb_frame/get_dtb"><code class="xref f f-func docutils literal"><span class="pre">get_dtb()</span></code></a>, <a class="reference internal" href="#f/out_dtb_frame/write_dtb_frame" title="f/out_dtb_frame/write_dtb_frame"><code class="xref f f-func docutils literal"><span class="pre">write_dtb_frame()</span></code></a>, <a class="reference internal" href="#f/out_dtb_frame/get_bpol" title="f/out_dtb_frame/get_bpol"><code class="xref f f-func docutils literal"><span class="pre">get_bpol()</span></code></a>, <a class="reference internal" href="#f/out_dtb_frame/get_btor" title="f/out_dtb_frame/get_btor"><code class="xref f f-func docutils literal"><span class="pre">get_btor()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/dplm" title="f/horizontal_data/dplm"><code class="xref f f-func docutils literal"><span class="pre">dplm()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/osn1" title="f/horizontal_data/osn1"><code class="xref f f-func docutils literal"><span class="pre">osn1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dlh" title="f/horizontal_data/dlh"><code class="xref f f-func docutils literal"><span class="pre">dlh()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/d_lp1" title="f/horizontal_data/d_lp1"><code class="xref f f-func docutils literal"><span class="pre">d_lp1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dphi" title="f/horizontal_data/dphi"><code class="xref f f-func docutils literal"><span class="pre">dphi()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/n_theta_cal2ord" title="f/horizontal_data/n_theta_cal2ord"><code class="xref f f-func docutils literal"><span class="pre">n_theta_cal2ord()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/plm" title="f/horizontal_data/plm"><code class="xref f f-func docutils literal"><span class="pre">plm()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/sintheta" title="f/horizontal_data/sintheta"><code class="xref f f-func docutils literal"><span class="pre">sintheta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/costheta" title="f/horizontal_data/costheta"><code class="xref f f-func docutils literal"><span class="pre">costheta()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="IOBinaryOutputs.html#f/movie_data" title="f/movie_data"><code class="xref f f-mod docutils literal"><span class="pre">movie_data</span></code></a> (<a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/n_movie_fields_ic" title="f/movie_data/n_movie_fields_ic"><code class="xref f f-func docutils literal"><span class="pre">n_movie_fields_ic()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/n_movie_field_type" title="f/movie_data/n_movie_field_type"><code class="xref f f-func docutils literal"><span class="pre">n_movie_field_type()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/n_movie_surface" title="f/movie_data/n_movie_surface"><code class="xref f f-func docutils literal"><span class="pre">n_movie_surface()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/movie_const" title="f/movie_data/movie_const"><code class="xref f f-func docutils literal"><span class="pre">movie_const()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/n_movie_file" title="f/movie_data/n_movie_file"><code class="xref f f-func docutils literal"><span class="pre">n_movie_file()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/n_movie_fields" title="f/movie_data/n_movie_fields"><code class="xref f f-func docutils literal"><span class="pre">n_movie_fields()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/n_movie_const" title="f/movie_data/n_movie_const"><code class="xref f f-func docutils literal"><span class="pre">n_movie_const()</span></code></a>, <a class="reference internal" href="IOBinaryOutputs.html#f/movie_data/n_movie_type" title="f/movie_data/n_movie_type"><code class="xref f f-func docutils literal"><span class="pre">n_movie_type()</span></code></a>)</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/fft_jw" title="f/fft_jw: This file contains the subroutines called by fftJW: fft99a, fft99b, wpass2, wpass3, wpass4 and wpass5"><code class="xref f f-mod docutils literal"><span class="pre">fft_jw</span></code></a>: This file contains the subroutines called by fftJW: fft99a, fft99b, wpass2, wpass3, wpass4 and wpass5</li>
<li><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_drns" title="f/radial_der/get_drns"><code class="xref f f-func docutils literal"><span class="pre">get_drns()</span></code></a>): Radial derivatives functions</li>
<li><a class="reference internal" href="#f/dtb_mod" title="f/dtb_mod: This module contains magnetic field stretching and advection terms plus a separate omega-effect. It is used for movie output...."><code class="xref f f-mod docutils literal"><span class="pre">dtb_mod</span></code></a> (<a class="reference internal" href="#f/dtb_mod/pstrlm" title="f/dtb_mod/pstrlm"><code class="xref f f-func docutils literal"><span class="pre">pstrlm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tdiflmic" title="f/dtb_mod/tdiflmic"><code class="xref f f-func docutils literal"><span class="pre">tdiflmic()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvlm" title="f/dtb_mod/tadvlm"><code class="xref f f-func docutils literal"><span class="pre">tadvlm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tomelm" title="f/dtb_mod/tomelm"><code class="xref f f-func docutils literal"><span class="pre">tomelm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tadvlmic" title="f/dtb_mod/tadvlmic"><code class="xref f f-func docutils literal"><span class="pre">tadvlmic()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tdiflm" title="f/dtb_mod/tdiflm"><code class="xref f f-func docutils literal"><span class="pre">tdiflm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pdiflmic" title="f/dtb_mod/pdiflmic"><code class="xref f f-func docutils literal"><span class="pre">pdiflmic()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/padvlm" title="f/dtb_mod/padvlm"><code class="xref f f-func docutils literal"><span class="pre">padvlm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/pdiflm" title="f/dtb_mod/pdiflm"><code class="xref f f-func docutils literal"><span class="pre">pdiflm()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/padvlmic" title="f/dtb_mod/padvlmic"><code class="xref f f-func docutils literal"><span class="pre">padvlmic()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/tstrlm" title="f/dtb_mod/tstrlm"><code class="xref f f-func docutils literal"><span class="pre">tstrlm()</span></code></a>): This module contains magnetic field stretching and advection terms plus a separate omega-effect. It is used for movie output....</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="derInt.html#f/radial_der_even" title="f/radial_der_even"><code class="xref f f-mod docutils literal"><span class="pre">radial_der_even</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der_even/get_drns_even" title="f/radial_der_even/get_drns_even"><code class="xref f f-func docutils literal"><span class="pre">get_drns_even()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal"><span class="pre">l_cond_ic()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a>: This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal"><span class="pre">lm2()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/nthetabs" title="f/blocking/nthetabs"><code class="xref f f-func docutils literal"><span class="pre">nthetabs()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/sizethetab" title="f/blocking/sizethetab"><code class="xref f f-func docutils literal"><span class="pre">sizethetab()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2m" title="f/blocking/lm2m"><code class="xref f f-func docutils literal"><span class="pre">lm2m()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2l" title="f/blocking/lm2l"><code class="xref f f-func docutils literal"><span class="pre">lm2l()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs"><code class="xref f f-func docutils literal"><span class="pre">nfs()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/ci" title="f/constants/ci"><code class="xref f f-func docutils literal"><span class="pre">ci()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions"><code class="xref f f-mod docutils literal"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/i_costf_init" title="f/radial_functions/i_costf_init"><code class="xref f f-func docutils literal"><span class="pre">i_costf_init()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/drx" title="f/radial_functions/drx"><code class="xref f f-func docutils literal"><span class="pre">drx()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/d_costf1_ic_init" title="f/radial_functions/d_costf1_ic_init"><code class="xref f f-func docutils literal"><span class="pre">d_costf1_ic_init()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/d_costf_init" title="f/radial_functions/d_costf_init"><code class="xref f f-func docutils literal"><span class="pre">d_costf_init()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/i_costf2_ic_init" title="f/radial_functions/i_costf2_ic_init"><code class="xref f f-func docutils literal"><span class="pre">i_costf2_ic_init()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_ic" title="f/radial_functions/r_ic"><code class="xref f f-func docutils literal"><span class="pre">r_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dr_fac_ic" title="f/radial_functions/dr_fac_ic"><code class="xref f f-func docutils literal"><span class="pre">dr_fac_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/i_costf1_ic_init" title="f/radial_functions/i_costf1_ic_init"><code class="xref f f-func docutils literal"><span class="pre">i_costf1_ic_init()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/d_costf2_ic_init" title="f/radial_functions/d_costf2_ic_init"><code class="xref f f-func docutils literal"><span class="pre">d_costf2_ic_init()</span></code></a>)</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/out_dtb_frame/write_dtb_frame">
<em class="property">subroutine  </em><code class="descclassname">out_dtb_frame/</code><code class="descname">write_dtb_frame</code><span class="sig-paren">(</span><em>n_movie</em>, <em>b</em>, <em>db</em>, <em>aj</em>, <em>dj</em>, <em>b_ic</em>, <em>db_ic</em>, <em>aj_ic</em>, <em>dj_ic</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_dtb_frame/write_dtb_frame" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Controls output of specific movie frames related to magnetic field
production and diffusion.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>n_movie</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>db</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>aj</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dj</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxmag" title="f/truncation/n_r_maxmag">n_r_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>db_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>aj_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dj_ic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxmag" title="f/truncation/lm_maxmag">lm_maxmag</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_maxmag" title="f/truncation/n_r_ic_maxmag">n_r_ic_maxmag</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="IOBinaryOutputs.html#f/out_movie/write_movie_frame" title="f/out_movie/write_movie_frame"><code class="xref f f-func docutils literal"><span class="pre">write_movie_frame()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/out_dtb_frame/get_dtb" title="f/out_dtb_frame/get_dtb"><code class="xref f f-func docutils literal"><span class="pre">get_dtb()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der/get_drns" title="f/radial_der/get_drns"><code class="xref f f-func docutils literal"><span class="pre">get_drns()</span></code></a>, <a class="reference internal" href="#f/out_dtb_frame/get_bpol" title="f/out_dtb_frame/get_bpol"><code class="xref f f-func docutils literal"><span class="pre">get_bpol()</span></code></a>, <a class="reference internal" href="#f/out_dtb_frame/get_btor" title="f/out_dtb_frame/get_btor"><code class="xref f f-func docutils literal"><span class="pre">get_btor()</span></code></a>, <a class="reference internal" href="#f/out_dtb_frame/lm2pt" title="f/out_dtb_frame/lm2pt"><code class="xref f f-func docutils literal"><span class="pre">lm2pt()</span></code></a>, <a class="reference internal" href="derInt.html#f/radial_der_even/get_drns_even" title="f/radial_der_even/get_drns_even"><code class="xref f f-func docutils literal"><span class="pre">get_drns_even()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_dtb_frame/get_dtb">
<em class="property">subroutine  </em><code class="descclassname">out_dtb_frame/</code><code class="descname">get_dtb</code><span class="sig-paren">(</span><em>dtb</em>, <em>dtblm</em>, <em>dimb1</em>, <em>dimb2</em>, <em>n_r</em>, <em>n_theta_start</em>, <em>n_theta_block</em>, <em>l_ic</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_dtb_frame/get_dtb" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>dtb</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dtblm</strong> (dimb1,dimb2)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dimb1</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>dimb2</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>n_r</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: No. of radial grid point</li>
<li><strong>n_theta_start</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: No. of theta to start with</li>
<li><strong>n_theta_block</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: Size of theta block</li>
<li><strong>l_ic</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: =true if inner core field</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/out_dtb_frame/write_dtb_frame" title="f/out_dtb_frame/write_dtb_frame"><code class="xref f f-func docutils literal"><span class="pre">write_dtb_frame()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_dtb_frame/get_bpol">
<em class="property">subroutine  </em><code class="descclassname">out_dtb_frame/</code><code class="descname">get_bpol</code><span class="sig-paren">(</span><em>pollm</em>, <em>dpollm</em>, <em>br</em>, <em>bt</em>, <em>bp</em>, <em>rt</em>, <em>n_theta_start</em>, <em>n_theta_block</em>, <em>lic</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_dtb_frame/get_bpol" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Purpose of this subroutine is to calculate the components
Br, Bt, and Bp of the poloidal magnetic field PolLM (l,m space)
at the radial grid point r=rT and the block of theta grid points
from n_theta=n_theta_start to n_theta=n_theta_start+n_theta_block-1
and for all phis.
For lIC=.true. the inner core field is calculated,
to get the IC field for a conducting inner core PolLM has to be
the poloidal field at the ICB.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pollm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: field in (l,m)-space for rT</li>
<li><strong>dpollm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: dr field in (l,m)-space for rT</li>
<li><strong>br</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>bt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>bp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>rt</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: radius</li>
<li><strong>n_theta_start</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: first theta to be treated</li>
<li><strong>n_theta_block</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: last theta</li>
<li><strong>lic</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: true for inner core, special rDep !</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/out_dtb_frame/write_dtb_frame" title="f/out_dtb_frame/write_dtb_frame"><code class="xref f f-func docutils literal"><span class="pre">write_dtb_frame()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/fft_jw/fft_thetab" title="f/fft_jw/fft_thetab"><code class="xref f f-func docutils literal"><span class="pre">fft_thetab()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_dtb_frame/get_btor">
<em class="property">subroutine  </em><code class="descclassname">out_dtb_frame/</code><code class="descname">get_btor</code><span class="sig-paren">(</span><em>tlm</em>, <em>bt</em>, <em>bp</em>, <em>rt</em>, <em>n_theta_start</em>, <em>n_theta_block</em>, <em>lic</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_dtb_frame/get_btor" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Purpose of this subroutine is to calculate the components
Bt and Bp of the toroidal magnetic field  Tlm (in l,m space)
at the radial grid point r=rT and the block of theta grid points
from n_theta=n_theta_start to n_theta=n_theta_start+n_theta_block-1
and for all phis.
For lIC=.true. the inner core field is calculated,
to get the IC field for a conducting inner core Plm has to be
the toroidal field at the ICB.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: field in (l,m)-space for rT</li>
<li><strong>bt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>bp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>rt</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: radius</li>
<li><strong>n_theta_start</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: first theta to be treated</li>
<li><strong>n_theta_block</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: last theta</li>
<li><strong>lic</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: true for inner core, special rDep !</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/out_dtb_frame/write_dtb_frame" title="f/out_dtb_frame/write_dtb_frame"><code class="xref f f-func docutils literal"><span class="pre">write_dtb_frame()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/fft_jw/fft_thetab" title="f/fft_jw/fft_thetab"><code class="xref f f-func docutils literal"><span class="pre">fft_thetab()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/out_dtb_frame/lm2pt">
<em class="property">subroutine  </em><code class="descclassname">out_dtb_frame/</code><code class="descname">lm2pt</code><span class="sig-paren">(</span><em>alm</em>, <em>aij</em>, <em>rt</em>, <em>nthetastart</em>, <em>lic</em>, <em>lrcomp</em><span class="sig-paren">)</span><a class="headerlink" href="#f/out_dtb_frame/lm2pt" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Spherical harmonic transform from alm(l,m) to aij(phi,theta)
Radial field components are calculated for lrComp=.true.
Done within the range [n_theta_min,n_theta_min+n_theta_block-1]
Used only for graphic output.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>alm</strong> (*)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em> :: field in (l,m)-space</li>
<li><strong>aij</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: field in (theta,phi)-space</li>
<li><strong>rt</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: first theta to be treated</li>
<li><strong>lic</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: true for inner core, extra factor !</li>
<li><strong>lrcomp</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em> :: true for radial field components</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/out_dtb_frame/write_dtb_frame" title="f/out_dtb_frame/write_dtb_frame"><code class="xref f f-func docutils literal"><span class="pre">write_dtb_frame()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/fft_jw/fft_thetab" title="f/fft_jw/fft_thetab"><code class="xref f f-func docutils literal"><span class="pre">fft_thetab()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/torsional_oscillations">
<span id="to-f90"></span><h2><code class="docutils literal"><span class="pre">TO.f90</span></code><a class="headerlink" href="#f/torsional_oscillations" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module contains information for TO calculation and output</p>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#f/torsional_oscillations/bpsdas" title="f/torsional_oscillations/bpsdas"><code class="xref f f-var docutils literal"><span class="pre">bpsdas</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bpsdas_rloc" title="f/torsional_oscillations/bpsdas_rloc"><code class="xref f f-var docutils literal"><span class="pre">bpsdas_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bpzas" title="f/torsional_oscillations/bpzas"><code class="xref f f-var docutils literal"><span class="pre">bpzas</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bpzas_rloc" title="f/torsional_oscillations/bpzas_rloc"><code class="xref f f-var docutils literal"><span class="pre">bpzas_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bpzdas" title="f/torsional_oscillations/bpzdas"><code class="xref f f-var docutils literal"><span class="pre">bpzdas</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bpzdas_rloc" title="f/torsional_oscillations/bpzdas_rloc"><code class="xref f f-var docutils literal"><span class="pre">bpzdas_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bs2as" title="f/torsional_oscillations/bs2as"><code class="xref f f-var docutils literal"><span class="pre">bs2as</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bs2as_rloc" title="f/torsional_oscillations/bs2as_rloc"><code class="xref f f-var docutils literal"><span class="pre">bs2as_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bspas" title="f/torsional_oscillations/bspas"><code class="xref f f-var docutils literal"><span class="pre">bspas</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bspas_rloc" title="f/torsional_oscillations/bspas_rloc"><code class="xref f f-var docutils literal"><span class="pre">bspas_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bspdas" title="f/torsional_oscillations/bspdas"><code class="xref f f-var docutils literal"><span class="pre">bspdas</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bspdas_rloc" title="f/torsional_oscillations/bspdas_rloc"><code class="xref f f-var docutils literal"><span class="pre">bspdas_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bszas" title="f/torsional_oscillations/bszas"><code class="xref f f-var docutils literal"><span class="pre">bszas</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bszas_rloc" title="f/torsional_oscillations/bszas_rloc"><code class="xref f f-var docutils literal"><span class="pre">bszas_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bzpdas" title="f/torsional_oscillations/bzpdas"><code class="xref f f-var docutils literal"><span class="pre">bzpdas</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bzpdas_rloc" title="f/torsional_oscillations/bzpdas_rloc"><code class="xref f f-var docutils literal"><span class="pre">bzpdas_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/ddzasl" title="f/torsional_oscillations/ddzasl"><code class="xref f f-var docutils literal"><span class="pre">ddzasl</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzastrlmr" title="f/torsional_oscillations/dzastrlmr"><code class="xref f f-var docutils literal"><span class="pre">dzastrlmr</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzastrlmr_rloc" title="f/torsional_oscillations/dzastrlmr_rloc"><code class="xref f f-var docutils literal"><span class="pre">dzastrlmr_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzcorlmr" title="f/torsional_oscillations/dzcorlmr"><code class="xref f f-var docutils literal"><span class="pre">dzcorlmr</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzcorlmr_rloc" title="f/torsional_oscillations/dzcorlmr_rloc"><code class="xref f f-var docutils literal"><span class="pre">dzcorlmr_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzddvplmr" title="f/torsional_oscillations/dzddvplmr"><code class="xref f f-var docutils literal"><span class="pre">dzddvplmr</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzddvplmr_rloc" title="f/torsional_oscillations/dzddvplmr_rloc"><code class="xref f f-var docutils literal"><span class="pre">dzddvplmr_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzdvplmr" title="f/torsional_oscillations/dzdvplmr"><code class="xref f f-var docutils literal"><span class="pre">dzdvplmr</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzdvplmr_rloc" title="f/torsional_oscillations/dzdvplmr_rloc"><code class="xref f f-var docutils literal"><span class="pre">dzdvplmr_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzlflmr" title="f/torsional_oscillations/dzlflmr"><code class="xref f f-var docutils literal"><span class="pre">dzlflmr</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzlflmr_rloc" title="f/torsional_oscillations/dzlflmr_rloc"><code class="xref f f-var docutils literal"><span class="pre">dzlflmr_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzrstrlmr" title="f/torsional_oscillations/dzrstrlmr"><code class="xref f f-var docutils literal"><span class="pre">dzrstrlmr</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzrstrlmr_rloc" title="f/torsional_oscillations/dzrstrlmr_rloc"><code class="xref f f-var docutils literal"><span class="pre">dzrstrlmr_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzstrlmr" title="f/torsional_oscillations/dzstrlmr"><code class="xref f f-var docutils literal"><span class="pre">dzstrlmr</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzstrlmr_rloc" title="f/torsional_oscillations/dzstrlmr_rloc"><code class="xref f f-var docutils literal"><span class="pre">dzstrlmr_rloc</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/v2as" title="f/torsional_oscillations/v2as"><code class="xref f f-var docutils literal"><span class="pre">v2as</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/v2as_rloc" title="f/torsional_oscillations/v2as_rloc"><code class="xref f f-var docutils literal"><span class="pre">v2as_rloc</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/torsional_oscillations/initialize_to" title="f/torsional_oscillations/initialize_to"><code class="xref f f-func docutils literal"><span class="pre">initialize_to()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/to_gather_rloc_on_rank0" title="f/torsional_oscillations/to_gather_rloc_on_rank0"><code class="xref f f-func docutils literal"><span class="pre">to_gather_rloc_on_rank0()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/gettofinish" title="f/torsional_oscillations/gettofinish"><code class="xref f f-func docutils literal"><span class="pre">gettofinish()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/getto" title="f/torsional_oscillations/getto"><code class="xref f f-func docutils literal"><span class="pre">getto()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/gettonext" title="f/torsional_oscillations/gettonext"><code class="xref f f-func docutils literal"><span class="pre">gettonext()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta1a" title="f/horizontal_data/dtheta1a"><code class="xref f f-func docutils literal"><span class="pre">dtheta1a()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dlh" title="f/horizontal_data/dlh"><code class="xref f f-func docutils literal"><span class="pre">dlh()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/hdif_v" title="f/horizontal_data/hdif_v"><code class="xref f f-func docutils literal"><span class="pre">hdif_v()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dtheta1s" title="f/horizontal_data/dtheta1s"><code class="xref f f-func docutils literal"><span class="pre">dtheta1s()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/sintheta" title="f/horizontal_data/sintheta"><code class="xref f f-func docutils literal"><span class="pre">sintheta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/costheta" title="f/horizontal_data/costheta"><code class="xref f f-func docutils literal"><span class="pre">costheta()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="parallelModules.html#f/lmloop_data" title="f/lmloop_data"><code class="xref f f-mod docutils literal"><span class="pre">lmloop_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/llmmag" title="f/lmloop_data/llmmag"><code class="xref f f-func docutils literal"><span class="pre">llmmag()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/lmloop_data/ulmmag" title="f/lmloop_data/ulmmag"><code class="xref f f-func docutils literal"><span class="pre">ulmmag()</span></code></a>)</li>
<li><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data"><code class="xref f f-mod docutils literal"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart"><code class="xref f f-func docutils literal"><span class="pre">nrstart()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop"><code class="xref f f-func docutils literal"><span class="pre">nrstop()</span></code></a>)</li>
<li><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal"><span class="pre">parallel_mod</span></code></a>: This module contains the blocking information</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec" title="f/legendre_grid_to_spec"><code class="xref f f-mod docutils literal"><span class="pre">legendre_grid_to_spec</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtfas2" title="f/legendre_grid_to_spec/legtfas2"><code class="xref f f-func docutils literal"><span class="pre">legtfas2()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_mag" title="f/logic/l_mag"><code class="xref f f-func docutils literal"><span class="pre">l_mag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/lverbose" title="f/logic/lverbose"><code class="xref f f-func docutils literal"><span class="pre">lverbose()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/kbotv" title="f/physical_parameters/kbotv"><code class="xref f f-func docutils literal"><span class="pre">kbotv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ktopv" title="f/physical_parameters/ktopv"><code class="xref f f-func docutils literal"><span class="pre">ktopv()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/corfac" title="f/physical_parameters/corfac"><code class="xref f f-func docutils literal"><span class="pre">corfac()</span></code></a>): Module containing the physical parameters</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxstr" title="f/truncation/n_r_maxstr"><code class="xref f f-func docutils literal"><span class="pre">n_r_maxstr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp"><code class="xref f f-func docutils literal"><span class="pre">nrp()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_maxstr" title="f/truncation/n_phi_maxstr"><code class="xref f f-func docutils literal"><span class="pre">n_phi_maxstr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_maxstr" title="f/truncation/n_theta_maxstr"><code class="xref f f-func docutils literal"><span class="pre">n_theta_maxstr()</span></code></a>): This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal"><span class="pre">lm2()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs"><code class="xref f f-func docutils literal"><span class="pre">nfs()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions"><code class="xref f f-mod docutils literal"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or4" title="f/radial_functions/or4"><code class="xref f f-func docutils literal"><span class="pre">or4()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or3" title="f/radial_functions/or3"><code class="xref f f-func docutils literal"><span class="pre">or3()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/beta" title="f/radial_functions/beta"><code class="xref f f-func docutils literal"><span class="pre">beta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/dbeta" title="f/radial_functions/dbeta"><code class="xref f f-func docutils literal"><span class="pre">dbeta()</span></code></a>)</li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="variable">
<dt id="f/torsional_oscillations/v2as">
<code class="descclassname">torsional_oscillations/</code><code class="descname">v2as</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/v2as" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/dzastrlmr_rloc">
<code class="descclassname">torsional_oscillations/</code><code class="descname">dzastrlmr_rloc</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/dzastrlmr_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/dzrstrlmr_rloc">
<code class="descclassname">torsional_oscillations/</code><code class="descname">dzrstrlmr_rloc</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/dzrstrlmr_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/v2as_rloc">
<code class="descclassname">torsional_oscillations/</code><code class="descname">v2as_rloc</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/v2as_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/bspas">
<code class="descclassname">torsional_oscillations/</code><code class="descname">bspas</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/bspas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/dzdvplmr">
<code class="descclassname">torsional_oscillations/</code><code class="descname">dzdvplmr</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/dzdvplmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/ddzasl">
<code class="descclassname">torsional_oscillations/</code><code class="descname">ddzasl</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/ddzasl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/bspdas">
<code class="descclassname">torsional_oscillations/</code><code class="descname">bspdas</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/bspdas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/bzpdas">
<code class="descclassname">torsional_oscillations/</code><code class="descname">bzpdas</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/bzpdas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/bspdas_rloc">
<code class="descclassname">torsional_oscillations/</code><code class="descname">bspdas_rloc</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/bspdas_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/dzdvplmr_rloc">
<code class="descclassname">torsional_oscillations/</code><code class="descname">dzdvplmr_rloc</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/dzdvplmr_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/bpsdas">
<code class="descclassname">torsional_oscillations/</code><code class="descname">bpsdas</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/bpsdas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/dzstrlmr_rloc">
<code class="descclassname">torsional_oscillations/</code><code class="descname">dzstrlmr_rloc</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/dzstrlmr_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/dzcorlmr_rloc">
<code class="descclassname">torsional_oscillations/</code><code class="descname">dzcorlmr_rloc</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/dzcorlmr_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/bpzas">
<code class="descclassname">torsional_oscillations/</code><code class="descname">bpzas</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/bpzas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/bzpdas_rloc">
<code class="descclassname">torsional_oscillations/</code><code class="descname">bzpdas_rloc</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/bzpdas_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/dzddvplmr_rloc">
<code class="descclassname">torsional_oscillations/</code><code class="descname">dzddvplmr_rloc</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/dzddvplmr_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/dzastrlmr">
<code class="descclassname">torsional_oscillations/</code><code class="descname">dzastrlmr</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/dzastrlmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/bszas">
<code class="descclassname">torsional_oscillations/</code><code class="descname">bszas</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/bszas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/dzddvplmr">
<code class="descclassname">torsional_oscillations/</code><code class="descname">dzddvplmr</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/dzddvplmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/dzlflmr">
<code class="descclassname">torsional_oscillations/</code><code class="descname">dzlflmr</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/dzlflmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/dzcorlmr">
<code class="descclassname">torsional_oscillations/</code><code class="descname">dzcorlmr</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/dzcorlmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/bs2as_rloc">
<code class="descclassname">torsional_oscillations/</code><code class="descname">bs2as_rloc</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/bs2as_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/dzrstrlmr">
<code class="descclassname">torsional_oscillations/</code><code class="descname">dzrstrlmr</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/dzrstrlmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/bspas_rloc">
<code class="descclassname">torsional_oscillations/</code><code class="descname">bspas_rloc</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/bspas_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/bpzas_rloc">
<code class="descclassname">torsional_oscillations/</code><code class="descname">bpzas_rloc</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/bpzas_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/dzlflmr_rloc">
<code class="descclassname">torsional_oscillations/</code><code class="descname">dzlflmr_rloc</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/dzlflmr_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/bs2as">
<code class="descclassname">torsional_oscillations/</code><code class="descname">bs2as</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/bs2as" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/dzstrlmr">
<code class="descclassname">torsional_oscillations/</code><code class="descname">dzstrlmr</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/dzstrlmr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/bpsdas_rloc">
<code class="descclassname">torsional_oscillations/</code><code class="descname">bpsdas_rloc</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/bpsdas_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/bpzdas_rloc">
<code class="descclassname">torsional_oscillations/</code><code class="descname">bpzdas_rloc</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/bpzdas_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/bpzdas">
<code class="descclassname">torsional_oscillations/</code><code class="descname">bpzdas</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/bpzdas" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/torsional_oscillations/bszas_rloc">
<code class="descclassname">torsional_oscillations/</code><code class="descname">bszas_rloc</code> (:,:)<em> [</em><em>real</em><em>,</em><em>allocatable/public</em><em>]</em><a class="headerlink" href="#f/torsional_oscillations/bszas_rloc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/torsional_oscillations/initialize_to">
<em class="property">subroutine  </em><code class="descclassname">torsional_oscillations/</code><code class="descname">initialize_to</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/torsional_oscillations/initialize_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Allocate the memory needed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal"><span class="pre">magic</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/torsional_oscillations/getto">
<em class="property">subroutine  </em><code class="descclassname">torsional_oscillations/</code><code class="descname">getto</code><span class="sig-paren">(</span><em>vr</em>, <em>vt</em>, <em>vp</em>, <em>cvr</em>, <em>dvpdr</em>, <em>br</em>, <em>bt</em>, <em>bp</em>, <em>cbr</em>, <em>cbt</em>, <em>bslast</em>, <em>bplast</em>, <em>bzlast</em>, <em>dzrstrlm</em>, <em>dzastrlm</em>, <em>dzcorlm</em>, <em>dzlflm</em>, <em>dtlast</em>, <em>nr</em>, <em>nthetastart</em>, <em>nthetablocksize</em><span class="sig-paren">)</span><a class="headerlink" href="#f/torsional_oscillations/getto" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This program calculates various axisymmetric linear
and nonlinear variables for a radial grid point nR and
a theta-block.
Input are the fields vr,vt,vp,cvr,dvpdr
Output are linear azimuthally averaged  field VpAS (flow phi component),
VpAS2 (square of flow phi component), V2AS (V*V),
and Coriolis force Cor. These are give in (r,theta)-space.
Also in (r,theta)-space are azimuthally averaged correlations of
non-axisymmetric flow components and the respective squares:
Vsp=Vs*Vp,Vzp,Vsz,VspC,VzpC,VszC. These are used to calulcate
the respective correlations and Reynolds stress.
In addition three output field are given in (lm,r) space:
dzRstrLMr,dzAstrLMr,dzCorLM,dzLFLM.</p>
<p>These are used to calculate the total Reynolds stress,
advection and viscous stress later. Their calculation
retraces the calculations done in the time-stepping part
of the code.</p>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cvr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvpdr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>br</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cbr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cbt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bslast</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_phi_maxstr" title="f/truncation/n_phi_maxstr">n_phi_maxstr</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_theta_maxstr" title="f/truncation/n_theta_maxstr">n_theta_maxstr</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bplast</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_phi_maxstr" title="f/truncation/n_phi_maxstr">n_phi_maxstr</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_theta_maxstr" title="f/truncation/n_theta_maxstr">n_theta_maxstr</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bzlast</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_phi_maxstr" title="f/truncation/n_phi_maxstr">n_phi_maxstr</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_theta_maxstr" title="f/truncation/n_theta_maxstr">n_theta_maxstr</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dzrstrlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dzastrlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dzcorlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dzlflm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+2)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dtlast</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: last time step</li>
<li><strong>nr</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: radial grid point</li>
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: theta block</li>
<li><strong>nthetablocksize</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp" title="f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp"><code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_openmp()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_seq()</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtfas2" title="f/legendre_grid_to_spec/legtfas2"><code class="xref f f-func docutils literal"><span class="pre">legtfas2()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/torsional_oscillations/gettonext">
<em class="property">subroutine  </em><code class="descclassname">torsional_oscillations/</code><code class="descname">gettonext</code><span class="sig-paren">(</span><em>zas</em>, <em>br</em>, <em>bt</em>, <em>bp</em>, <em>ltonext</em>, <em>ltonext2</em>, <em>dt</em>, <em>dtlast</em>, <em>nr</em>, <em>nthetastart</em>, <em>nthetablocksize</em>, <em>bslast</em>, <em>bplast</em>, <em>bzlast</em><span class="sig-paren">)</span><a class="headerlink" href="#f/torsional_oscillations/gettonext" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Preparing TO calculation by storing flow and magnetic field
contribution to build time derivative.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>zas</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>br</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ltonext</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ltonext2</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dt</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dtlast</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nr</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nthetablocksize</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bslast</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_phi_maxstr" title="f/truncation/n_phi_maxstr">n_phi_maxstr</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_theta_maxstr" title="f/truncation/n_theta_maxstr">n_theta_maxstr</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>bplast</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_phi_maxstr" title="f/truncation/n_phi_maxstr">n_phi_maxstr</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_theta_maxstr" title="f/truncation/n_theta_maxstr">n_theta_maxstr</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>bzlast</strong> (<a class="reference internal" href="baseModules.html#f/truncation/n_phi_maxstr" title="f/truncation/n_phi_maxstr">n_phi_maxstr</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_theta_maxstr" title="f/truncation/n_theta_maxstr">n_theta_maxstr</a>,<a class="reference internal" href="parallelModules.html#f/radial_data/nrstop" title="f/radial_data/nrstop">nrstop</a>-(<a class="reference internal" href="parallelModules.html#f/radial_data/nrstart" title="f/radial_data/nrstart">nrstart</a>)+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp" title="f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp"><code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_openmp()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_seq()</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/torsional_oscillations/gettofinish">
<em class="property">subroutine  </em><code class="descclassname">torsional_oscillations/</code><code class="descname">gettofinish</code><span class="sig-paren">(</span><em>nr</em>, <em>dtlast</em>, <em>zas</em>, <em>dzas</em>, <em>ddzas</em>, <em>dzrstrlm</em>, <em>dzastrlm</em>, <em>dzcorlm</em>, <em>dzlflm</em><span class="sig-paren">)</span><a class="headerlink" href="#f/torsional_oscillations/gettofinish" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nr</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dtlast</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>zas</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dzas</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ddzas</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dzrstrlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+2)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dzastrlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+2)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dzcorlm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+2)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dzlflm</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+2)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp" title="f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp"><code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_openmp()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_seq()</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/torsional_oscillations/to_gather_rloc_on_rank0">
<em class="property">subroutine  </em><code class="descclassname">torsional_oscillations/</code><code class="descname">to_gather_rloc_on_rank0</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/torsional_oscillations/to_gather_rloc_on_rank0" title="Permalink to this definition">¶</a></dt>
<dd><p>MPI communicators for TO outputs</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="#f/outto_mod/outto" title="f/outto_mod/outto"><code class="xref f f-func docutils literal"><span class="pre">outto()</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/to_helpers">
<span id="to-helpers-f90"></span><h2><code class="docutils literal"><span class="pre">TO_helpers.f90</span></code><a class="headerlink" href="#f/to_helpers" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module contains several helpful subroutines used in the TO calculations</p>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/to_helpers/getpastr" title="f/to_helpers/getpastr"><code class="xref f f-func docutils literal"><span class="pre">getpastr()</span></code></a>, <a class="reference internal" href="#f/to_helpers/getastr" title="f/to_helpers/getastr"><code class="xref f f-func docutils literal"><span class="pre">getastr()</span></code></a>, <a class="reference internal" href="#f/to_helpers/get_pas" title="f/to_helpers/get_pas"><code class="xref f f-func docutils literal"><span class="pre">get_pas()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/dplm" title="f/horizontal_data/dplm"><code class="xref f f-func docutils literal"><span class="pre">dplm()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/osn1" title="f/horizontal_data/osn1"><code class="xref f f-func docutils literal"><span class="pre">osn1()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal"><span class="pre">lm2()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal"><span class="pre">half()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal"><span class="pre">l_max()</span></code></a>): This module defines the grid points and the truncation</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/to_helpers/getpastr">
<em class="property">subroutine  </em><code class="descclassname">to_helpers/</code><code class="descname">getpastr</code><span class="sig-paren">(</span><em>fz</em>, <em>flmn</em>, <em>nzmax</em>, <em>nzmaxa</em>, <em>lmmax</em>, <em>lmax</em>, <em>rmin</em>, <em>rmax</em>, <em>nchebmax</em>, <em>rz</em>, <em>dplm</em>, <em>osints</em><span class="sig-paren">)</span><a class="headerlink" href="#f/to_helpers/getpastr" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fz</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>flmn</strong> (lmmax,*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nzmax</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nzmaxa</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lmmax</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>lmax</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>rmin</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>rmax</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nchebmax</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>rz</strong> (<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>/2+1)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dplm</strong> (lmmax,<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>/2+1)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>osints</strong> (<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>/2+1)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/outpv3/outpv" title="f/outpv3/outpv"><code class="xref f f-func docutils literal"><span class="pre">outpv()</span></code></a>, <a class="reference internal" href="#f/outto_mod/outto" title="f/outto_mod/outto"><code class="xref f f-func docutils literal"><span class="pre">outto()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/to_helpers/get_pas">
<em class="property">subroutine  </em><code class="descclassname">to_helpers/</code><code class="descname">get_pas</code><span class="sig-paren">(</span><em>tlm</em>, <em>bp</em>, <em>rt</em>, <em>nthetastart</em>, <em>sizethetablock</em><span class="sig-paren">)</span><a class="headerlink" href="#f/to_helpers/get_pas" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Purpose of this subroutine is to calculate the axisymmetric
phi component Bp of an axisymmetric toroidal field Tlm
given in spherical harmonic space (l,m=0).</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tlm</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: field in (l,m)-space for rT</li>
<li><strong>bp</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>rt</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: radius</li>
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: first theta to be treated</li>
<li><strong>sizethetablock</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: size of theta block</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/outto_mod/outto" title="f/outto_mod/outto"><code class="xref f f-func docutils literal"><span class="pre">outto()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/to_helpers/getastr">
<em class="property">subroutine  </em><code class="descclassname">to_helpers/</code><code class="descname">getastr</code><span class="sig-paren">(</span><em>fz</em>, <em>flmn</em>, <em>nzmax</em>, <em>nzmaxa</em>, <em>lmmax</em>, <em>lmax</em>, <em>rmin</em>, <em>rmax</em>, <em>nchebmax</em>, <em>rz</em>, <em>plm</em><span class="sig-paren">)</span><a class="headerlink" href="#f/to_helpers/getastr" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Calculates function value at radii rZ(nZmax) and
colatitudes for which Plm(theta) is given from
the spherical harmonic/Chebychev coefficients of an
axisymmetric function (order=0).</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>fz</strong> (*)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>flmn</strong> (lmmax,*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nzmax</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nzmaxa</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lmmax</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>lmax</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>rmin</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>rmax</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nchebmax</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>rz</strong> (<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>/2+1)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>plm</strong> (lmmax,<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>/2+1)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/outto_mod/outto" title="f/outto_mod/outto"><code class="xref f f-func docutils literal"><span class="pre">outto()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/outto_mod">
<span id="out-to-f90"></span><h2><code class="docutils literal"><span class="pre">out_TO.f90</span></code><a class="headerlink" href="#f/outto_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#f/outto_mod/lmmaxs" title="f/outto_mod/lmmaxs"><code class="xref f f-var docutils literal"><span class="pre">lmmaxs</span></code></a>, <a class="reference internal" href="#f/outto_mod/nzmaxs" title="f/outto_mod/nzmaxs"><code class="xref f f-var docutils literal"><span class="pre">nzmaxs</span></code></a>, <a class="reference internal" href="#f/outto_mod/i_costf_initz" title="f/outto_mod/i_costf_initz"><code class="xref f f-var docutils literal"><span class="pre">i_costf_initz</span></code></a>, <a class="reference internal" href="#f/outto_mod/d_costf_initz" title="f/outto_mod/d_costf_initz"><code class="xref f f-var docutils literal"><span class="pre">d_costf_initz</span></code></a>, <a class="reference internal" href="#f/outto_mod/osints" title="f/outto_mod/osints"><code class="xref f f-var docutils literal"><span class="pre">osints</span></code></a>, <a class="reference internal" href="#f/outto_mod/rz" title="f/outto_mod/rz"><code class="xref f f-var docutils literal"><span class="pre">rz</span></code></a>, <a class="reference internal" href="#f/outto_mod/zz" title="f/outto_mod/zz"><code class="xref f f-var docutils literal"><span class="pre">zz</span></code></a>, <a class="reference internal" href="#f/outto_mod/astrm" title="f/outto_mod/astrm"><code class="xref f f-var docutils literal"><span class="pre">astrm</span></code></a>, <a class="reference internal" href="#f/outto_mod/clm" title="f/outto_mod/clm"><code class="xref f f-var docutils literal"><span class="pre">clm</span></code></a>, <a class="reference internal" href="#f/outto_mod/corm" title="f/outto_mod/corm"><code class="xref f f-var docutils literal"><span class="pre">corm</span></code></a>, <a class="reference internal" href="#f/outto_mod/dvpm" title="f/outto_mod/dvpm"><code class="xref f f-var docutils literal"><span class="pre">dvpm</span></code></a>, <a class="reference internal" href="#f/outto_mod/lfm" title="f/outto_mod/lfm"><code class="xref f f-var docutils literal"><span class="pre">lfm</span></code></a>, <a class="reference internal" href="#f/outto_mod/rstrm" title="f/outto_mod/rstrm"><code class="xref f f-var docutils literal"><span class="pre">rstrm</span></code></a>, <a class="reference internal" href="#f/outto_mod/strm" title="f/outto_mod/strm"><code class="xref f f-var docutils literal"><span class="pre">strm</span></code></a>, <a class="reference internal" href="#f/outto_mod/vpm" title="f/outto_mod/vpm"><code class="xref f f-var docutils literal"><span class="pre">vpm</span></code></a>, <a class="reference internal" href="#f/outto_mod/dplms" title="f/outto_mod/dplms"><code class="xref f f-var docutils literal"><span class="pre">dplms</span></code></a>, <a class="reference internal" href="#f/outto_mod/plms" title="f/outto_mod/plms"><code class="xref f f-var docutils literal"><span class="pre">plms</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/outto_mod/initialize_outto_mod" title="f/outto_mod/initialize_outto_mod"><code class="xref f f-func docutils literal"><span class="pre">initialize_outto_mod()</span></code></a>, <a class="reference internal" href="#f/outto_mod/outto" title="f/outto_mod/outto"><code class="xref f f-func docutils literal"><span class="pre">outto()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/phi" title="f/horizontal_data/phi"><code class="xref f f-func docutils literal"><span class="pre">phi()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/gauss" title="f/horizontal_data/gauss"><code class="xref f f-func docutils literal"><span class="pre">gauss()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/theta_ord" title="f/horizontal_data/theta_ord"><code class="xref f f-func docutils literal"><span class="pre">theta_ord()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/sintheta" title="f/horizontal_data/sintheta"><code class="xref f f-func docutils literal"><span class="pre">sintheta()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="#f/chebint_mod" title="f/chebint_mod"><code class="xref f f-mod docutils literal"><span class="pre">chebint_mod</span></code></a> (<a class="reference internal" href="#f/chebint_mod/chebint" title="f/chebint_mod/chebint"><code class="xref f f-func docutils literal"><span class="pre">chebint()</span></code></a>, <a class="reference internal" href="#f/chebint_mod/chebintinit" title="f/chebint_mod/chebintinit"><code class="xref f f-func docutils literal"><span class="pre">chebintinit()</span></code></a>)</li>
<li><a class="reference internal" href="misc.html#f/useful" title="f/useful: library with several useful subroutines"><code class="xref f f-mod docutils literal"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/logwrite" title="f/useful/logwrite"><code class="xref f f-func docutils literal"><span class="pre">logwrite()</span></code></a>): library with several useful subroutines</li>
<li><a class="reference internal" href="parallelModules.html#f/lmloop_data" title="f/lmloop_data"><code class="xref f f-mod docutils literal"><span class="pre">lmloop_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/llm" title="f/lmloop_data/llm"><code class="xref f f-func docutils literal"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/lmloop_data/ulm" title="f/lmloop_data/ulm"><code class="xref f f-func docutils literal"><span class="pre">ulm()</span></code></a>)</li>
<li><a class="reference internal" href="#f/to_helpers" title="f/to_helpers: This module contains several helpful subroutines used in the TO calculations"><code class="xref f f-mod docutils literal"><span class="pre">to_helpers</span></code></a> (<a class="reference internal" href="#f/to_helpers/getpastr" title="f/to_helpers/getpastr"><code class="xref f f-func docutils literal"><span class="pre">getpastr()</span></code></a>, <a class="reference internal" href="#f/to_helpers/get_pas" title="f/to_helpers/get_pas"><code class="xref f f-func docutils literal"><span class="pre">get_pas()</span></code></a>, <a class="reference internal" href="#f/to_helpers/getastr" title="f/to_helpers/getastr"><code class="xref f f-func docutils literal"><span class="pre">getastr()</span></code></a>): This module contains several helpful subroutines used in the TO calculations</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec" title="f/legendre_grid_to_spec"><code class="xref f f-mod docutils literal"><span class="pre">legendre_grid_to_spec</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtfas2" title="f/legendre_grid_to_spec/legtfas2"><code class="xref f f-func docutils literal"><span class="pre">legtfas2()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtfas" title="f/legendre_grid_to_spec/legtfas"><code class="xref f f-func docutils literal"><span class="pre">legtfas()</span></code></a>)</li>
<li><a class="reference internal" href="derInt.html#f/integration" title="f/integration: Radial integration functions"><code class="xref f f-mod docutils literal"><span class="pre">integration</span></code></a> (<a class="reference internal" href="derInt.html#f/integration/rint_r" title="f/integration/rint_r"><code class="xref f f-func docutils literal"><span class="pre">rint_r()</span></code></a>): Radial integration functions</li>
<li><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal"><span class="pre">parallel_mod</span></code></a> (<code class="xref f f-func docutils literal"><span class="pre">rank()</span></code>): This module contains the blocking information</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/cosine_transform" title="f/cosine_transform"><code class="xref f f-mod docutils literal"><span class="pre">cosine_transform</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/cosine_transform/costf1" title="f/cosine_transform/costf1"><code class="xref f f-func docutils literal"><span class="pre">costf1()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/tscale" title="f/num_param/tscale"><code class="xref f f-func docutils literal"><span class="pre">tscale()</span></code></a>): Module containing numerical and control parameters</li>
<li><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/pr" title="f/physical_parameters/pr"><code class="xref f f-func docutils literal"><span class="pre">pr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/prmag" title="f/physical_parameters/prmag"><code class="xref f f-func docutils literal"><span class="pre">prmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/lffac" title="f/physical_parameters/lffac"><code class="xref f f-func docutils literal"><span class="pre">lffac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ek" title="f/physical_parameters/ek"><code class="xref f f-func docutils literal"><span class="pre">ek()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/radratio" title="f/physical_parameters/radratio"><code class="xref f f-func docutils literal"><span class="pre">radratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ra" title="f/physical_parameters/ra"><code class="xref f f-func docutils literal"><span class="pre">ra()</span></code></a>): Module containing the physical parameters</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions"><code class="xref f f-mod docutils literal"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/i_costf_init" title="f/radial_functions/i_costf_init"><code class="xref f f-func docutils literal"><span class="pre">i_costf_init()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/drx" title="f/radial_functions/drx"><code class="xref f f-func docutils literal"><span class="pre">drx()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/d_costf_init" title="f/radial_functions/d_costf_init"><code class="xref f f-func docutils literal"><span class="pre">d_costf_init()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r" title="f/radial_functions/r"><code class="xref f f-func docutils literal"><span class="pre">r()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal"><span class="pre">r_icb()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/plms_theta" title="f/plms_theta"><code class="xref f f-mod docutils literal"><span class="pre">plms_theta</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/plms_theta/plm_theta" title="f/plms_theta/plm_theta"><code class="xref f f-func docutils literal"><span class="pre">plm_theta()</span></code></a>)</li>
<li><a class="reference internal" href="misc.html#f/charmanip" title="f/charmanip: This module contains several useful routines to manipule character strings"><code class="xref f f-mod docutils literal"><span class="pre">charmanip</span></code></a> (<a class="reference internal" href="misc.html#f/charmanip/dble2str" title="f/charmanip/dble2str"><code class="xref f f-func docutils literal"><span class="pre">dble2str()</span></code></a>): This module contains several useful routines to manipule character strings</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/st_map" title="f/blocking/st_map"><code class="xref f f-func docutils literal"><span class="pre">st_map()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/nthetabs" title="f/blocking/nthetabs"><code class="xref f f-func docutils literal"><span class="pre">nthetabs()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs"><code class="xref f f-func docutils literal"><span class="pre">nfs()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/sizethetab" title="f/blocking/sizethetab"><code class="xref f f-func docutils literal"><span class="pre">sizethetab()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/four" title="f/constants/four"><code class="xref f f-func docutils literal"><span class="pre">four()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal"><span class="pre">half()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/vol_oc" title="f/constants/vol_oc"><code class="xref f f-func docutils literal"><span class="pre">vol_oc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal"><span class="pre">pi()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxstr" title="f/truncation/n_r_maxstr"><code class="xref f f-func docutils literal"><span class="pre">n_r_maxstr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/minc" title="f/truncation/minc"><code class="xref f f-func docutils literal"><span class="pre">minc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lstressmem" title="f/truncation/lstressmem"><code class="xref f f-func docutils literal"><span class="pre">lstressmem()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_maxstr" title="f/truncation/n_theta_maxstr"><code class="xref f f-func docutils literal"><span class="pre">n_theta_maxstr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_theta_max" title="f/truncation/n_theta_max"><code class="xref f f-func docutils literal"><span class="pre">n_theta_max()</span></code></a>): This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="#f/torsional_oscillations" title="f/torsional_oscillations: This module contains information for TO calculation and output"><code class="xref f f-mod docutils literal"><span class="pre">torsional_oscillations</span></code></a> (<a class="reference internal" href="#f/torsional_oscillations/bs2as" title="f/torsional_oscillations/bs2as"><code class="xref f f-func docutils literal"><span class="pre">bs2as()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzstrlmr" title="f/torsional_oscillations/dzstrlmr"><code class="xref f f-func docutils literal"><span class="pre">dzstrlmr()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzlflmr" title="f/torsional_oscillations/dzlflmr"><code class="xref f f-func docutils literal"><span class="pre">dzlflmr()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzrstrlmr" title="f/torsional_oscillations/dzrstrlmr"><code class="xref f f-func docutils literal"><span class="pre">dzrstrlmr()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bpzas" title="f/torsional_oscillations/bpzas"><code class="xref f f-func docutils literal"><span class="pre">bpzas()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/to_gather_rloc_on_rank0" title="f/torsional_oscillations/to_gather_rloc_on_rank0"><code class="xref f f-func docutils literal"><span class="pre">to_gather_rloc_on_rank0()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzcorlmr" title="f/torsional_oscillations/dzcorlmr"><code class="xref f f-func docutils literal"><span class="pre">dzcorlmr()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bspas" title="f/torsional_oscillations/bspas"><code class="xref f f-func docutils literal"><span class="pre">bspas()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzrstrlmr_rloc" title="f/torsional_oscillations/dzrstrlmr_rloc"><code class="xref f f-func docutils literal"><span class="pre">dzrstrlmr_rloc()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzastrlmr" title="f/torsional_oscillations/dzastrlmr"><code class="xref f f-func docutils literal"><span class="pre">dzastrlmr()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzdvplmr" title="f/torsional_oscillations/dzdvplmr"><code class="xref f f-func docutils literal"><span class="pre">dzdvplmr()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bpsdas" title="f/torsional_oscillations/bpsdas"><code class="xref f f-func docutils literal"><span class="pre">bpsdas()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/dzddvplmr" title="f/torsional_oscillations/dzddvplmr"><code class="xref f f-func docutils literal"><span class="pre">dzddvplmr()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/v2as" title="f/torsional_oscillations/v2as"><code class="xref f f-func docutils literal"><span class="pre">v2as()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bpzdas" title="f/torsional_oscillations/bpzdas"><code class="xref f f-func docutils literal"><span class="pre">bpzdas()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bspdas" title="f/torsional_oscillations/bspdas"><code class="xref f f-func docutils literal"><span class="pre">bspdas()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bszas" title="f/torsional_oscillations/bszas"><code class="xref f f-func docutils literal"><span class="pre">bszas()</span></code></a>, <a class="reference internal" href="#f/torsional_oscillations/bzpdas" title="f/torsional_oscillations/bzpdas"><code class="xref f f-func docutils literal"><span class="pre">bzpdas()</span></code></a>): This module contains information for TO calculation and output</li>
<li><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/nsmaxa" title="f/output_data/nsmaxa"><code class="xref f f-func docutils literal"><span class="pre">nsmaxa()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/n_log_file" title="f/output_data/n_log_file"><code class="xref f f-func docutils literal"><span class="pre">n_log_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa"><code class="xref f f-func docutils literal"><span class="pre">nzmaxa()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/zdens" title="f/output_data/zdens"><code class="xref f f-func docutils literal"><span class="pre">zdens()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal"><span class="pre">tag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/runid" title="f/output_data/runid"><code class="xref f f-func docutils literal"><span class="pre">runid()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/log_file" title="f/output_data/log_file"><code class="xref f f-func docutils literal"><span class="pre">log_file()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/sdens" title="f/output_data/sdens"><code class="xref f f-func docutils literal"><span class="pre">sdens()</span></code></a>): This module contains the parameters for output control</li>
<li><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications"><code class="xref f f-mod docutils literal"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gt_oc" title="f/communications/gt_oc"><code class="xref f f-func docutils literal"><span class="pre">gt_oc()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_save_out" title="f/logic/l_save_out"><code class="xref f f-func docutils literal"><span class="pre">l_save_out()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/lverbose" title="f/logic/lverbose"><code class="xref f f-func docutils literal"><span class="pre">lverbose()</span></code></a>): Module containing the logicals that control the run</li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="variable">
<dt id="f/outto_mod/rstrm">
<code class="descclassname">outto_mod/</code><code class="descname">rstrm</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outto_mod/rstrm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outto_mod/lmmaxs">
<code class="descclassname">outto_mod/</code><code class="descname">lmmaxs</code><em> [</em><em>integer</em><em>,</em><em>private</em><em>]</em><a class="headerlink" href="#f/outto_mod/lmmaxs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outto_mod/lfm">
<code class="descclassname">outto_mod/</code><code class="descname">lfm</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outto_mod/lfm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outto_mod/corm">
<code class="descclassname">outto_mod/</code><code class="descname">corm</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outto_mod/corm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outto_mod/d_costf_initz">
<code class="descclassname">outto_mod/</code><code class="descname">d_costf_initz</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outto_mod/d_costf_initz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outto_mod/astrm">
<code class="descclassname">outto_mod/</code><code class="descname">astrm</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outto_mod/astrm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outto_mod/i_costf_initz">
<code class="descclassname">outto_mod/</code><code class="descname">i_costf_initz</code> (:,:)<em> [</em><em>integer</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outto_mod/i_costf_initz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outto_mod/zz">
<code class="descclassname">outto_mod/</code><code class="descname">zz</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outto_mod/zz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outto_mod/vpm">
<code class="descclassname">outto_mod/</code><code class="descname">vpm</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outto_mod/vpm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outto_mod/nzmaxs">
<code class="descclassname">outto_mod/</code><code class="descname">nzmaxs</code> (:)<em> [</em><em>integer</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outto_mod/nzmaxs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outto_mod/clm">
<code class="descclassname">outto_mod/</code><code class="descname">clm</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outto_mod/clm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outto_mod/osints">
<code class="descclassname">outto_mod/</code><code class="descname">osints</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outto_mod/osints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outto_mod/rz">
<code class="descclassname">outto_mod/</code><code class="descname">rz</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outto_mod/rz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outto_mod/dvpm">
<code class="descclassname">outto_mod/</code><code class="descname">dvpm</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outto_mod/dvpm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outto_mod/strm">
<code class="descclassname">outto_mod/</code><code class="descname">strm</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outto_mod/strm" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outto_mod/dplms">
<code class="descclassname">outto_mod/</code><code class="descname">dplms</code> (:,:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outto_mod/dplms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outto_mod/plms">
<code class="descclassname">outto_mod/</code><code class="descname">plms</code> (:,:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outto_mod/plms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/outto_mod/initialize_outto_mod">
<em class="property">subroutine  </em><code class="descclassname">outto_mod/</code><code class="descname">initialize_outto_mod</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/outto_mod/initialize_outto_mod" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal"><span class="pre">magic</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/outto_mod/outto">
<em class="property">subroutine  </em><code class="descclassname">outto_mod/</code><code class="descname">outto</code><span class="sig-paren">(</span><em>time</em>, <em>n_time_step</em>, <em>ekin</em>, <em>ekintas</em>, <em>noutfile</em>, <em>noutfile2</em>, <em>tofilenhs</em>, <em>tofileshs</em>, <em>movfile</em>, <em>tayfile</em>, <em>ntosets</em>, <em>ntomovsets</em>, <em>ntormssets</em>, <em>ltomov</em>, <em>ltorms</em>, <em>ltozwrite</em>, <em>z</em>, <em>omega_ic</em>, <em>omega_ma</em><span class="sig-paren">)</span><a class="headerlink" href="#f/outto_mod/outto" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Output of axisymmetric zonal flow, its relative strength,
its time variation, and all forces acting on it.
The slowest part in the TO process is the repetitious calculation
of plms by subroutine plm_theta. They are needed in getAStr and
getPAStr when I transform on the cylindrical grid.
The necessary plms could simply be calculated one and then
be stored for later use!</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>n_time_step</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ekin</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ekintas</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>noutfile</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>noutfile2</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>tofilenhs</strong><em> [</em><em>character</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>tofileshs</strong><em> [</em><em>character</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>movfile</strong><em> [</em><em>character</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>tayfile</strong><em> [</em><em>character</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ntosets</strong><em> [</em><em>integer</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>ntomovsets</strong><em> [</em><em>integer</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>ntormssets</strong><em> [</em><em>integer</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>ltomov</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ltorms</strong><em> [</em><em>logical</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>ltozwrite</strong><em> [</em><em>logical</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>z</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulm" title="f/lmloop_data/ulm">ulm</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llm" title="f/lmloop_data/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal"><span class="pre">output()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/torsional_oscillations/to_gather_rloc_on_rank0" title="f/torsional_oscillations/to_gather_rloc_on_rank0"><code class="xref f f-func docutils literal"><span class="pre">to_gather_rloc_on_rank0()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtfas" title="f/legendre_grid_to_spec/legtfas"><code class="xref f f-func docutils literal"><span class="pre">legtfas()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtfas2" title="f/legendre_grid_to_spec/legtfas2"><code class="xref f f-func docutils literal"><span class="pre">legtfas2()</span></code></a>, <a class="reference internal" href="misc.html#f/charmanip/dble2str" title="f/charmanip/dble2str"><code class="xref f f-func docutils literal"><span class="pre">dble2str()</span></code></a>, <a class="reference internal" href="#f/chebint_mod/chebintinit" title="f/chebint_mod/chebintinit"><code class="xref f f-func docutils literal"><span class="pre">chebintinit()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/plms_theta/plm_theta" title="f/plms_theta/plm_theta"><code class="xref f f-func docutils literal"><span class="pre">plm_theta()</span></code></a>, <a class="reference internal" href="#f/to_helpers/getpastr" title="f/to_helpers/getpastr"><code class="xref f f-func docutils literal"><span class="pre">getpastr()</span></code></a>, <a class="reference internal" href="#f/to_helpers/getastr" title="f/to_helpers/getastr"><code class="xref f f-func docutils literal"><span class="pre">getastr()</span></code></a>, <a class="reference internal" href="#f/chebint_mod/chebint" title="f/chebint_mod/chebint"><code class="xref f f-func docutils literal"><span class="pre">chebint()</span></code></a>, <a class="reference internal" href="misc.html#f/useful/logwrite" title="f/useful/logwrite"><code class="xref f f-func docutils literal"><span class="pre">logwrite()</span></code></a>, <a class="reference internal" href="#f/to_helpers/get_pas" title="f/to_helpers/get_pas"><code class="xref f f-func docutils literal"><span class="pre">get_pas()</span></code></a>, <a class="reference internal" href="derInt.html#f/integration/rint_r" title="f/integration/rint_r"><code class="xref f f-func docutils literal"><span class="pre">rint_r()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/radial_spectra">
<span id="radial-spectra-f90"></span><h2><code class="docutils literal"><span class="pre">radial_spectra.f90</span></code><a class="headerlink" href="#f/radial_spectra" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/radial_spectra/rbrspec" title="f/radial_spectra/rbrspec"><code class="xref f f-func docutils literal"><span class="pre">rbrspec()</span></code></a>, <a class="reference internal" href="#f/radial_spectra/rbpspec" title="f/radial_spectra/rbpspec"><code class="xref f f-func docutils literal"><span class="pre">rbpspec()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/dlh" title="f/horizontal_data/dlh"><code class="xref f f-func docutils literal"><span class="pre">dlh()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="misc.html#f/useful" title="f/useful: library with several useful subroutines"><code class="xref f f-mod docutils literal"><span class="pre">useful</span></code></a> (<a class="reference internal" href="misc.html#f/useful/cc2real" title="f/useful/cc2real"><code class="xref f f-func docutils literal"><span class="pre">cc2real()</span></code></a>): library with several useful subroutines</li>
<li><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal"><span class="pre">tag()</span></code></a>): This module contains the parameters for output control</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_cond_ic" title="f/logic/l_cond_ic"><code class="xref f f-func docutils literal"><span class="pre">l_cond_ic()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data"><code class="xref f f-mod docutils literal"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal"><span class="pre">n_r_icb()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/escale" title="f/num_param/escale"><code class="xref f f-func docutils literal"><span class="pre">escale()</span></code></a>): Module containing numerical and control parameters</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max"><code class="xref f f-func docutils literal"><span class="pre">n_r_ic_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_tot" title="f/truncation/n_r_tot"><code class="xref f f-func docutils literal"><span class="pre">n_r_tot()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal"><span class="pre">n_r_max()</span></code></a>): This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="blocking.html#f/lmmapping" title="f/lmmapping"><code class="xref f f-mod docutils literal"><span class="pre">lmmapping</span></code></a> (<code class="xref f f-func docutils literal"><span class="pre">mappings()</span></code>)</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/st_map" title="f/blocking/st_map"><code class="xref f f-func docutils literal"><span class="pre">st_map()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/four" title="f/constants/four"><code class="xref f f-func docutils literal"><span class="pre">four()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal"><span class="pre">half()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions"><code class="xref f f-mod docutils literal"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_ic" title="f/radial_functions/r_ic"><code class="xref f f-func docutils literal"><span class="pre">r_ic()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal"><span class="pre">or2()</span></code></a>)</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/radial_spectra/rbrspec">
<em class="property">subroutine  </em><code class="descclassname">radial_spectra/</code><code class="descname">rbrspec</code><span class="sig-paren">(</span><em>time</em>, <em>pol</em>, <em>polic</em>, <em>fileroot</em>, <em>lic</em>, <em>map</em><span class="sig-paren">)</span><a class="headerlink" href="#f/radial_spectra/rbrspec" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>pol</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>polic</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>fileroot</strong><em> [</em><em>character</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lic</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>map</strong><em> [</em><em>mappings</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal"><span class="pre">output()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/get_dtblmfinish" title="f/dtb_mod/get_dtblmfinish"><code class="xref f f-func docutils literal"><span class="pre">get_dtblmfinish()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="misc.html#f/useful/cc2real" title="f/useful/cc2real"><code class="xref f f-func docutils literal"><span class="pre">cc2real()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/radial_spectra/rbpspec">
<em class="property">subroutine  </em><code class="descclassname">radial_spectra/</code><code class="descname">rbpspec</code><span class="sig-paren">(</span><em>time</em>, <em>tor</em>, <em>toric</em>, <em>fileroot</em>, <em>lic</em>, <em>map</em><span class="sig-paren">)</span><a class="headerlink" href="#f/radial_spectra/rbpspec" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Called from rank0, map gives the lm order of Tor and TorIC</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>tor</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>toric</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_ic_max" title="f/truncation/n_r_ic_max">n_r_ic_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>fileroot</strong><em> [</em><em>character</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lic</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>map</strong><em> [</em><em>mappings</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal"><span class="pre">output()</span></code></a>, <a class="reference internal" href="#f/dtb_mod/get_dtblmfinish" title="f/dtb_mod/get_dtblmfinish"><code class="xref f f-func docutils literal"><span class="pre">get_dtblmfinish()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="misc.html#f/useful/cc2real" title="f/useful/cc2real"><code class="xref f f-func docutils literal"><span class="pre">cc2real()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/egeos_mod">
<span id="egeos-f90"></span><h2><code class="docutils literal"><span class="pre">Egeos.f90</span></code><a class="headerlink" href="#f/egeos_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#f/egeos_mod/orhoz" title="f/egeos_mod/orhoz"><code class="xref f f-var docutils literal"><span class="pre">orhoz</span></code></a>, <a class="reference internal" href="#f/egeos_mod/rhoz" title="f/egeos_mod/rhoz"><code class="xref f f-var docutils literal"><span class="pre">rhoz</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/egeos_mod/initialize_egeos_mod" title="f/egeos_mod/initialize_egeos_mod"><code class="xref f f-func docutils literal"><span class="pre">initialize_egeos_mod()</span></code></a>, <a class="reference internal" href="#f/egeos_mod/getegeos" title="f/egeos_mod/getegeos"><code class="xref f f-func docutils literal"><span class="pre">getegeos()</span></code></a>, <a class="reference internal" href="#f/egeos_mod/getdvptr" title="f/egeos_mod/getdvptr"><code class="xref f f-func docutils literal"><span class="pre">getdvptr()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/dphi" title="f/horizontal_data/dphi"><code class="xref f f-func docutils literal"><span class="pre">dphi()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/phi" title="f/horizontal_data/phi"><code class="xref f f-func docutils literal"><span class="pre">phi()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dlh" title="f/horizontal_data/dlh"><code class="xref f f-func docutils literal"><span class="pre">dlh()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal"><span class="pre">parallel_mod</span></code></a> (<code class="xref f f-func docutils literal"><span class="pre">rank()</span></code>): This module contains the blocking information</li>
<li><a class="reference internal" href="#f/chebint_mod" title="f/chebint_mod"><code class="xref f f-mod docutils literal"><span class="pre">chebint_mod</span></code></a></li>
<li><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/nsmaxa" title="f/output_data/nsmaxa"><code class="xref f f-func docutils literal"><span class="pre">nsmaxa()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa"><code class="xref f f-func docutils literal"><span class="pre">nzmaxa()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/zdens" title="f/output_data/zdens"><code class="xref f f-func docutils literal"><span class="pre">zdens()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal"><span class="pre">tag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/runid" title="f/output_data/runid"><code class="xref f f-func docutils literal"><span class="pre">runid()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/sdens" title="f/output_data/sdens"><code class="xref f f-func docutils literal"><span class="pre">sdens()</span></code></a>): This module contains the parameters for output control</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_corrmov" title="f/logic/l_corrmov"><code class="xref f f-func docutils literal"><span class="pre">l_corrmov()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/lverbose" title="f/logic/lverbose"><code class="xref f f-func docutils literal"><span class="pre">lverbose()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/l_anel" title="f/logic/l_anel"><code class="xref f f-func docutils literal"><span class="pre">l_anel()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/fft_jw" title="f/fft_jw: This file contains the subroutines called by fftJW: fft99a, fft99b, wpass2, wpass3, wpass4 and wpass5"><code class="xref f f-mod docutils literal"><span class="pre">fft_jw</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/fft_jw/fft_to_real" title="f/fft_jw/fft_to_real"><code class="xref f f-func docutils literal"><span class="pre">fft_to_real()</span></code></a>): This file contains the subroutines called by fftJW: fft99a, fft99b, wpass2, wpass3, wpass4 and wpass5</li>
<li><a class="reference internal" href="parallelModules.html#f/lmloop_data" title="f/lmloop_data"><code class="xref f f-mod docutils literal"><span class="pre">lmloop_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/llm" title="f/lmloop_data/llm"><code class="xref f f-func docutils literal"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/lmloop_data/ulm" title="f/lmloop_data/ulm"><code class="xref f f-func docutils literal"><span class="pre">ulm()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications"><code class="xref f f-mod docutils literal"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gt_oc" title="f/communications/gt_oc"><code class="xref f f-func docutils literal"><span class="pre">gt_oc()</span></code></a>)</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/plms_theta" title="f/plms_theta"><code class="xref f f-mod docutils literal"><span class="pre">plms_theta</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/plms_theta/plm_theta" title="f/plms_theta/plm_theta"><code class="xref f f-func docutils literal"><span class="pre">plm_theta()</span></code></a>)</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/cosine_transform" title="f/cosine_transform"><code class="xref f f-mod docutils literal"><span class="pre">cosine_transform</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/cosine_transform/costf1" title="f/cosine_transform/costf1"><code class="xref f f-func docutils literal"><span class="pre">costf1()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/num_param" title="f/num_param: Module containing numerical and control parameters"><code class="xref f f-mod docutils literal"><span class="pre">num_param</span></code></a> (<a class="reference internal" href="baseModules.html#f/num_param/tscale" title="f/num_param/tscale"><code class="xref f f-func docutils literal"><span class="pre">tscale()</span></code></a>): Module containing numerical and control parameters</li>
<li><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/pr" title="f/physical_parameters/pr"><code class="xref f f-func docutils literal"><span class="pre">pr()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/prmag" title="f/physical_parameters/prmag"><code class="xref f f-func docutils literal"><span class="pre">prmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ek" title="f/physical_parameters/ek"><code class="xref f f-func docutils literal"><span class="pre">ek()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/g1" title="f/physical_parameters/g1"><code class="xref f f-func docutils literal"><span class="pre">g1()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/g0" title="f/physical_parameters/g0"><code class="xref f f-func docutils literal"><span class="pre">g0()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/radratio" title="f/physical_parameters/radratio"><code class="xref f f-func docutils literal"><span class="pre">radratio()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/strat" title="f/physical_parameters/strat"><code class="xref f f-func docutils literal"><span class="pre">strat()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/polind" title="f/physical_parameters/polind"><code class="xref f f-func docutils literal"><span class="pre">polind()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ra" title="f/physical_parameters/ra"><code class="xref f f-func docutils literal"><span class="pre">ra()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/g2" title="f/physical_parameters/g2"><code class="xref f f-func docutils literal"><span class="pre">g2()</span></code></a>): Module containing the physical parameters</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/minc" title="f/truncation/minc"><code class="xref f f-func docutils literal"><span class="pre">minc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nrpgeos" title="f/truncation/nrpgeos"><code class="xref f f-func docutils literal"><span class="pre">nrpgeos()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_maxgeos" title="f/truncation/lm_maxgeos"><code class="xref f f-func docutils literal"><span class="pre">lm_maxgeos()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_m_max" title="f/truncation/n_m_max"><code class="xref f f-func docutils literal"><span class="pre">n_m_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/m_max" title="f/truncation/m_max"><code class="xref f f-func docutils literal"><span class="pre">m_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_maxgeos" title="f/truncation/n_r_maxgeos"><code class="xref f f-func docutils literal"><span class="pre">n_r_maxgeos()</span></code></a>): This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2m" title="f/blocking/lm2m"><code class="xref f f-func docutils literal"><span class="pre">lm2m()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2l" title="f/blocking/lm2l"><code class="xref f f-func docutils literal"><span class="pre">lm2l()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2mc" title="f/blocking/lm2mc"><code class="xref f f-func docutils literal"><span class="pre">lm2mc()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/ci" title="f/constants/ci"><code class="xref f f-func docutils literal"><span class="pre">ci()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal"><span class="pre">half()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal"><span class="pre">pi()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions"><code class="xref f f-mod docutils literal"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/d_costf_init" title="f/radial_functions/d_costf_init"><code class="xref f f-func docutils literal"><span class="pre">d_costf_init()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/cheb_norm" title="f/radial_functions/cheb_norm"><code class="xref f f-func docutils literal"><span class="pre">cheb_norm()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/i_costf_init" title="f/radial_functions/i_costf_init"><code class="xref f f-func docutils literal"><span class="pre">i_costf_init()</span></code></a>)</li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="variable">
<dt id="f/egeos_mod/rhoz">
<code class="descclassname">egeos_mod/</code><code class="descname">rhoz</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/egeos_mod/rhoz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/egeos_mod/nzmaxs">
<code class="descclassname">egeos_mod/</code><code class="descname">nzmaxs</code> (:)<em> [</em><em>integer</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/egeos_mod/nzmaxs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/egeos_mod/osints">
<code class="descclassname">egeos_mod/</code><code class="descname">osints</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/egeos_mod/osints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/egeos_mod/d_costf_initz">
<code class="descclassname">egeos_mod/</code><code class="descname">d_costf_initz</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/egeos_mod/d_costf_initz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/egeos_mod/rz">
<code class="descclassname">egeos_mod/</code><code class="descname">rz</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/egeos_mod/rz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/egeos_mod/orhoz">
<code class="descclassname">egeos_mod/</code><code class="descname">orhoz</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/egeos_mod/orhoz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/egeos_mod/i_costf_initz">
<code class="descclassname">egeos_mod/</code><code class="descname">i_costf_initz</code> (:,:)<em> [</em><em>integer</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/egeos_mod/i_costf_initz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/egeos_mod/zz">
<code class="descclassname">egeos_mod/</code><code class="descname">zz</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/egeos_mod/zz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/egeos_mod/dplms">
<code class="descclassname">egeos_mod/</code><code class="descname">dplms</code> (:,:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/egeos_mod/dplms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/egeos_mod/plms">
<code class="descclassname">egeos_mod/</code><code class="descname">plms</code> (:,:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/egeos_mod/plms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/egeos_mod/initialize_egeos_mod">
<em class="property">subroutine  </em><code class="descclassname">egeos_mod/</code><code class="descname">initialize_egeos_mod</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/egeos_mod/initialize_egeos_mod" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal"><span class="pre">magic</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/egeos_mod/getegeos">
<em class="property">subroutine  </em><code class="descclassname">egeos_mod/</code><code class="descname">getegeos</code><span class="sig-paren">(</span><em>time</em>, <em>ngeossets</em>, <em>w</em>, <em>dw</em>, <em>ddw</em>, <em>z</em>, <em>dz</em>, <em>egeos</em>, <em>ekntc</em>, <em>ekstc</em>, <em>ekin</em>, <em>dpflow</em>, <em>dzflow</em>, <em>cvzotc</em>, <em>cvorotc</em>, <em>chelotc</em><span class="sig-paren">)</span><a class="headerlink" href="#f/egeos_mod/getegeos" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Output of axisymmetric zonal flow, its relative strength,
its time variation, and all forces acting on it.
The slowest part in the TO process is the repitions calculation
of Plms by subroutine plm_theta. They are needed in getDVptr
when I transform on the cylindrical grid.
The necessary plms could simply be calculated one and then
be stored for later use! See s_outTOnew.f.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ngeossets</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>w</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulm" title="f/lmloop_data/ulm">ulm</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llm" title="f/lmloop_data/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dw</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulm" title="f/lmloop_data/ulm">ulm</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llm" title="f/lmloop_data/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ddw</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulm" title="f/lmloop_data/ulm">ulm</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llm" title="f/lmloop_data/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>z</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulm" title="f/lmloop_data/ulm">ulm</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llm" title="f/lmloop_data/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dz</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulm" title="f/lmloop_data/ulm">ulm</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llm" title="f/lmloop_data/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>egeos</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>ekntc</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>ekstc</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>ekin</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dpflow</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: RMS length scales</li>
<li><strong>dzflow</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>cvzotc</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>cvorotc</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>chelotc</strong><em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="IOGeneral.html#f/outmisc_mod/outmisc" title="f/outmisc_mod/outmisc"><code class="xref f f-func docutils literal"><span class="pre">outmisc()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="#f/chebint_mod/chebintinit" title="f/chebint_mod/chebintinit"><code class="xref f f-func docutils literal"><span class="pre">chebintinit()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/plms_theta/plm_theta" title="f/plms_theta/plm_theta"><code class="xref f f-func docutils literal"><span class="pre">plm_theta()</span></code></a>, <a class="reference internal" href="#f/egeos_mod/getdvptr" title="f/egeos_mod/getdvptr"><code class="xref f f-func docutils literal"><span class="pre">getdvptr()</span></code></a>, <a class="reference internal" href="#f/chebint_mod/chebintd" title="f/chebint_mod/chebintd"><code class="xref f f-func docutils literal"><span class="pre">chebintd()</span></code></a>, <a class="reference internal" href="#f/chebint_mod/chebint" title="f/chebint_mod/chebint"><code class="xref f f-func docutils literal"><span class="pre">chebint()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/egeos_mod/getdvptr">
<em class="property">subroutine  </em><code class="descclassname">egeos_mod/</code><code class="descname">getdvptr</code><span class="sig-paren">(</span><em>ws</em>, <em>dws</em>, <em>ddws</em>, <em>zs</em>, <em>dzs</em>, <em>rmin</em>, <em>rmax</em>, <em>rs</em>, <em>nzmax</em>, <em>nzmaxa</em>, <em>plms</em>, <em>dplms</em>, <em>osints</em>, <em>lderiv</em>, <em>vrs</em>, <em>vts</em>, <em>vps</em>, <em>vors</em>, <em>dpek</em><span class="sig-paren">)</span><a class="headerlink" href="#f/egeos_mod/getdvptr" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>This subroutine calculates the three flow components VrS,VtS,VpS at
a (r,theta,all phis) and (t,pi=theta, all phis). Here r=rS, PlmS=Plm(theta),
dPlmS=sin(theta)*dTheta Plm(theta), and OsinTS=1/sin(theta).
The flow is calculated for all n_phi_max azimuthal points used in the code,
and for corresponding latitudes north and south of the equator.
For lDeriv=.true. the subroutine also calculates dpEk and dzEk which
are phi averages of (d Vr/d phi)**2 + (d Vtheta/ d phi)**2 + (d Vphi/ d phi)**2
and (d Vr/d z)**2 + (d Vtheta/ d z)**2 + (d Vphi/ d z)**2, respectively.
These two quantities are used to calculate z and phi scale of the flow in
s_getEgeos.f</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">on input wS=w/r^2, dwS=dw/r, ddwS=ddw/r, zS=z/r</p>
</div>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ws</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dws</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ddws</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxgeos" title="f/truncation/lm_maxgeos">lm_maxgeos</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxgeos" title="f/truncation/n_r_maxgeos">n_r_maxgeos</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>zs</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxgeos" title="f/truncation/lm_maxgeos">lm_maxgeos</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxgeos" title="f/truncation/n_r_maxgeos">n_r_maxgeos</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dzs</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxgeos" title="f/truncation/lm_maxgeos">lm_maxgeos</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_maxgeos" title="f/truncation/n_r_maxgeos">n_r_maxgeos</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>rmin</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: radial bounds</li>
<li><strong>rmax</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>rs</strong> (<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nzmax</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: number of (r,theta) points</li>
<li><strong>nzmaxa</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>plms</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxgeos" title="f/truncation/lm_maxgeos">lm_maxgeos</a>,<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>/2+1)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dplms</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_maxgeos" title="f/truncation/lm_maxgeos">lm_maxgeos</a>,<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>/2+1)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>osints</strong> (<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>/2+1)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lderiv</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vrs</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrpgeos" title="f/truncation/nrpgeos">nrpgeos</a>,<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>vts</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrpgeos" title="f/truncation/nrpgeos">nrpgeos</a>,<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>vps</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrpgeos" title="f/truncation/nrpgeos">nrpgeos</a>,<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>vors</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrpgeos" title="f/truncation/nrpgeos">nrpgeos</a>,<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dpek</strong> (<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/egeos_mod/getegeos" title="f/egeos_mod/getegeos"><code class="xref f f-func docutils literal"><span class="pre">getegeos()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/fft_jw/fft_to_real" title="f/fft_jw/fft_to_real"><code class="xref f f-func docutils literal"><span class="pre">fft_to_real()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/outpv3">
<span id="outpv3-f90"></span><h2><code class="docutils literal"><span class="pre">outPV3.f90</span></code><a class="headerlink" href="#f/outpv3" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#f/outpv3/dplmz" title="f/outpv3/dplmz"><code class="xref f f-var docutils literal"><span class="pre">dplmz</span></code></a>, <a class="reference internal" href="#f/outpv3/plmz" title="f/outpv3/plmz"><code class="xref f f-var docutils literal"><span class="pre">plmz</span></code></a>, <a class="reference internal" href="#f/outpv3/vorold" title="f/outpv3/vorold"><code class="xref f f-var docutils literal"><span class="pre">vorold</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/outpv3/initialize_outpv3" title="f/outpv3/initialize_outpv3"><code class="xref f f-func docutils literal"><span class="pre">initialize_outpv3()</span></code></a>, <a class="reference internal" href="#f/outpv3/outpv" title="f/outpv3/outpv"><code class="xref f f-func docutils literal"><span class="pre">outpv()</span></code></a>, <a class="reference internal" href="#f/outpv3/getpvptr" title="f/outpv3/getpvptr"><code class="xref f f-func docutils literal"><span class="pre">getpvptr()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/dphi" title="f/horizontal_data/dphi"><code class="xref f f-func docutils literal"><span class="pre">dphi()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/dlh" title="f/horizontal_data/dlh"><code class="xref f f-func docutils literal"><span class="pre">dlh()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="parallelModules.html#f/parallel_mod" title="f/parallel_mod: This module contains the blocking information"><code class="xref f f-mod docutils literal"><span class="pre">parallel_mod</span></code></a> (<code class="xref f f-func docutils literal"><span class="pre">rank()</span></code>): This module contains the blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa"><code class="xref f f-func docutils literal"><span class="pre">nzmaxa()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal"><span class="pre">tag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/nsmaxa" title="f/output_data/nsmaxa"><code class="xref f f-func docutils literal"><span class="pre">nsmaxa()</span></code></a>, <a class="reference internal" href="baseModules.html#f/output_data/sdens" title="f/output_data/sdens"><code class="xref f f-func docutils literal"><span class="pre">sdens()</span></code></a>): This module contains the parameters for output control</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/fft_jw" title="f/fft_jw: This file contains the subroutines called by fftJW: fft99a, fft99b, wpass2, wpass3, wpass4 and wpass5"><code class="xref f f-mod docutils literal"><span class="pre">fft_jw</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/fft_jw/fft_to_real" title="f/fft_jw/fft_to_real"><code class="xref f f-func docutils literal"><span class="pre">fft_to_real()</span></code></a>): This file contains the subroutines called by fftJW: fft99a, fft99b, wpass2, wpass3, wpass4 and wpass5</li>
<li><a class="reference internal" href="parallelModules.html#f/lmloop_data" title="f/lmloop_data"><code class="xref f f-mod docutils literal"><span class="pre">lmloop_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/llm" title="f/lmloop_data/llm"><code class="xref f f-func docutils literal"><span class="pre">llm()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/lmloop_data/ulm" title="f/lmloop_data/ulm"><code class="xref f f-func docutils literal"><span class="pre">ulm()</span></code></a>)</li>
<li><a class="reference internal" href="#f/to_helpers" title="f/to_helpers: This module contains several helpful subroutines used in the TO calculations"><code class="xref f f-mod docutils literal"><span class="pre">to_helpers</span></code></a> (<a class="reference internal" href="#f/to_helpers/getpastr" title="f/to_helpers/getpastr"><code class="xref f f-func docutils literal"><span class="pre">getpastr()</span></code></a>): This module contains several helpful subroutines used in the TO calculations</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="parallelModules.html#f/communications" title="f/communications"><code class="xref f f-mod docutils literal"><span class="pre">communications</span></code></a> (<a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/communications/gt_oc" title="f/communications/gt_oc"><code class="xref f f-func docutils literal"><span class="pre">gt_oc()</span></code></a>)</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/plms_theta" title="f/plms_theta"><code class="xref f f-mod docutils literal"><span class="pre">plms_theta</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/plms_theta/plm_theta" title="f/plms_theta/plm_theta"><code class="xref f f-func docutils literal"><span class="pre">plm_theta()</span></code></a>)</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/cosine_transform" title="f/cosine_transform"><code class="xref f f-mod docutils literal"><span class="pre">cosine_transform</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/cosine_transform/costf1" title="f/cosine_transform/costf1"><code class="xref f f-func docutils literal"><span class="pre">costf1()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_sric" title="f/logic/l_sric"><code class="xref f f-func docutils literal"><span class="pre">l_sric()</span></code></a>, <a class="reference internal" href="baseModules.html#f/logic/lverbose" title="f/logic/lverbose"><code class="xref f f-func docutils literal"><span class="pre">lverbose()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/radratio" title="f/physical_parameters/radratio"><code class="xref f f-func docutils literal"><span class="pre">radratio()</span></code></a>): Module containing the physical parameters</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/minc" title="f/truncation/minc"><code class="xref f f-func docutils literal"><span class="pre">minc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal"><span class="pre">n_phi_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal"><span class="pre">n_r_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_m_max" title="f/truncation/n_m_max"><code class="xref f f-func docutils literal"><span class="pre">n_m_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/m_max" title="f/truncation/m_max"><code class="xref f f-func docutils literal"><span class="pre">m_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp"><code class="xref f f-func docutils literal"><span class="pre">nrp()</span></code></a>): This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal"><span class="pre">lm2()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2l" title="f/blocking/lm2l"><code class="xref f f-func docutils literal"><span class="pre">lm2l()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2mc" title="f/blocking/lm2mc"><code class="xref f f-func docutils literal"><span class="pre">lm2mc()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/lm2m" title="f/blocking/lm2m"><code class="xref f f-func docutils literal"><span class="pre">lm2m()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/ci" title="f/constants/ci"><code class="xref f f-func docutils literal"><span class="pre">ci()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal"><span class="pre">one()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/zero" title="f/constants/zero"><code class="xref f f-func docutils literal"><span class="pre">zero()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal"><span class="pre">half()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal"><span class="pre">pi()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions"><code class="xref f f-mod docutils literal"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/i_costf_init" title="f/radial_functions/i_costf_init"><code class="xref f f-func docutils literal"><span class="pre">i_costf_init()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/d_costf_init" title="f/radial_functions/d_costf_init"><code class="xref f f-func docutils literal"><span class="pre">d_costf_init()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/cheb_norm" title="f/radial_functions/cheb_norm"><code class="xref f f-func docutils literal"><span class="pre">cheb_norm()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal"><span class="pre">r_cmb()</span></code></a>)</li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="variable">
<dt id="f/outpv3/osints">
<code class="descclassname">outpv3/</code><code class="descname">osints</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outpv3/osints" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outpv3/rz">
<code class="descclassname">outpv3/</code><code class="descname">rz</code> (:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outpv3/rz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outpv3/dplmz">
<code class="descclassname">outpv3/</code><code class="descname">dplmz</code> (:,:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outpv3/dplmz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outpv3/plmz">
<code class="descclassname">outpv3/</code><code class="descname">plmz</code> (:,:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outpv3/plmz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outpv3/vorold">
<code class="descclassname">outpv3/</code><code class="descname">vorold</code> (:,:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outpv3/vorold" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outpv3/dplms">
<code class="descclassname">outpv3/</code><code class="descname">dplms</code> (:,:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outpv3/dplms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
<li><dl class="variable">
<dt id="f/outpv3/plms">
<code class="descclassname">outpv3/</code><code class="descname">plms</code> (:,:,:)<em> [</em><em>real</em><em>,</em><em>private/allocatable</em><em>]</em><a class="headerlink" href="#f/outpv3/plms" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/outpv3/initialize_outpv3">
<em class="property">subroutine  </em><code class="descclassname">outpv3/</code><code class="descname">initialize_outpv3</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f/outpv3/initialize_outpv3" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><a class="reference internal" href="magic.html#f/magic" title="f/magic"><code class="xref f f-prog docutils literal"><span class="pre">magic</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/outpv3/outpv">
<em class="property">subroutine  </em><code class="descclassname">outpv3/</code><code class="descname">outpv</code><span class="sig-paren">(</span><em>time</em>, <em>l_stop_time</em>, <em>npvsets</em>, <em>w</em>, <em>dw</em>, <em>ddw</em>, <em>z</em>, <em>dz</em>, <em>omega_ic</em>, <em>omega_ma</em><span class="sig-paren">)</span><a class="headerlink" href="#f/outpv3/outpv" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Output of z-integrated axisymmetric rotation rate Vp/s
and s derivatives</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>time</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>l_stop_time</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>npvsets</strong><em> [</em><em>integer</em><em>,</em><em>inout</em><em>]</em></li>
<li><strong>w</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulm" title="f/lmloop_data/ulm">ulm</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llm" title="f/lmloop_data/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dw</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulm" title="f/lmloop_data/ulm">ulm</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llm" title="f/lmloop_data/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ddw</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulm" title="f/lmloop_data/ulm">ulm</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llm" title="f/lmloop_data/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>z</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulm" title="f/lmloop_data/ulm">ulm</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llm" title="f/lmloop_data/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dz</strong> (<a class="reference internal" href="parallelModules.html#f/lmloop_data/ulm" title="f/lmloop_data/ulm">ulm</a>-(<a class="reference internal" href="parallelModules.html#f/lmloop_data/llm" title="f/lmloop_data/llm">llm</a>)+1,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>omega_ma</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal"><span class="pre">output()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="parallelModules.html#f/communications/gather_all_from_lo_to_rank0" title="f/communications/gather_all_from_lo_to_rank0"><code class="xref f f-func docutils literal"><span class="pre">gather_all_from_lo_to_rank0()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/plms_theta/plm_theta" title="f/plms_theta/plm_theta"><code class="xref f f-func docutils literal"><span class="pre">plm_theta()</span></code></a>, <a class="reference internal" href="#f/to_helpers/getpastr" title="f/to_helpers/getpastr"><code class="xref f f-func docutils literal"><span class="pre">getpastr()</span></code></a>, <a class="reference internal" href="#f/outpv3/getpvptr" title="f/outpv3/getpvptr"><code class="xref f f-func docutils literal"><span class="pre">getpvptr()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/outpv3/getpvptr">
<em class="property">subroutine  </em><code class="descclassname">outpv3/</code><code class="descname">getpvptr</code><span class="sig-paren">(</span><em>w</em>, <em>dw</em>, <em>ddw</em>, <em>z</em>, <em>dz</em>, <em>rmin</em>, <em>rmax</em>, <em>rs</em>, <em>nzmax</em>, <em>nzmaxa</em>, <em>plms</em>, <em>dplms</em>, <em>osints</em>, <em>vrs</em>, <em>vps</em>, <em>vts</em>, <em>vors</em>, <em>dpvors</em><span class="sig-paren">)</span><a class="headerlink" href="#f/outpv3/getpvptr" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>This subroutine calculates the three flow conponents VrS,VtS,VpS at
(r,theta,all phis) and (r,pi-theta, all phis). Here r=rS, PlmS=Plm(theta),
dPlmS=sin(theta)*dTheta Plm(theta), and OsinTS=1/sin(theta).
The flow is calculated for all n_phi_max azimuthal points used in the code,
and for corresponding latitudes north and south of the equator.
For lDeriv=.true. the subroutine also calculates dpEk and dzEk which
are phi averages of (d Vr/d phi)**2 + (d Vtheta/ d phi)**2 + (d Vphi/ d phi)**2
and (d Vr/d z)**2 + (d Vtheta/ d z)**2 + (d Vphi/ d z)**2, respectively.
These two quantities are used ot calculate z and phi scale of the flow in
s_getEgeos.f
NOTE: on input w=l*(l+1)*w</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>w</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ddw</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>z</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dz</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>rmin</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: radial bounds</li>
<li><strong>rmax</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>rs</strong> (<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nzmax</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: number of (r,theta) points</li>
<li><strong>nzmaxa</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>plms</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>/2+1)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dplms</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>/2+1)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>osints</strong> (<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>/2+1)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vrs</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>vps</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>vts</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>vors</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>dpvors</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="baseModules.html#f/output_data/nzmaxa" title="f/output_data/nzmaxa">nzmaxa</a>)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/outpv3/outpv" title="f/outpv3/outpv"><code class="xref f f-func docutils literal"><span class="pre">outpv()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/fft_jw/fft_to_real" title="f/fft_jw/fft_to_real"><code class="xref f f-func docutils literal"><span class="pre">fft_to_real()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/chebint_mod">
<span id="chebint-f90"></span><h2><code class="docutils literal"><span class="pre">chebInt.f90</span></code><a class="headerlink" href="#f/chebint_mod" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/chebint_mod/chebintinit" title="f/chebint_mod/chebintinit"><code class="xref f f-func docutils literal"><span class="pre">chebintinit()</span></code></a>, <a class="reference internal" href="#f/chebint_mod/chebintd" title="f/chebint_mod/chebintd"><code class="xref f f-func docutils literal"><span class="pre">chebintd()</span></code></a>, <a class="reference internal" href="#f/chebint_mod/chebint" title="f/chebint_mod/chebint"><code class="xref f f-func docutils literal"><span class="pre">chebint()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/init_costf" title="f/init_costf"><code class="xref f f-mod docutils literal"><span class="pre">init_costf</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/init_costf/init_costf1" title="f/init_costf/init_costf1"><code class="xref f f-func docutils literal"><span class="pre">init_costf1()</span></code></a>)</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/cosine_transform" title="f/cosine_transform"><code class="xref f f-mod docutils literal"><span class="pre">cosine_transform</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/cosine_transform/costf1" title="f/cosine_transform/costf1"><code class="xref f f-func docutils literal"><span class="pre">costf1()</span></code></a>)</li>
<li><a class="reference internal" href="derInt.html#f/radial_der" title="f/radial_der: Radial derivatives functions"><code class="xref f f-mod docutils literal"><span class="pre">radial_der</span></code></a> (<a class="reference internal" href="derInt.html#f/radial_der/get_dcheb" title="f/radial_der/get_dcheb"><code class="xref f f-func docutils literal"><span class="pre">get_dcheb()</span></code></a>): Radial derivatives functions</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/chebyshev_polynoms_mod" title="f/chebyshev_polynoms_mod"><code class="xref f f-mod docutils literal"><span class="pre">chebyshev_polynoms_mod</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/chebyshev_polynoms_mod/cheb_grid" title="f/chebyshev_polynoms_mod/cheb_grid"><code class="xref f f-func docutils literal"><span class="pre">cheb_grid()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/four" title="f/constants/four"><code class="xref f f-func docutils literal"><span class="pre">four()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal"><span class="pre">half()</span></code></a>): module containing constants and parameters used in the code.</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/chebint_mod/chebintinit">
<em class="property">subroutine  </em><code class="descclassname">chebint_mod/</code><code class="descname">chebintinit</code><span class="sig-paren">(</span><em>zmin</em>, <em>zmax</em>, <em>znorm</em>, <em>nnorm</em>, <em>ngridpointsmax</em>, <em>z</em>, <em>ngridpoints</em>, <em>i_costf_init</em>, <em>d_costf_init</em><span class="sig-paren">)</span><a class="headerlink" href="#f/chebint_mod/chebintinit" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>zmin</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: integration interval !</li>
<li><strong>zmax</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>znorm</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: norm interval length</li>
<li><strong>nnorm</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: suggested number of grid points for norm length</li>
<li><strong>ngridpointsmax</strong><em> [</em><em>integer</em><em>]</em> :: dimension of z on input</li>
<li><strong>z</strong> (ngridpointsmax)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em> :: grid points, dimension at &gt;= nGridPointsMax</li>
<li><strong>ngridpoints</strong><em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em> :: number of used grid points</li>
<li><strong>i_costf_init</strong> (2 * ngridpointsmax + 2)<em> [</em><em>integer</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>d_costf_init</strong> (2 * ngridpointsmax + 5)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/egeos_mod/getegeos" title="f/egeos_mod/getegeos"><code class="xref f f-func docutils literal"><span class="pre">getegeos()</span></code></a>, <a class="reference internal" href="#f/outto_mod/outto" title="f/outto_mod/outto"><code class="xref f f-func docutils literal"><span class="pre">outto()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/chebyshev_polynoms_mod/cheb_grid" title="f/chebyshev_polynoms_mod/cheb_grid"><code class="xref f f-func docutils literal"><span class="pre">cheb_grid()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/init_costf/init_costf1" title="f/init_costf/init_costf1"><code class="xref f f-func docutils literal"><span class="pre">init_costf1()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="f/chebint_mod/chebint">
<em class="property">function  </em><code class="descclassname">chebint_mod/</code><code class="descname">chebint</code><span class="sig-paren">(</span><em>f</em>, <em>zmin</em>, <em>zmax</em>, <em>ngridpoints</em>, <em>ngridpointsmax</em>, <em>i_costf_init</em>, <em>d_costf_init</em><span class="sig-paren">)</span><a class="headerlink" href="#f/chebint_mod/chebint" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>f</strong> (*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: function on grid points</li>
<li><strong>zmin</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: integration boundaries</li>
<li><strong>zmax</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ngridpoints</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: No of grid points</li>
<li><strong>ngridpointsmax</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: No of max grid points</li>
<li><strong>i_costf_init</strong> (2 * ngridpointsmax + 2)<em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>d_costf_init</strong> (2 * ngridpointsmax + 5)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><p class="first"><strong>chebint</strong><em> [</em><em>real</em><em>]</em></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/egeos_mod/getegeos" title="f/egeos_mod/getegeos"><code class="xref f f-func docutils literal"><span class="pre">getegeos()</span></code></a>, <a class="reference internal" href="#f/outto_mod/outto" title="f/outto_mod/outto"><code class="xref f f-func docutils literal"><span class="pre">outto()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="f/chebint_mod/chebintd">
<em class="property">function  </em><code class="descclassname">chebint_mod/</code><code class="descname">chebintd</code><span class="sig-paren">(</span><em>f</em>, <em>lderiv</em>, <em>zmin</em>, <em>zmax</em>, <em>ngridpoints</em>, <em>ngridpointsmax</em>, <em>i_costf_init</em>, <em>d_costf_init</em><span class="sig-paren">)</span><a class="headerlink" href="#f/chebint_mod/chebintd" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>f</strong> (*)<em> [</em><em>real</em><em>,</em><em>inout</em><em>]</em> :: function on grid points</li>
<li><strong>lderiv</strong><em> [</em><em>logical</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>zmin</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em> :: integration boundaries</li>
<li><strong>zmax</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>ngridpoints</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em> :: No of grid points</li>
<li><strong>ngridpointsmax</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em> :: No of max grid points</li>
<li><strong>i_costf_init</strong> (2 * ngridpointsmax + 2)<em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>d_costf_init</strong> (2 * ngridpointsmax + 5)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><p class="first"><strong>chebintd</strong><em> [</em><em>real</em><em>]</em></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/egeos_mod/getegeos" title="f/egeos_mod/getegeos"><code class="xref f f-func docutils literal"><span class="pre">getegeos()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/omega">
<span id="outomega-f90"></span><h2><code class="docutils literal"><span class="pre">outOmega.f90</span></code><a class="headerlink" href="#f/omega" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module allows to compute the axisymmetric zonal flow versus the cylindrical
radius s. By</p>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Variables:</th><td class="field-body"><a class="reference internal" href="#f/omega/nsmax" title="f/omega/nsmax"><code class="xref f f-var docutils literal"><span class="pre">nsmax</span></code></a></td>
</tr>
<tr class="field-even field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/omega/outomega" title="f/omega/outomega"><code class="xref f f-func docutils literal"><span class="pre">outomega()</span></code></a>, <a class="reference internal" href="#f/omega/lnpas2tr" title="f/omega/lnpas2tr"><code class="xref f f-func docutils literal"><span class="pre">lnpas2tr()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="baseModules.html#f/output_data" title="f/output_data: This module contains the parameters for output control"><code class="xref f f-mod docutils literal"><span class="pre">output_data</span></code></a> (<a class="reference internal" href="baseModules.html#f/output_data/tag" title="f/output_data/tag"><code class="xref f f-func docutils literal"><span class="pre">tag()</span></code></a>): This module contains the parameters for output control</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/plms_theta" title="f/plms_theta"><code class="xref f f-mod docutils literal"><span class="pre">plms_theta</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/plms_theta/plm_theta" title="f/plms_theta/plm_theta"><code class="xref f f-func docutils literal"><span class="pre">plm_theta()</span></code></a>)</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/cosine_transform" title="f/cosine_transform"><code class="xref f f-mod docutils literal"><span class="pre">cosine_transform</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/cosine_transform/costf1" title="f/cosine_transform/costf1"><code class="xref f f-func docutils literal"><span class="pre">costf1()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/lverbose" title="f/logic/lverbose"><code class="xref f f-func docutils literal"><span class="pre">lverbose()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max"><code class="xref f f-func docutils literal"><span class="pre">lm_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/minc" title="f/truncation/minc"><code class="xref f f-func docutils literal"><span class="pre">minc()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max"><code class="xref f f-func docutils literal"><span class="pre">n_r_max()</span></code></a>): This module defines the grid points and the truncation</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/lm2" title="f/blocking/lm2"><code class="xref f f-func docutils literal"><span class="pre">lm2()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal"><span class="pre">half()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions"><code class="xref f f-mod docutils literal"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/r_cmb" title="f/radial_functions/r_cmb"><code class="xref f f-func docutils literal"><span class="pre">r_cmb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/r_icb" title="f/radial_functions/r_icb"><code class="xref f f-func docutils literal"><span class="pre">r_icb()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/d_costf_init" title="f/radial_functions/d_costf_init"><code class="xref f f-func docutils literal"><span class="pre">d_costf_init()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/i_costf_init" title="f/radial_functions/i_costf_init"><code class="xref f f-func docutils literal"><span class="pre">i_costf_init()</span></code></a>)</li>
</ul>
<p class="rubric">Variables</p>
<ul>
<li><dl class="variable">
<dt id="f/omega/nsmax">
<code class="descclassname">omega/</code><code class="descname">nsmax</code><em> [</em><em>integer</em><em>,</em><em>private/parameter=300</em><em>]</em><a class="headerlink" href="#f/omega/nsmax" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of cylindrical radial grid points</p>
</dd></dl>

</li>
</ul>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/omega/outomega">
<em class="property">subroutine  </em><code class="descclassname">omega/</code><code class="descname">outomega</code><span class="sig-paren">(</span><em>z</em>, <em>omega_ic</em><span class="sig-paren">)</span><a class="headerlink" href="#f/omega/outomega" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Output of axisymmetric zonal flow omega(s) into field omega.TAG,
where s is the cylindrical radius. This is done for the southern
and norther hemispheres at z=+-(r_icb+0.5)</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>z</strong> (<a class="reference internal" href="baseModules.html#f/truncation/lm_max" title="f/truncation/lm_max">lm_max</a>,<a class="reference internal" href="baseModules.html#f/truncation/n_r_max" title="f/truncation/n_r_max">n_r_max</a>)<em> [</em><em>complex</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>omega_ic</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="IOGeneral.html#f/output_mod/output" title="f/output_mod/output"><code class="xref f f-func docutils literal"><span class="pre">output()</span></code></a></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#f/omega/lnpas2tr" title="f/omega/lnpas2tr"><code class="xref f f-func docutils literal"><span class="pre">lnpas2tr()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="f/omega/lnpas2tr">
<em class="property">function  </em><code class="descclassname">omega/</code><code class="descname">lnpas2tr</code><span class="sig-paren">(</span><em>f</em>, <em>lmmax</em>, <em>a</em>, <em>b</em>, <em>lmax</em>, <em>minc</em>, <em>nchebmax</em>, <em>theta</em>, <em>r</em><span class="sig-paren">)</span><a class="headerlink" href="#f/omega/lnpas2tr" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>f</strong> (lmmax,*)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lmmax</strong><em> [</em><em>integer</em><em>,</em><em>in,</em><em>]</em></li>
<li><strong>a</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>b</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>lmax</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>minc</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nchebmax</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>theta</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>r</strong><em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Return:</th><td class="field-body"><p class="first"><strong>lnpas2tr</strong><em> [</em><em>real</em><em>]</em></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="#f/omega/outomega" title="f/omega/outomega"><code class="xref f f-func docutils literal"><span class="pre">outomega()</span></code></a></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/plms_theta/plm_theta" title="f/plms_theta/plm_theta"><code class="xref f f-func docutils literal"><span class="pre">plm_theta()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="f/nl_special_calc">
<span id="nl-special-calc-f90"></span><h2><code class="docutils literal"><span class="pre">nl_special_calc.f90</span></code><a class="headerlink" href="#f/nl_special_calc" title="Permalink to this headline">¶</a></h2>
<p class="rubric">Description</p>
<p>This module allows to calculcate several diagnostics that need to be
computed in the physical space (non-linear quantities)</p>
<p class="rubric">Quick access</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Routines:</th><td class="field-body"><a class="reference internal" href="#f/nl_special_calc/get_helicity" title="f/nl_special_calc/get_helicity"><code class="xref f f-func docutils literal"><span class="pre">get_helicity()</span></code></a>, <a class="reference internal" href="#f/nl_special_calc/get_fluxes" title="f/nl_special_calc/get_fluxes"><code class="xref f f-func docutils literal"><span class="pre">get_fluxes()</span></code></a>, <a class="reference internal" href="#f/nl_special_calc/get_perppar" title="f/nl_special_calc/get_perppar"><code class="xref f f-func docutils literal"><span class="pre">get_perppar()</span></code></a>, <a class="reference internal" href="#f/nl_special_calc/get_nlblayers" title="f/nl_special_calc/get_nlblayers"><code class="xref f f-func docutils literal"><span class="pre">get_nlblayers()</span></code></a></td>
</tr>
</tbody>
</table>
<p class="rubric">Needed modules</p>
<ul class="simple">
<li><a class="reference internal" href="precalcModules.html#f/horizontal_data" title="f/horizontal_data: Module containing functions depending on longitude and latitude plus help arrays depending on degree and order"><code class="xref f f-mod docutils literal"><span class="pre">horizontal_data</span></code></a> (<a class="reference internal" href="precalcModules.html#f/horizontal_data/osn2" title="f/horizontal_data/osn2"><code class="xref f f-func docutils literal"><span class="pre">osn2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/o_sin_theta_e2" title="f/horizontal_data/o_sin_theta_e2"><code class="xref f f-func docutils literal"><span class="pre">o_sin_theta_e2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/sn2" title="f/horizontal_data/sn2"><code class="xref f f-func docutils literal"><span class="pre">sn2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/horizontal_data/costheta" title="f/horizontal_data/costheta"><code class="xref f f-func docutils literal"><span class="pre">costheta()</span></code></a>): Module containing functions depending on longitude and latitude plus help arrays depending on degree and order</li>
<li><a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec" title="f/legendre_grid_to_spec"><code class="xref f f-mod docutils literal"><span class="pre">legendre_grid_to_spec</span></code></a> (<a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtfas2" title="f/legendre_grid_to_spec/legtfas2"><code class="xref f f-func docutils literal"><span class="pre">legtfas2()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtfas" title="f/legendre_grid_to_spec/legtfas"><code class="xref f f-func docutils literal"><span class="pre">legtfas()</span></code></a>)</li>
<li><a class="reference internal" href="parallelModules.html#f/radial_data" title="f/radial_data"><code class="xref f f-mod docutils literal"><span class="pre">radial_data</span></code></a> (<a class="reference internal" href="parallelModules.html#f/radial_data/n_r_cmb" title="f/radial_data/n_r_cmb"><code class="xref f f-func docutils literal"><span class="pre">n_r_cmb()</span></code></a>, <a class="reference internal" href="parallelModules.html#f/radial_data/n_r_icb" title="f/radial_data/n_r_icb"><code class="xref f f-func docutils literal"><span class="pre">n_r_icb()</span></code></a>)</li>
<li><a class="reference internal" href="baseModules.html#f/precision_mod" title="f/precision_mod: This module controls the precision used in MagIC"><code class="xref f f-mod docutils literal"><span class="pre">precision_mod</span></code></a>: This module controls the precision used in MagIC</li>
<li><a class="reference internal" href="baseModules.html#f/logic" title="f/logic: Module containing the logicals that control the run"><code class="xref f f-mod docutils literal"><span class="pre">logic</span></code></a> (<a class="reference internal" href="baseModules.html#f/logic/l_mag_nl" title="f/logic/l_mag_nl"><code class="xref f f-func docutils literal"><span class="pre">l_mag_nl()</span></code></a>): Module containing the logicals that control the run</li>
<li><a class="reference internal" href="baseModules.html#f/physical_parameters" title="f/physical_parameters: Module containing the physical parameters"><code class="xref f f-mod docutils literal"><span class="pre">physical_parameters</span></code></a> (<a class="reference internal" href="baseModules.html#f/physical_parameters/vischeatfac" title="f/physical_parameters/vischeatfac"><code class="xref f f-func docutils literal"><span class="pre">vischeatfac()</span></code></a>, <a class="reference internal" href="baseModules.html#f/physical_parameters/ek" title="f/physical_parameters/ek"><code class="xref f f-func docutils literal"><span class="pre">ek()</span></code></a>): Module containing the physical parameters</li>
<li><a class="reference internal" href="precalcModules.html#f/radial_functions" title="f/radial_functions"><code class="xref f f-mod docutils literal"><span class="pre">radial_functions</span></code></a> (<a class="reference internal" href="precalcModules.html#f/radial_functions/orho1" title="f/radial_functions/orho1"><code class="xref f f-func docutils literal"><span class="pre">orho1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/orho2" title="f/radial_functions/orho2"><code class="xref f f-func docutils literal"><span class="pre">orho2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or4" title="f/radial_functions/or4"><code class="xref f f-func docutils literal"><span class="pre">or4()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or2" title="f/radial_functions/or2"><code class="xref f f-func docutils literal"><span class="pre">or2()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/or1" title="f/radial_functions/or1"><code class="xref f f-func docutils literal"><span class="pre">or1()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/visc" title="f/radial_functions/visc"><code class="xref f f-func docutils literal"><span class="pre">visc()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/beta" title="f/radial_functions/beta"><code class="xref f f-func docutils literal"><span class="pre">beta()</span></code></a>, <a class="reference internal" href="precalcModules.html#f/radial_functions/temp0" title="f/radial_functions/temp0"><code class="xref f f-func docutils literal"><span class="pre">temp0()</span></code></a>)</li>
<li><a class="reference internal" href="blocking.html#f/blocking" title="f/blocking: Module containing blocking information"><code class="xref f f-mod docutils literal"><span class="pre">blocking</span></code></a> (<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs"><code class="xref f f-func docutils literal"><span class="pre">nfs()</span></code></a>, <a class="reference internal" href="blocking.html#f/blocking/sizethetab" title="f/blocking/sizethetab"><code class="xref f f-func docutils literal"><span class="pre">sizethetab()</span></code></a>): Module containing blocking information</li>
<li><a class="reference internal" href="baseModules.html#f/constants" title="f/constants: module containing constants and parameters used in the code."><code class="xref f f-mod docutils literal"><span class="pre">constants</span></code></a> (<a class="reference internal" href="baseModules.html#f/constants/half" title="f/constants/half"><code class="xref f f-func docutils literal"><span class="pre">half()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/pi" title="f/constants/pi"><code class="xref f f-func docutils literal"><span class="pre">pi()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/two" title="f/constants/two"><code class="xref f f-func docutils literal"><span class="pre">two()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/third" title="f/constants/third"><code class="xref f f-func docutils literal"><span class="pre">third()</span></code></a>, <a class="reference internal" href="baseModules.html#f/constants/one" title="f/constants/one"><code class="xref f f-func docutils literal"><span class="pre">one()</span></code></a>): module containing constants and parameters used in the code.</li>
<li><a class="reference internal" href="baseModules.html#f/truncation" title="f/truncation: This module defines the grid points and the truncation"><code class="xref f f-mod docutils literal"><span class="pre">truncation</span></code></a> (<a class="reference internal" href="baseModules.html#f/truncation/l_maxmag" title="f/truncation/l_maxmag"><code class="xref f f-func docutils literal"><span class="pre">l_maxmag()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max"><code class="xref f f-func docutils literal"><span class="pre">l_max()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp"><code class="xref f f-func docutils literal"><span class="pre">nrp()</span></code></a>, <a class="reference internal" href="baseModules.html#f/truncation/n_phi_max" title="f/truncation/n_phi_max"><code class="xref f f-func docutils literal"><span class="pre">n_phi_max()</span></code></a>): This module defines the grid points and the truncation</li>
</ul>
<p class="rubric">Variables</p>
<p class="rubric">Subroutines and functions</p>
<dl class="subroutine">
<dt id="f/nl_special_calc/get_nlblayers">
<em class="property">subroutine  </em><code class="descclassname">nl_special_calc/</code><code class="descname">get_nlblayers</code><span class="sig-paren">(</span><em>vt</em>, <em>vp</em>, <em>dvtdr</em>, <em>dvpdr</em>, <em>dsdr</em>, <em>dsdt</em>, <em>dsdp</em>, <em>uhlmr</em>, <em>duhlmr</em>, <em>gradslmr</em>, <em>nr</em>, <em>nthetastart</em><span class="sig-paren">)</span><a class="headerlink" href="#f/nl_special_calc/get_nlblayers" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Calculates axisymmetric contributions of:</p>
<blockquote>
<div><ul class="simple">
<li>the horizontal velocity <span class="math">\(u_h = \sqrt{u_\theta^2+u_\phi^2}\)</span></li>
<li>its radial derivative <span class="math">\(|\partial u_h/\partial r|\)</span></li>
<li>The thermal dissipation rate <span class="math">\((\nabla T)^2\)</span></li>
</ul>
</div></blockquote>
<p>This subroutine is used when one wants to evaluate viscous and thermal
dissipation layers</p>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvtdr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvpdr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dsdr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dsdt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dsdp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>uhlmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>duhlmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>gradslmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>nr</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp" title="f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp"><code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_openmp()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_seq()</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtfas2" title="f/legendre_grid_to_spec/legtfas2"><code class="xref f f-func docutils literal"><span class="pre">legtfas2()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtfas" title="f/legendre_grid_to_spec/legtfas"><code class="xref f f-func docutils literal"><span class="pre">legtfas()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/nl_special_calc/get_perppar">
<em class="property">subroutine  </em><code class="descclassname">nl_special_calc/</code><code class="descname">get_perppar</code><span class="sig-paren">(</span><em>vr</em>, <em>vt</em>, <em>vp</em>, <em>eperplmr</em>, <em>eparlmr</em>, <em>eperpaxilmr</em>, <em>eparaxilmr</em>, <em>nr</em>, <em>nthetastart</em><span class="sig-paren">)</span><a class="headerlink" href="#f/nl_special_calc/get_perppar" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Calculates the energies parallel and perpendicular to the rotation axis</p>
<blockquote>
<div><ul class="simple">
<li><span class="math">\(E_\perp = 0.5 (v_s^2+v_\phi^2)\)</span> with
<span class="math">\(v_s= v_r\sin\theta+v_\theta\cos\theta\)</span></li>
<li><span class="math">\(E_\parallel  = 0.5v_z^2\)</span> with
<span class="math">\(v_z= v_r\cos\theta-v_\theta*\sin\theta\)</span></li>
</ul>
</div></blockquote>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>eperplmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>eparlmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>eperpaxilmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>eparaxilmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>nr</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp" title="f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp"><code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_openmp()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_seq()</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtfas2" title="f/legendre_grid_to_spec/legtfas2"><code class="xref f f-func docutils literal"><span class="pre">legtfas2()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/nl_special_calc/get_fluxes">
<em class="property">subroutine  </em><code class="descclassname">nl_special_calc/</code><code class="descname">get_fluxes</code><span class="sig-paren">(</span><em>vr</em>, <em>vt</em>, <em>vp</em>, <em>dvrdr</em>, <em>dvtdr</em>, <em>dvpdr</em>, <em>dvrdt</em>, <em>dvrdp</em>, <em>sr</em>, <em>pr</em>, <em>br</em>, <em>bt</em>, <em>bp</em>, <em>cbt</em>, <em>cbp</em>, <em>fconvlmr</em>, <em>fkinlmr</em>, <em>fvisclmr</em>, <em>fpoynlmr</em>, <em>freslmr</em>, <em>nr</em>, <em>nthetastart</em><span class="sig-paren">)</span><a class="headerlink" href="#f/nl_special_calc/get_fluxes" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Calculates the fluxes:</p>
<blockquote>
<div><ul class="simple">
<li>Convective flux: <span class="math">\(F_c= \rho T (u_r s)\)</span></li>
<li>Kinetic flux: <span class="math">\(F_k = 1/2\,\rho u_r (u_r^2+u_\theta^2+u_\phi^2)\)</span></li>
<li>Viscous flux: <span class="math">\(F_= -(u \cdot S )_r\)</span>)</li>
</ul>
</div></blockquote>
<p>If the run is magnetic, then this routine also computes:</p>
<blockquote>
<div><ul class="simple">
<li>Poynting flux</li>
<li>resistive flux</li>
</ul>
</div></blockquote>
</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvrdr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvtdr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvpdr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvrdt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvrdp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>sr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>pr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>br</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>bp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cbt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cbp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>fconvlmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>fkinlmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>fvisclmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>fpoynlmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_maxmag" title="f/truncation/l_maxmag">l_maxmag</a>+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>freslmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_maxmag" title="f/truncation/l_maxmag">l_maxmag</a>+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>nr</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp" title="f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp"><code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_openmp()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_seq()</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtfas2" title="f/legendre_grid_to_spec/legtfas2"><code class="xref f f-func docutils literal"><span class="pre">legtfas2()</span></code></a>, <a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtfas" title="f/legendre_grid_to_spec/legtfas"><code class="xref f f-func docutils literal"><span class="pre">legtfas()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f/nl_special_calc/get_helicity">
<em class="property">subroutine  </em><code class="descclassname">nl_special_calc/</code><code class="descname">get_helicity</code><span class="sig-paren">(</span><em>vr</em>, <em>vt</em>, <em>vp</em>, <em>cvr</em>, <em>dvrdt</em>, <em>dvrdp</em>, <em>dvtdr</em>, <em>dvpdr</em>, <em>hellmr</em>, <em>hel2lmr</em>, <em>helnalmr</em>, <em>helna2lmr</em>, <em>nr</em>, <em>nthetastart</em><span class="sig-paren">)</span><a class="headerlink" href="#f/nl_special_calc/get_helicity" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div>Calculates axisymmetric contributions of helicity HelLMr and
helicity**2  Hel2LMr in (l,m=0,r) space.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>vr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>vp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>cvr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvrdt</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvrdp</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvtdr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>dvpdr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/nrp" title="f/truncation/nrp">nrp</a>,<a class="reference internal" href="blocking.html#f/blocking/nfs" title="f/blocking/nfs">nfs</a>)<em> [</em><em>real</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>hellmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>hel2lmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>helnalmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>helna2lmr</strong> (<a class="reference internal" href="baseModules.html#f/truncation/l_max" title="f/truncation/l_max">l_max</a>+1)<em> [</em><em>real</em><em>,</em><em>out</em><em>]</em></li>
<li><strong>nr</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
<li><strong>nthetastart</strong><em> [</em><em>integer</em><em>,</em><em>in</em><em>]</em></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Called from:</th><td class="field-body"><p class="first"><a class="reference internal" href="timeAdvNonLinear.html#f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp" title="f/riterthetablocking_openmp_mod/do_iteration_thetablocking_openmp"><code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_openmp()</span></code></a>, <code class="xref f f-func docutils literal"><span class="pre">do_iteration_thetablocking_seq()</span></code></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Call to:</th><td class="field-body"><p class="first last"><a class="reference internal" href="legFourierChebAlgebra.html#f/legendre_grid_to_spec/legtfas2" title="f/legendre_grid_to_spec/legtfas2"><code class="xref f f-func docutils literal"><span class="pre">legtfas2()</span></code></a></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">IO: RMS force balance, torsional oscillations, misc</a><ul>
<li><a class="reference internal" href="#f/rms"><code class="docutils literal"><span class="pre">RMS.f90</span></code></a></li>
<li><a class="reference internal" href="#f/rms_helpers"><code class="docutils literal"><span class="pre">RMS_helpers.f90</span></code></a></li>
<li><a class="reference internal" href="#f/out_rms"><code class="docutils literal"><span class="pre">out_RMS.f90</span></code></a></li>
<li><a class="reference internal" href="#f/dtb_mod"><code class="docutils literal"><span class="pre">dtB.f90</span></code></a></li>
<li><a class="reference internal" href="#f/out_dtb_frame"><code class="docutils literal"><span class="pre">out_dtB_frame.f90</span></code></a></li>
<li><a class="reference internal" href="#f/torsional_oscillations"><code class="docutils literal"><span class="pre">TO.f90</span></code></a></li>
<li><a class="reference internal" href="#f/to_helpers"><code class="docutils literal"><span class="pre">TO_helpers.f90</span></code></a></li>
<li><a class="reference internal" href="#f/outto_mod"><code class="docutils literal"><span class="pre">out_TO.f90</span></code></a></li>
<li><a class="reference internal" href="#f/radial_spectra"><code class="docutils literal"><span class="pre">radial_spectra.f90</span></code></a></li>
<li><a class="reference internal" href="#f/egeos_mod"><code class="docutils literal"><span class="pre">Egeos.f90</span></code></a></li>
<li><a class="reference internal" href="#f/outpv3"><code class="docutils literal"><span class="pre">outPV3.f90</span></code></a></li>
<li><a class="reference internal" href="#f/chebint_mod"><code class="docutils literal"><span class="pre">chebInt.f90</span></code></a></li>
<li><a class="reference internal" href="#f/omega"><code class="docutils literal"><span class="pre">outOmega.f90</span></code></a></li>
<li><a class="reference internal" href="#f/nl_special_calc"><code class="docutils literal"><span class="pre">nl_special_calc.f90</span></code></a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="IOBinaryOutputs.html"
                        title="previous chapter">IO: graphic files, movie files, coeff files and potential files</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="checkPoints.html"
                        title="next chapter">Reading and storing check points (restart files)</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/apiFortran/IOAdd.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="checkPoints.html" title="Reading and storing check points (restart files)"
             >next</a> |</li>
        <li class="right" >
          <a href="IOBinaryOutputs.html" title="IO: graphic files, movie files, coeff files and potential files"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../contents.html">Magic 5.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="../api.html" >Description of the Fortran modules</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Thomas Gastine, Johannes Wicht, Ankit Barik, Lùcia Duarte.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>