<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Formulation of the (magneto)-hydrodynamics problem &mdash; Magic 5.1 documentation</title>
    
    <link rel="stylesheet" href="_static/magic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '5.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="Magic 5.1 documentation" href="contents.html" />
    <link rel="next" title="Numerical technique" href="numerics.html" />
    <link rel="prev" title="Get MagIC and run it" href="install.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
  </style>
  <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head>
  <body role="document">
<div class="pageheader">
  <ul>
    <li><a href="index.html">Home</a></li>
    <li><a href="install.html">Get it/Run it</a></li>
    <li><a href="contribute.html">Contribute!</a></li>
    <li><a href="contents.html">Contents</a></li>
  </ul>
  <div>
    <a href="index.html">
      <img src="_static/logo.png" alt="magic" height="120px" width="192px"/>
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="numerics.html" title="Numerical technique"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="install.html" title="Get MagIC and run it"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="contents.html">Magic 5.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="formulation-of-the-magneto-hydrodynamics-problem">
<h1>Formulation of the (magneto)-hydrodynamics problem<a class="headerlink" href="#formulation-of-the-magneto-hydrodynamics-problem" title="Permalink to this headline">¶</a></h1>
<p>The general equations describing thermal convection and dynamo action of a
rotating compressible fluid are the starting point from which the Boussinesq or
the anelastic approximations are developed.  In MagIC, we consider a spherical
shell rotating about the vertical <span class="math">\(z\)</span> axis with a constant angular
velocity <span class="math">\(\Omega\)</span>. The conservation of mass is expressed by the
continuity equation:</p>
<div class="math" id="equation-eqContinuity">
<span class="eqno">(1)</span>\[\dfrac{\partial \rho}{\partial t} + \vec{\nabla} \cdot \rho \vec{u} = 0,\]</div>
<p>The conservation of momentum by</p>
<div class="math" id="equation-eqNS">
<span class="eqno">(2)</span>\[\rho\left(\dfrac{\partial \vec{u}}{\partial t}+ \vec{u}\cdot\vec{\nabla}\
\vec{u} \right) =-\vec{\nabla} p +
\dfrac{1}{\mu_0}(\vec{\nabla}\times\vec{B})\times\vec{B} +\rho
\vec{g}-2\rho\vec{\Omega}\times\vec{u}+ \vec{\nabla}\cdot\mathsf{S},\]</div>
<p>where <span class="math">\(\mathsf{S}\)</span> corresponds to the rate-of-strain tensor given by:</p>
<div class="math">
\[\begin{split}\begin{aligned}
S_{ij} &amp; = 2\nu\rho\left[e_{ij}-\dfrac{1}{3}\delta_{ij}\,\vec{\nabla}\cdot\vec{u} \right], \\
e_{ij} &amp; =\dfrac{1}{2}\left(\dfrac{\partial u_i}{\partial x_j}+\dfrac{\partial
u_j}{\partial x_i}\right).
\end{aligned}\end{split}\]</div>
<p>Concerning the energy equation, several forms are possible (using internal energy, temperature
or entropy). Here we use entropy <span class="math">\(s\)</span> as the main variable, which leads to:</p>
<div class="math" id="equation-eqEntropy">
<span class="eqno">(3)</span>\[\rho T\left(\dfrac{\partial s}{\partial t}+\vec{u}\cdot \vec{\nabla} s \right) = \vec{\nabla}\cdot (K\vec{\nabla} T) + \Phi_\nu +\lambda\left(\vec{\nabla}\times\vec{B}\right)^2,\]</div>
<p>where <span class="math">\(\Phi_\nu\)</span> corresponds to the viscous heating expressed by</p>
<div class="math">
\[\Phi_\nu = 2\rho\left[e_{ij}e_{ji}-\dfrac{1}{3}\left(\vec{\nabla}\cdot\vec{u}\right)^2\right].\]</div>
<p>The induction equation is obtained from the Maxwell equations (ignoring displacement current)
and Ohm&#8217;s law (neglecting Hall effect):</p>
<div class="math" id="equation-eqInduction">
<span class="eqno">(4)</span>\[\dfrac{\partial \vec{B}}{\partial t} = \vec{\nabla} \times \left( \vec{u}\times\vec{B}-\lambda\,\vec{\nabla}\times\vec{B}\right).\]</div>
<p>In those equations, the symbols <span class="math">\(\vec{u}\)</span>, <span class="math">\(\vec{B}\)</span>, <span class="math">\(p\)</span> and
<span class="math">\(s\)</span> correspond to velocity, magnetic field, pressure and entropy.
<span class="math">\(\vec{g}\)</span> corresponds to gravity and <span class="math">\(\rho\)</span> to density. <span class="math">\(\lambda\)</span>
is the magnetic diffusivity, <span class="math">\(\mu_0\)</span> the magnetic permeability, <span class="math">\(\nu\)</span> the kinematic
viscosity and <span class="math">\(K\)</span> the thermal conductivity.</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="_images/shell.png"><img alt="caption" src="_images/shell.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-text">Sketch of the spherical shell model and its system of coordinate.</span></p>
</div>
<div class="section" id="the-anelastic-approximation">
<h2>The anelastic approximation<a class="headerlink" href="#the-anelastic-approximation" title="Permalink to this headline">¶</a></h2>
<p>MagIC relies on the anelastic approximation of the Navier Stokes equations. There are
different flavours of this approximation but they all assume that:</p>
<blockquote>
<div><ol class="arabic simple">
<li>the departures from the thermodynamic state variables due to convection are small
with respect to the reference state,</li>
<li>the short-period acoustic waves are filtered-out.</li>
</ol>
</div></blockquote>
<p>This second assumption implies that larger numerical timesteps will be allowed, since
the typical timescale of the fast acoustic waves is typically much slower than the convective
turnover time. The strict elimination of the acoustic waves formally means</p>
<div class="math">
\[\frac{\partial \rho'}{\partial t}=0\]</div>
<p>in the continuity equation, where <span class="math">\(\rho'\)</span> corresponds here to the density perturbations
of the reference state.</p>
<p>The reference state is a background state against which perturbations are
described. In MagIC, this background state is assumed to only depends on one
spatial variable (radius), but in general it may as well be explicitly
time-dependent. Each thermodynamic variable <span class="math">\(f\)</span> is then expressed as a sum
of a spherically-symmetric time-independent quantity <span class="math">\(\tilde{f}\)</span> and a fluctuating
quantity <span class="math">\(f'\)</span>:</p>
<div class="math">
\[f(r,\theta,\phi,t) = \tilde{f}(r)+f'(r,\theta,\phi,t)\]</div>
<p>This separation of variables is then introduced in the set of equations
<a href="#equation-eqContinuity">(1)</a>-<a href="#equation-eqInduction">(4)</a> to perform a formal <strong>scale analysis</strong>, taking
into account that <span class="math">\(f'/\tilde{f} = \epsilon &lt;&lt; 1\)</span>. The variables are then expanded
in power series of <span class="math">\(\epsilon\)</span> and only the highest order terms are retained.</p>
</div>
<div class="section" id="an-adiabatic-reference-state">
<h2>An adiabatic reference state<a class="headerlink" href="#an-adiabatic-reference-state" title="Permalink to this headline">¶</a></h2>
<p>In a vigorously convecting astrophysical of geophysical system (like the convecting interior
of a planet or a star), the super-adiabaticity  of the fluid is extremely small, since the
transport of heat by convective motions is highly efficient. Therefore, the reference background state can be assumed to be perfectly adiabatic and obey to the following equations</p>
<div class="math" id="equation-eqAdiabatRef">
<span class="eqno">(5)</span>\[\dfrac{d \tilde{T}}{dr} = -\dfrac{\alpha g \tilde{T}}{c_p},\]</div>
<p>where <span class="math">\(c_p\)</span> is the heat capacity and <span class="math">\(\alpha\)</span> expressed by</p>
<div class="math">
\[c_p = T\left(\dfrac{\partial s}{\partial T}\right)_p, \quad\text{and}\quad
\alpha = -\dfrac{1}{\rho}\left(\dfrac{\partial\rho}{\partial T}\right)_p.\]</div>
<p>At this stage, it becomes convenient to start introducing non-dimensionalised quantities.
The background quantities (density temperature and transport properties) are non-dimensionalised using their values at the spherical shell outer boundary <span class="math">\(r_o\)</span>. The shell thickness
<span class="math">\(d=r_o-r_i\)</span> is used as the reference lenghtscale. The dimensionless form of Eq. <a href="#equation-eqAdiabatRef">(5)</a> then reads:</p>
<div class="math" id="equation-eqAdiaRefNd">
<span class="eqno">(6)</span>\[\dfrac{d \tilde{T}}{d r} = -Di\,\alpha(r) g(r) \tilde{T}(r),\]</div>
<p>where <span class="math">\(\tilde{T}\)</span>, <span class="math">\(\alpha\)</span> and <span class="math">\(g\)</span> have been non-dimensionalised using their values at the outer boundary. <span class="math">\(Di\)</span> is the dissipation number expressed by</p>
<div class="math" id="equation-eqDissipNb">
<span class="eqno">(7)</span>\[Di = \dfrac{\alpha_o g_o d}{c_p}.\]</div>
<p><span class="math">\(Di\)</span> is a measure of the thermal effects due to compressibility, namely
viscous and ohmic heating. <span class="math">\(Di\)</span> is also the ratio between two length
scales: the thickness of the spherical shell <span class="math">\(d\)</span> divided by the
temperature scale heights <span class="math">\(H_T=-(d\ln T/dr)^{-1}\)</span>.</p>
<p>When <span class="math">\(Di \ll 1\)</span>, the region where convection develops has a nearly constant reference
temperature. Since there is no basic temperature stratification, viscous heating (which is
the consequence of the thermal stratification due to compressibility) becomes negligible.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The Boussinesq limit can thus be recovered by using <span class="math">\(Di \rightarrow 0\)</span>.</p>
</div>
<p>Provided an equation of state is given, it is then possible to integrate Eq. <a href="#equation-eqAdiaRefNd">(6)</a>,to obtain the adiabatic background state.</p>
<div class="section" id="analytical-solution-in-the-limit-of-an-ideal-gas">
<h3>Analytical solution in the limit of an ideal gas<a class="headerlink" href="#analytical-solution-in-the-limit-of-an-ideal-gas" title="Permalink to this headline">¶</a></h3>
<p>In the limit of an ideal gas which follows <span class="math">\(\tilde{p}=\tilde{\rho}\tilde{T}\)</span> and has
<span class="math">\(\alpha=1/\tilde{T}\)</span>, one directly gets:</p>
<div class="math">
\[\begin{split}\begin{aligned}
\dfrac{d \tilde{T}}{dr}  &amp; = -Di\,g(r), \\
\tilde{\rho} &amp; = \tilde{T}^{1/(\gamma-1)},
\end{aligned}\end{split}\]</div>
<p>where <span class="math">\(\gamma=c_p/c_v\)</span>. If we now in addition make the assumption of a
centrally-condensed mass in the center of the spherical shell of radius
<span class="math">\(r\in[r_i,r_o]\)</span>, i.e. <span class="math">\(g\propto, 1/r^2\)</span>, this leads to</p>
<div class="math">
\[\begin{split}\begin{aligned}
 \tilde{T}(r) &amp; =Di\frac{r_o^2}{r}+(1-Di\,r_o), \\
 \tilde{\rho}(r) &amp; = \tilde{T}^m, \\
 Di &amp; = \dfrac{r_i}{r_o}\left(\exp\dfrac{N_\rho}{m}-1\right),
\end{aligned}\end{split}\]</div>
<p>where <span class="math">\(N_\rho=\ln(\rho_i/\rho_o)\)</span> is the number of density scale heights of the reference
state and <span class="math">\(m=1/(\gamma-1)\)</span> is the polytropic index.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<ul class="last simple">
<li>The relationship between <span class="math">\(N_\rho\)</span> and the dissipation number
<span class="math">\(Di\)</span> directly depends on the gravity profile. The formula above
is only valid when <span class="math">\(g\propto 1/r^2\)</span>.</li>
<li>In this formulation, when you change the polytropic index <span class="math">\(m\)</span>, you
also change the nature of the fluid you&#8217;re modelling since you accordingly
modify <span class="math">\(\gamma=c_p/c_v\)</span>.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="mhd-equations">
<h2>MHD equations<a class="headerlink" href="#mhd-equations" title="Permalink to this headline">¶</a></h2>
<p>One of the assumptions of the anelastic approximation is that the fluctuations due to convection are much smaller than the reference state:</p>
<div class="math">
\[\epsilon \simeq \dfrac{\rho'}{\tilde{\rho}}\simeq \dfrac{T'}{\tilde{T}}\simeq \dfrac{p'}{\tilde{p}}\simeq s' \ll 1.\]</div>
<p>In the following, we will treat the equations
<a href="#equation-eqContinuity">(1)</a>-<a href="#equation-eqInduction">(4)</a> in nondimensional form. There is no unique
way to scale the equations and as a consequence different sets of
non-dimensional numbers are employed. For convection-driven dynamos, there is four
independent control parameters.</p>
<p>We use here the viscous diffusion time <span class="math">\(d^2/\nu_o\)</span> (where <span class="math">\(\nu_o\)</span> is the kinematic
viscosity at the outer boundary as a time unit and <span class="math">\(\nu_o/d\)</span> as the reference velocity.
Magnetic field is expressed in units of <span class="math">\(\sqrt{\rho_o\mu_0\lambda_i\Omega}\)</span>, where
<span class="math">\(\rho_o\)</span> is the density at the outer boundary and <span class="math">\(\lambda_i\)</span> is the magnetic
diffusivity at the <strong>inner</strong> boundary.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">All the transport properties except the magnetic diffusivity are normalised to their
values at the outer boundary. The motivation to rather base the reference magnetic
diffusivity to the <strong>inner</strong> boundary is twofold: (i) it allows an easier control
of the possible continuous conductivity value in the inner core; (ii) it is a more
natural choice when modelling gas giants planets which exhibit strong electrical
conductivity decays in the outer layer.</p>
</div>
<p>This leads to the following sets of dimensionless equations:</p>
<div class="math" id="equation-eqNSNd">
<span class="eqno">(8)</span>\[E\left(\dfrac{\partial \vec{u}}{\partial t}+\vec{u}\cdot\vec{\nabla}\vec{u}\right)
+2\vec{e_z}\times\vec{u}= -\vec{\nabla}\left({\dfrac{p'}{\tilde{\rho}}}\right)+\dfrac{Ra\,E}{Pr}g(r)
\,s'\,\vec{e_r} + \dfrac{1}{Pm\,\tilde{\rho}}\left(\vec{\nabla}\times \vec{B}
\right)\times \vec{B}+ \dfrac{E}{\tilde{\rho}} \vec{\nabla}\cdot \mathsf{S},\]</div>
<div class="math" id="equation-eqContNd">
<span class="eqno">(9)</span>\[\vec{\nabla}\cdot\tilde{\rho}\vec{u}=0,\]</div>
<div class="math" id="equation-eqMagNd">
<span class="eqno">(10)</span>\[\vec{\nabla}\cdot\vec{B}=0,\]</div>
<div class="math" id="equation-eqIndNd">
<span class="eqno">(11)</span>\[\dfrac{\partial \vec{B}}{\partial t} = \vec{\nabla} \times \left( \vec{u}\times\vec{B}\right)-\dfrac{1}{Pm}\vec{\nabla}\times\left(\lambda(r)\,\vec{\nabla}\times\vec{B}\right).\]</div>
<div class="section" id="entropy-equation-and-turbulent-diffusion">
<h3>Entropy equation and turbulent diffusion<a class="headerlink" href="#entropy-equation-and-turbulent-diffusion" title="Permalink to this headline">¶</a></h3>
<p>The entropy equation usually requires an additional assumption in most of the existing
anelastic approximations. Indeed, if one simply expands Eq. <a href="#equation-eqEntropy">(3)</a> with the classical
temperature diffusion an operator of the form:</p>
<div class="math">
\[\epsilon\,\vec{\nabla}\cdot \left( K \vec{\nabla} T'\right)+\vec{\nabla}\cdot \left( K \vec{\nabla} \tilde{T}\right),\]</div>
<p>will remain the right-hand side of the equation. At first glance, there seems
to be a <span class="math">\(1/\epsilon\)</span> factor between the first term and the second one,
which would suggest to keep only the second term in this expansion. However,
for astrophysical objects which exhibit strong convective driving (and hence
large Rayleigh numbers), the diffusion of the adiabatic background is actually
very small and may be comparable or even smaller in magnitude as the <span class="math">\(\epsilon\)</span>
terms representing the usual convective perturbations. For the Earth core for instance,
if one assumes that the typical temperature fluctuations are of the order of 1 mK and
the temperature contrast between the inner and outer core is of the order of 1000 K, then
<span class="math">\(\epsilon \sim 10^{-6}\)</span>. The ratio of the two terms can thus be estimated as</p>
<div class="math" id="equation-eqEpsRatio">
<span class="eqno">(12)</span>\[\epsilon \dfrac{T'/\delta^2}{T/d^2},\]</div>
<p>where <span class="math">\(d\)</span> is the thickness of the inner core and <span class="math">\(\delta\)</span> is the typical thermal
boundary layer thickness. This ratio is exactly one when <span class="math">\(\delta =1\text{ m}\)</span>, a
plausible value for the Earth inner core.</p>
<p>In numerical simulations however, the over-estimated diffusivities restrict the computational
capabilities to much lower Rayleigh numbers. As a consequence, the actual boundary layers
in a global DNS will be much thicker and the ratio <a href="#equation-eqEpsRatio">(12)</a> will be much smaller than
unity. The second terms will thus effectively acts  as a radial-dependent heat source or sink
that will drive or hinder convection. This is one of the physical motivation to rather introduce a <strong>turbulent diffusivity</strong> that will be approximated by</p>
<div class="math">
\[\kappa \tilde{\rho}\tilde{T} \vec{\nabla} s,\]</div>
<p>where <span class="math">\(\kappa\)</span> is the turbulent diffusivity. Entropy diffusion is assumed to dominate
over temperature diffusion in turbulent flows.</p>
<p>The choice of the entropy scale to non-dimensionalise Eq. <a href="#equation-eqEntropy">(3)</a> also depends on
the nature of the boundary conditions: it can be simply the entropy contrast over the layer
<span class="math">\(\Delta s\)</span> when the entropy is held constant at both boundaries, or <span class="math">\(d\,(ds /dr)\)</span>
when flux-based boundary conditions are employed. We will restrict to the first option in
the following, but keep in mind that depending on your setup, the entropy reference scale
(and thus the Rayleigh number definition) might change.</p>
<div class="math" id="equation-eqEntropyNd">
<span class="eqno">(13)</span>\[\tilde{\rho}\tilde{T}\left(\dfrac{\partial s'}{\partial t} +
\vec{u}\cdot\vec{\nabla} s'\right) =
\dfrac{1}{Pr}\vec{\nabla}\cdot\left(\kappa(r)\tilde{\rho}\tilde{T}\vec{\nabla} s'\right) +
\dfrac{Pr\,Di}{Ra}\Phi_\nu +
\dfrac{Pr\,Di}{Pm^2\,E\,Ra}\lambda(r)\left(\vec{\nabla}
\times\vec{B}\right)^2,\]</div>
</div>
<div class="section" id="the-boussinesq-limits-of-the-equation">
<h3>The Boussinesq limits of the equation <span class="math">\(Di \rightarrow 0\)</span><a class="headerlink" href="#the-boussinesq-limits-of-the-equation" title="Permalink to this headline">¶</a></h3>
<p>When the dissipation number <span class="math">\(Di\rightarrow 0\)</span> then <span class="math">\(\tilde{T}=\text{cst.}\)</span>.
If in addition to that if <span class="math">\(\gamma \neq 1\)</span>, the density background <span class="math">\(\tilde{\rho}\)</span>
is also constant.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The peculiar configuration of <span class="math">\(\gamma=1\)</span> corresponds to the so-called
zero-Grüneisen limit of the Navier-Stokes equation (or isothermal) and is
a special case in which <span class="math">\(Di=0\)</span> but a density background (controlled
by <span class="math">\(N_\rho\)</span>) is still allowed.</p>
</div>
<p>A brief look at Eq. <a href="#equation-eqEntropyNd">(13)</a> then shows than viscous and Ohmic heating will disappear
from the entropy equation. Furthermore, temperature and entropy fluctuations become equivalent
quantities. If in addition to that we also neglect the possible radial-dependence of the
transport properties (electrical conductivity, viscosity and thermal diffusivity),
the set of equations <a href="#equation-eqNSNd">(8)</a>-<a href="#equation-eqEntropyNd">(13)</a> thus simplifies to the classical
Boussinesq set of equations:</p>
<div class="math">
\[E\left(\dfrac{\partial \vec{u}}{\partial t}+\vec{u}\cdot\vec{\nabla}\vec{u}\right)
+2\vec{e_z}\times\vec{u}= -\vec{\nabla}p'+\dfrac{Ra\,E}{Pr}g(r)
\,T'\,\vec{e_r} + \dfrac{1}{Pm}\left(\vec{\nabla}\times \vec{B}
\right)\times \vec{B}+ E\,\Delta \vec{u},\]</div>
<div class="math">
\[\vec{\nabla}\cdot\vec{u}=0,\]</div>
<div class="math">
\[\vec{\nabla}\cdot\vec{B}=0,\]</div>
<div class="math">
\[\dfrac{\partial \vec{B}}{\partial t} = \vec{\nabla} \times \left( \vec{u}\times\vec{B}\right)+\dfrac{1}{Pm}\Delta\vec{B}.\]</div>
<div class="math">
\[\dfrac{\partial T'}{\partial t} +
\vec{u}\cdot\vec{\nabla} T' =
\dfrac{1}{Pr}\Delta T'.\]</div>
</div>
<div class="section" id="dimensionless-control-parameters">
<h3>Dimensionless control parameters<a class="headerlink" href="#dimensionless-control-parameters" title="Permalink to this headline">¶</a></h3>
<p>The equations <a href="#equation-eqNSNd">(8)</a>-<a href="#equation-eqEntropyNd">(13)</a> are governed by four dimensionless numbers: the
Ekman number</p>
<div class="math" id="equation-eqEkman">
<span class="eqno">(14)</span>\[E = \frac{\nu}{\Omega d^2},\]</div>
<p>the Rayleigh number</p>
<div class="math" id="equation-eqRayleigh">
<span class="eqno">(15)</span>\[Ra = \frac{\alpha_o g_o T_o d^3 \Delta s}{c_p \kappa_o \nu_o},\]</div>
<p>the Prandtl number</p>
<div class="math" id="equation-eqPrandtl">
<span class="eqno">(16)</span>\[Pr = \frac{\nu_o}{\kappa_o},\]</div>
<p>and the magnetic Prandtl number</p>
<div class="math" id="equation-eqmaPrandtl">
<span class="eqno">(17)</span>\[Pm = \frac{\nu_o}{\lambda_i}.\]</div>
<p>In addition to these four numbers, the reference state is controlled by the geometry of
the spherical shell given by its radius ratio</p>
<div class="math" id="equation-eqRadratio">
<span class="eqno">(18)</span>\[\eta = \frac{r_i}{r_o},\]</div>
<p>and the background density and temperature profiles, either controlled by <span class="math">\(Di\)</span> or
by <span class="math">\(N_\rho\)</span> and <span class="math">\(m\)</span>.</p>
<p>Variants of the non-dimensional equations and control parameters result from
different choices for the fundamental scales. For the length scale often
<span class="math">\(r_o\)</span> is chosen instead of <span class="math">\(d\)</span>. Other natural scales for time are the
magnetic or the thermal diffusion time, or the rotation period.
There are also different options for scaling the magnetic field strength.
The prefactor of two, which is retained in the
Coriolis term in <a href="#equation-eqNSNd">(8)</a>, is often incorporated into the definition of the
Ekman number.</p>
</div>
<div class="section" id="usual-diagnostic-quantities">
<h3>Usual diagnostic quantities<a class="headerlink" href="#usual-diagnostic-quantities" title="Permalink to this headline">¶</a></h3>
<p>Characteristic properties of the solution are usually expressed in terms
of non-dimensional diagnostic parameters.
In the context of the geodynamo for instance, the two
most important ones are the magnetic Reynolds number <span class="math">\(Rm\)</span> and
the Elsasser number <span class="math">\(\Lambda\)</span>. Usually the rms-values of the velocity
<span class="math">\(u_{rms}\)</span> and of the magnetic field <span class="math">\(B_{rms}\)</span> inside the spherical shell
are taken as characteristic values. The magnetic Reynolds number</p>
<div class="math">
\[Rm =  \frac{u_{rms}d}{\lambda_i}\]</div>
<p>can be considered as a measure for the flow velocity and describes
the ratio of advection of the magnetic field to magnetic diffusion.
Other characteristic non-dimensional numbers related to the flow velocity are
the (hydrodynamic) Reynolds number</p>
<div class="math">
\[Re = \frac{u_{rms} d}{\nu_o},\]</div>
<p>which measures the ratio of inertial forces to viscous forces,
and the Rossby number</p>
<div class="math">
\[Ro = \frac{u_{rms}}{\Omega d} ,\]</div>
<p>a measure for the ratio of inertial to Coriolis forces.</p>
<div class="math">
\[\Lambda = \frac{B_{rms}^2}{\mu_0\lambda_i\rho_o\Omega}\]</div>
<p>measures the ratio of Lorentz to Coriolis forces and is
equivalent to the square of the non-dimensional magnetic field strength
in the scaling chosen here.</p>
</div>
</div>
<div class="section" id="boundary-conditions-and-treatment-of-inner-core">
<h2>Boundary conditions and treatment of inner core<a class="headerlink" href="#boundary-conditions-and-treatment-of-inner-core" title="Permalink to this headline">¶</a></h2>
<div class="section" id="mechanical-conditions">
<h3>Mechanical conditions<a class="headerlink" href="#mechanical-conditions" title="Permalink to this headline">¶</a></h3>
<p>In its simplest form, when modelling the geodynamo, the fluid shell is treated
as a container with rigid, impenetrable, and co-rotating walls. This implies
that within the rotating frame of reference all velocity components vanish at
<span class="math">\(r_o\)</span> and <span class="math">\(r_i\)</span>.  In case of modelling the free surface of a gas
giant planets or a star, it is preferable to rather replace the condition of
zero horizontal velocity by one of vanishing viscous shear stresses (the
so-called free-slip condition).</p>
<p>Furthermore, even in case of modelling the liquid iron core of a terrestrial
planet, there is no a priori reason why the inner core should necessarily
co-rotate with the mantle. Some models for instance allow for differential
rotation of the inner core and mantle with respect to the reference frame.  The
change of rotation rate is determined from the net torque. Viscous,
electromagnetic, and torques due to gravitational coupling between density
heterogeneities in the mantle and in the inner core contribute.</p>
</div>
<div class="section" id="magnetic-boundary-conditions-and-inner-core-conductivity">
<h3>Magnetic boundary conditions and inner core conductivity<a class="headerlink" href="#magnetic-boundary-conditions-and-inner-core-conductivity" title="Permalink to this headline">¶</a></h3>
<p>When assuming that the fluid shell is surrounded by electrically insulating  regions
(inner core and external part),
the magnetic field inside the fluid shell matches continuously
to a potential field in both the exterior and the interior regions. Alternative
magnetic boundary conditions (like cancellation of the horizontal component of the field
) are also possible.</p>
<p>Depending on the physical problem you want to model, treating the inner core as an
insulator is not realistic either, and it might instead be more appropriate to
assume that it has the same electrical conductivity as
the fluid shell. In this case, an equation equivalent to <a href="#equation-eqIndNd">(11)</a> must
be solved for the inner core, where the velocity field simply
describes the solid body rotation of the inner core with respect to the reference frame.
At the inner core boundary a continuity condition for the magnetic field and the
horizontal component of the electrical field apply.</p>
</div>
<div class="section" id="thermal-boundary-conditions-and-distribution-of-buoyancy-sources">
<h3>Thermal boundary conditions and distribution of buoyancy sources<a class="headerlink" href="#thermal-boundary-conditions-and-distribution-of-buoyancy-sources" title="Permalink to this headline">¶</a></h3>
<p>In many dynamo models, convection is simply driven by an imposed fixed
super-adiabatic entropy contrast between the inner and outer boundaries.  This
approximation is however not necessarily the best choice, since for instance,
in the present Earth,  convection is thought to be driven by a combination of
thermal and compositional buoyancy.  Sources of heat are the release of latent
heat of inner core solidification and the secular cooling of the outer and
inner core, which can effectively be treated like a heat source.  The heat loss
from the core is controlled by the convecting mantle, which effectively imposes
a condition of fixed heat flux at the core-mantle boundary on the dynamo. The
heat flux is in that case spatially and temporally variable.</p>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Formulation of the (magneto)-hydrodynamics problem</a><ul>
<li><a class="reference internal" href="#the-anelastic-approximation">The anelastic approximation</a></li>
<li><a class="reference internal" href="#an-adiabatic-reference-state">An adiabatic reference state</a><ul>
<li><a class="reference internal" href="#analytical-solution-in-the-limit-of-an-ideal-gas">Analytical solution in the limit of an ideal gas</a></li>
</ul>
</li>
<li><a class="reference internal" href="#mhd-equations">MHD equations</a><ul>
<li><a class="reference internal" href="#entropy-equation-and-turbulent-diffusion">Entropy equation and turbulent diffusion</a></li>
<li><a class="reference internal" href="#the-boussinesq-limits-of-the-equation">The Boussinesq limits of the equation <span class="math">\(Di \rightarrow 0\)</span></a></li>
<li><a class="reference internal" href="#dimensionless-control-parameters">Dimensionless control parameters</a></li>
<li><a class="reference internal" href="#usual-diagnostic-quantities">Usual diagnostic quantities</a></li>
</ul>
</li>
<li><a class="reference internal" href="#boundary-conditions-and-treatment-of-inner-core">Boundary conditions and treatment of inner core</a><ul>
<li><a class="reference internal" href="#mechanical-conditions">Mechanical conditions</a></li>
<li><a class="reference internal" href="#magnetic-boundary-conditions-and-inner-core-conductivity">Magnetic boundary conditions and inner core conductivity</a></li>
<li><a class="reference internal" href="#thermal-boundary-conditions-and-distribution-of-buoyancy-sources">Thermal boundary conditions and distribution of buoyancy sources</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="install.html"
                        title="previous chapter">Get MagIC and run it</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="numerics.html"
                        title="next chapter">Numerical technique</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/equations.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="f-modindex.html" title="Fortran Module Index"
             >fortran modules</a> |</li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="numerics.html" title="Numerical technique"
             >next</a> |</li>
        <li class="right" >
          <a href="install.html" title="Get MagIC and run it"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="contents.html">Magic 5.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Thomas Gastine, Johannes Wicht, Ankit Barik, Lùcia Duarte.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
  </body>
</html>